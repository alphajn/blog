import{_ as u,a as g}from"./chunks/el-tag.ea072e11.js";import{d as m,u as b,a5 as _,l as f,k as E,a6 as v,o as d,c as F,C as l,J as y,b as q,S as B,U as k,_ as C,a as c,E as x,V as T}from"./chunks/framework.009e57ad.js";import{T as w}from"./chunks/Kline.vue_vue_type_style_index_0_scoped_1f26131b_lang.e8857780.js";import{u as L,l as P}from"./chunks/index.ce378cf5.js";import"./chunks/el-option.4ed993c7.js";import"./chunks/el-button.4ed993c7.js";import"./chunks/index.4da49ac9.js";import"./chunks/index.f954909e.js";import"./chunks/index.0bdd1095.js";import"./chunks/index.7e71f9e5.js";const A=D=>(B("data-v-1ef09717"),D=D(),k(),D),K={class:"options pb-8px! text-12px border-b-solid border-b border-amber mb-8px!"},S=A(()=>l("p",{class:"m-0! text-12px lh-12px! mb-4px!"}," 交易对 ",-1)),$=A(()=>l("p",{class:"m-0! text-12px lh-12px! mb-4px!"}," 语言 ",-1)),I={class:"h-400px"},z=m({__name:"TvKline",setup(D){const{isDark:i}=b(),p=new L("wss://ws.meex.com/kline-api/ws",{name:"kline-ws-meex",retry:100,connect:!1}),s=_({symbols:{},lang:"zh-CN",theme:"light",loading:!0,interval:"60",list:[],sub_list:[],latest_data:null,page_size:1e3,library_path:"/blog/public/charting_library/"}),e=f(()=>{var a;return`market_${(a=s.symbols.symbol)==null?void 0:a.toLowerCase()}_kline_60min`}),t={getKline(){s.loading=!0,s.sub_list=[],s.latest_data=null,t.subKline(),p.send({event:"req",params:{channel:e.value}},a=>{var n,o;if(s.loading=!1,s.list=[],a.success&&a.channel===e.value){const r=t.formatList(a.data);if(s.sub_list.length){const h=(n=r.slice(-1)[0])==null?void 0:n.time;((o=s.sub_list[0])==null?void 0:o.timestamp)>h&&r.push(...s.sub_list),s.sub_list=[]}s.list=r}})},subKline(){p.init(),p.send({event:"sub",params:{channel:e.value}},a=>{if(a.success&&a.channel===e.value){const n=t.formatList([a.tick]);s.loading?s.sub_list=n:([s.latest_data]=n,t.updateListLastData())}})},loadMore(a,n){if(!a){n([]);return}p.send({event:"req",params:{channel:e.value,endIdx:a/1e3-1,pageSize:s.page_size}},o=>{if(o.success&&o.channel===e.value){const r=t.formatList(o.data);n(r),s.list.unshift(...r)}})},updateListLastData(){var a;if(s.latest_data){const n=s.latest_data.time,o=(a=s.list.slice(-1)[0])==null?void 0:a.time;n===o?s.list.splice(-1,1,s.latest_data):n&&(!o||n>o)&&s.list.push(s.latest_data)}},unsub(a){p.send({event:"unsub",params:{channel:e.value}},a)},changeSymbol(a){t.unsub(()=>{}),s.symbols=a,s.interval&&t.getKline()},changeLang(a){s.lang=a},formatList(a){return a.map(n=>({id:`${s.symbols.symbol}_${s.interval}`,time:n.id*1e3,open:n.open,close:n.close,high:n.high,low:n.low,volume:n.vol}))}};return E(()=>{s.theme=i.value?"dark":"light"}),v(()=>{t.unsub(()=>{}),p==null||p.close()}),(a,n)=>{const o=u,r=g;return d(),F("section",null,[l("ul",K,[l("li",null,[S,y(o,{onChange:t.changeSymbol},null,8,["onChange"])]),l("li",null,[$,y(r,{lang:s.lang,onChange:t.changeLang},null,8,["lang","onChange"])])]),l("div",I,[y(q(w),{interval:s.interval,loading:s.loading,theme:s.theme,lang:s.lang,symbol:s.symbols.symbol,"price-precision":s.symbols.pricePrecision,"quantity-precision":s.symbols.quantityPrecision,list:s.list,"latest-data":s.latest_data,"load-more":t.loadMore,"library-path":s.library_path,"limit-size":s.page_size,watermark:"Kline"},null,8,["interval","loading","theme","lang","symbol","price-precision","quantity-precision","list","latest-data","load-more","library-path","limit-size"])])])}}});const N=C(z,[["__scopeId","data-v-1ef09717"]]),ts=JSON.parse('{"title":"专业版","description":"","frontmatter":{"outline":"deep"},"headers":[],"relativePath":"npm/kline-tv.md","lastUpdated":1701080813000}'),V={name:"npm/kline-tv.md"},M=l("h1",{id:"专业版",tabindex:"-1"},[c("专业版 "),l("a",{class:"header-anchor",href:"#专业版","aria-label":'Permalink to "专业版"'},"​")],-1),U=l("a",{href:"https://cn.tradingview.com/widget/advanced-chart/",target:"_blank",rel:"noreferrer"},"Tradingview",-1),R=l("a",{href:"https://www.tradingview.com/charting-library-docs/",target:"_blank",rel:"noreferrer"},"官方文档",-1),O=l("h2",{id:"demo",tabindex:"-1"},[c("Demo "),l("a",{class:"header-anchor",href:"#demo","aria-label":'Permalink to "Demo"'},"​")],-1),W=T("",20);function H(D,i,p,s,e,t){const a=P.ElTag,n=N;return d(),F("div",null,[M,l("p",null,[c("基于 "),U,c(),y(a,{round:"",small:""},{default:x(()=>[c("26.003")]),_:1}),c(" 开发，"),R,c("。")]),O,y(n),W])}const os=C(V,[["render",H]]);export{ts as __pageData,os as default};
