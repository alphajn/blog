import{u as li,l as No}from"./chunks/index.58f4a5a8.js";import"./chunks/el-option.4ed993c7.js";import{a8 as ui,a9 as ci,d as Vt,o as Ee,c as Re,n as hi,V as Ot,_ as pt,a5 as Uo,q as di,w as ct,D as Rt,G as Wo,u as pi,l as gi,a6 as vi,k as fi,C as ht,J as dt,b as yi,E as Yo,F as Lt,R as Ho,S as mi,U as _i}from"./chunks/framework.c67b3163.js";import{b as Zo,p as Go,l as xi,w as Ci,f as Xo,m as He}from"./chunks/index.7e71f9e5.js";import"./chunks/index.11a55b9f.js";var $o={exports:{}},zt={exports:{}};/**
 * @license
 * KLineChart v9.5.4
 * Copyright (c) 2019 lihu.
 * Licensed under Apache License 2.0 https://www.apache.org/licenses/LICENSE-2.0
 */(function(P,w){(function(g,I){I(w)})(ui,function(g){function I(i,e){if(O(i)||O(e)){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t)){var n=i[t],o=e[t];O(o)&&O(n)&&!M(o)&&!M(n)?I(n,o):Y(e[t])&&(i[t]=e[t])}}}function q(i){if(!O(i)||!M(i))return i;var e;for(var t in e=M(i)?[]:{},i)if(Object.prototype.hasOwnProperty.call(i,t)){var n=i[t];e[t]=O(n)?q(n):n}return e}function M(i){return Object.prototype.toString.call(i)==="[object Array]"}function L(i){return typeof i=="function"}function O(i){return typeof i=="object"}function Z(i){return typeof i=="number"&&!isNaN(i)}function Y(i){return i!=null}function re(i){return typeof i=="boolean"}function ce(i){return typeof i=="string"}var Nt,gt,vt,Wt,ft,Qe,ze,Yt,yt,Ve,Jo=/\\(\\)?/g,Qo=RegExp(`[^.[\\]]+|\\[(?:([^"'][^[]*)|(["'])((?:(?!\\2)[^\\\\]|\\\\.)*?)\\2)\\]|(?=(?:\\.|\\[\\])(?:\\.|\\[\\]|$))`,"g");function U(i,e,t){if(Y(i)){var n=[];e.replace(Qo,function(s){for(var l=[],u=1;arguments.length>u;u++)l[u-1]=arguments[u];var c=s;return Y(l[1])?c=l[2].replace(Jo,"$1"):Y(l[0])&&(c=l[0].trim()),n.push(c),""});for(var o=i,r=0,a=n.length;Y(o)&&a>r;)o=o==null?void 0:o[n[r++]];return Y(o)?o:t??"--"}return t??"--"}function Ht(i,e,t){var n=i.format(new Date(e)).split(", "),o=n[0].split("/"),r=n[1].split(":"),a={YYYY:o[2],MM:o[0],DD:o[1],HH:r[0]==="24"?"00":r[0],mm:r[1],ss:r[2]};return t.replace(/YYYY|MM|DD|HH|mm|ss/g,function(s){return a[s]})}function G(i,e){var t=+i;return Z(t)?t.toFixed(e??2):"".concat(i)}function Xt(i){var e=+i;if(Z(e)){if(e>1e9)return"".concat(+(e/1e9).toFixed(3),"B");if(e>1e6)return"".concat(+(e/1e6).toFixed(3),"M");if(e>1e3)return"".concat(+(e/1e3).toFixed(3),"K")}return"".concat(i)}function J(i,e){var t="".concat(i);if(e.length===0)return t;if(t.includes(".")){var n=t.split(".");return"".concat(n[0].replace(/(\d)(?=(\d{3})+$)/g,function(o){return"".concat(o).concat(e)}),".").concat(n[1])}return t.replace(/(\d)(?=(\d{3})+$)/g,function(o){return"".concat(o).concat(e)})}g.LineType=void 0,(Nt=g.LineType||(g.LineType={})).Dashed="dashed",Nt.Solid="solid",g.PolygonType=void 0,(gt=g.PolygonType||(g.PolygonType={})).Stroke="stroke",gt.Fill="fill",gt.StrokeFill="stroke_fill",g.TooltipShowRule=void 0,(vt=g.TooltipShowRule||(g.TooltipShowRule={})).Always="always",vt.FollowCross="follow_cross",vt.None="none",g.TooltipShowType=void 0,(Wt=g.TooltipShowType||(g.TooltipShowType={})).Standard="standard",Wt.Rect="rect",g.TooltipIconPosition=void 0,(ft=g.TooltipIconPosition||(g.TooltipIconPosition={})).Left="left",ft.Middle="middle",ft.Right="right",function(i){i.Fixed="fixed",i.Pointer="pointer"}(Qe||(Qe={})),g.CandleType=void 0,(ze=g.CandleType||(g.CandleType={})).CandleSolid="candle_solid",ze.CandleStroke="candle_stroke",ze.CandleUpStroke="candle_up_stroke",ze.CandleDownStroke="candle_down_stroke",ze.Ohlc="ohlc",ze.Area="area",g.YAxisPosition=void 0,(Yt=g.YAxisPosition||(g.YAxisPosition={})).Left="left",Yt.Right="right",g.YAxisType=void 0,(yt=g.YAxisType||(g.YAxisType={})).Normal="normal",yt.Percentage="percentage",yt.Log="log",g.FormatDateType=void 0,(Ve=g.FormatDateType||(g.FormatDateType={}))[Ve.Tooltip=0]="Tooltip",Ve[Ve.Crosshair=1]="Crosshair",Ve[Ve.XAxis=2]="XAxis";var mt=function(i,e){return mt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])},mt(i,e)};function N(i,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+e+" is not a constructor or null");function t(){this.constructor=i}mt(i,e),i.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var Ae,k=function(){return k=Object.assign||function(i){for(var e,t=1,n=arguments.length;n>t;t++)for(var o in e=arguments[t])Object.prototype.hasOwnProperty.call(e,o)&&(i[o]=e[o]);return i},k.apply(this,arguments)};function et(i,e,t,n){return new(t||(t=Promise))(function(o,r){function a(u){try{l(n.next(u))}catch(c){r(c)}}function s(u){try{l(n.throw(u))}catch(c){r(c)}}function l(u){var c;u.done?o(u.value):(c=u.value,c instanceof t?c:new t(function(h){h(c)})).then(a,s)}l((n=n.apply(i,e||[])).next())})}function tt(i,e){var t,n,o,r,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(r[Symbol.iterator]=function(){return this}),r;function s(l){return function(u){return function(c){if(t)throw new TypeError("Generator is already executing.");for(;r&&(r=0,c[0]&&(a=0)),a;)try{if(t=1,n&&(o=2&c[0]?n.return:c[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,c[1])).done)return o;switch(n=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,n=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(o=a.trys,!((o=o.length>0&&o[o.length-1])||c[0]!==6&&c[0]!==2)){a=0;continue}if(c[0]===3&&(!o||c[1]>o[0]&&o[3]>c[1])){a.label=c[1];break}if(c[0]===6&&o[1]>a.label){a.label=o[1],o=c;break}if(o&&o[2]>a.label){a.label=o[2],a.ops.push(c);break}o[2]&&a.ops.pop(),a.trys.pop();continue}c=e.call(i,a)}catch(h){c=[6,h],n=0}finally{t=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([l,u])}}}function Xe(i){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&i[e],n=0;if(t)return t.call(i);if(i&&typeof i.length=="number")return{next:function(){return i&&n>=i.length&&(i=void 0),{value:i&&i[n++],done:!i}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function ee(i,e){var t=typeof Symbol=="function"&&i[Symbol.iterator];if(!t)return i;var n,o,r=t.call(i),a=[];try{for(;(e===void 0||e-- >0)&&!(n=r.next()).done;)a.push(n.value)}catch(s){o={error:s}}finally{try{n&&!n.done&&(t=r.return)&&t.call(r)}finally{if(o)throw o.error}}return a}function qt(i,e,t){if(t||arguments.length===2)for(var n,o=0,r=e.length;r>o;o++)!n&&o in e||(n||(n=Array.prototype.slice.call(e,0,o)),n[o]=e[o]);return i.concat(n||Array.prototype.slice.call(e))}typeof SuppressedError=="function"&&SuppressedError,g.ActionType=void 0,(Ae=g.ActionType||(g.ActionType={})).OnZoom="onZoom",Ae.OnScroll="onScroll",Ae.OnVisibleRangeChange="onVisibleRangeChange",Ae.OnTooltipIconClick="onTooltipIconClick",Ae.OnCrosshairChange="onCrosshairChange",Ae.OnCandleBarClick="onCandleBarClick",Ae.OnPaneDrag="onPaneDrag";var ot,en=function(){function i(){this._callbacks=[]}return i.prototype.subscribe=function(e){var t;0>((t=this._callbacks.indexOf(e))!==null&&t!==void 0?t:-1)&&this._callbacks.push(e)},i.prototype.unsubscribe=function(e){var t;if(e!==void 0){var n=(t=this._callbacks.indexOf(e))!==null&&t!==void 0?t:-1;n>-1&&this._callbacks.splice(n,1)}else this._callbacks=[]},i.prototype.execute=function(e){this._callbacks.forEach(function(t){t(e)})},i.prototype.isEmpty=function(){return this._callbacks.length===0},i}(),_t=1,jt=new Date().getTime();function Kt(i){var e=new Date().getTime();return e===jt?++_t:_t=1,jt=e,"".concat(i??"").concat(e,"_").concat(_t)}function me(i,e){var t,n=document.createElement(i),o=e??{};for(var r in o)n.style[r]=(t=o[r])!==null&&t!==void 0?t:"";return n}function Ie(i){var e,t,n;return Math.ceil((n=(t=(e=i.ownerDocument)===null||e===void 0?void 0:e.defaultView)===null||t===void 0?void 0:t.devicePixelRatio)!==null&&n!==void 0?n:2)}function ke(i,e,t){return"".concat(e??"normal"," ").concat(i??12,"px ").concat(t??"Helvetica Neue")}function qe(i,e,t,n){if(ot===void 0){var o=document.createElement("canvas"),r=Ie(o);(ot=o.getContext("2d")).scale(r,r)}return ot.font=ke(e,t,n),Math.round(ot.measureText(i).width)}function xt(i,e,t){var n=0,o=0;for(o=i.length-1;n!==o;){var r=Math.floor((o+n)/2),a=o-n,s=i[r][e];if(t===i[n][e])return n;if(t===i[o][e])return o;if(t===s)return r;if(t>s?n=r:o=r,2>=a)break}return n}function Ut(i,e){return e==null&&(e=10),+(+i).toFixed(e=Math.min(Math.max(0,e),20))}function Zt(i,e,t){var n=[Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER];return i.forEach(function(o){var r,a;n[0]=Math.max((r=o[e])!==null&&r!==void 0?r:o,n[0]),n[1]=Math.min((a=o[t])!==null&&a!==void 0?a:o,n[1])}),n}function je(i){return Math.log(i)/Math.log(10)}function Pe(i){return Math.pow(10,i)}var Ct,tn=1,on=50,nn=function(){function i(e){this._dateTimeFormat=this._buildDateTimeFormat(),this._zoomEnabled=!0,this._scrollEnabled=!0,this._loading=!0,this._loadMoreCallback=null,this._more=!0,this._totalBarSpace=0,this._barSpace=6,this._offsetRightDistance=50,this._startScrollOffsetRightBarCount=0,this._minVisibleBarCount={left:2,right:2},this._visibleRange={from:0,to:0,realFrom:0,realTo:0},this._chartStore=e,this._gapBarSpace=this._calcGapBarSpace(),this._offsetRightBarCount=this._offsetRightDistance/this._barSpace}return i.prototype._calcGapBarSpace=function(){return Math.max(1,Math.min(Math.floor(.82*this._barSpace),Math.floor(this._barSpace)-1))},i.prototype.adjustVisibleRange=function(){var e,t=this._chartStore.getDataList(),n=t.length,o=this._totalBarSpace/this._barSpace,r=o-Math.min(this._minVisibleBarCount.left,n);this._offsetRightBarCount>r&&(this._offsetRightBarCount=r);var a=-n+Math.min(this._minVisibleBarCount.right,n);a>this._offsetRightBarCount&&(this._offsetRightBarCount=a);var s=Math.round(this._offsetRightBarCount+n+.5);s>n&&(s=n);var l=Math.round(s-o)-1;if(0>l&&(l=0),this._visibleRange={from:l,to:s,realFrom:this._offsetRightBarCount>0?Math.round(n+this._offsetRightBarCount-o)-1:l,realTo:s},this._chartStore.getActionStore().execute(g.ActionType.OnVisibleRangeChange,this._visibleRange),this._chartStore.adjustVisibleDataList(),l===0&&this._more&&!this._loading&&this._loadMoreCallback!==null){this._loading=!0;var u=t[0];this._loadMoreCallback((e=u==null?void 0:u.timestamp)!==null&&e!==void 0?e:null)}},i.prototype.setMore=function(e){return this._more=e,this},i.prototype.setLoading=function(e){return this._loading=e,this},i.prototype.getDateTimeFormat=function(){return this._dateTimeFormat},i.prototype._buildDateTimeFormat=function(e){var t={hour12:!1,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"};e!==void 0&&(t.timeZone=e);var n=null;try{n=new Intl.DateTimeFormat("en",t)}catch{}return n},i.prototype.setTimezone=function(e){var t=this._buildDateTimeFormat(e);t!==null&&(this._dateTimeFormat=t)},i.prototype.getTimezone=function(){return this._dateTimeFormat.resolvedOptions().timeZone},i.prototype.getBarSpace=function(){return{bar:this._barSpace,halfBar:this._barSpace/2,gapBar:this._gapBarSpace,halfGapBar:this._gapBarSpace/2}},i.prototype.setBarSpace=function(e,t){tn>e||e>on||this._barSpace===e||(this._barSpace=e,this._gapBarSpace=this._calcGapBarSpace(),t==null||t(),this.adjustVisibleRange(),this._chartStore.getTooltipStore().recalculateCrosshair(!0),this._chartStore.getChart().adjustPaneViewport(!1,!0,!0,!0))},i.prototype.setTotalBarSpace=function(e){return this._totalBarSpace!==e&&(this._totalBarSpace=e,this.adjustVisibleRange(),this._chartStore.getTooltipStore().recalculateCrosshair(!0)),this},i.prototype.setOffsetRightDistance=function(e,t){return this._offsetRightDistance=e,this._offsetRightBarCount=e/this._barSpace,t!=null&&t&&(this.adjustVisibleRange(),this._chartStore.getTooltipStore().recalculateCrosshair(!0),this._chartStore.getChart().adjustPaneViewport(!1,!0,!0,!0)),this},i.prototype.resetOffsetRightDistance=function(){this.setOffsetRightDistance(this._offsetRightDistance)},i.prototype.getInitialOffsetRightDistance=function(){return this._offsetRightDistance},i.prototype.getOffsetRightDistance=function(){return Math.max(0,this._offsetRightBarCount*this._barSpace)},i.prototype.getOffsetRightBarCount=function(){return this._offsetRightBarCount},i.prototype.setOffsetRightBarCount=function(e){return this._offsetRightBarCount=e,this},i.prototype.setLeftMinVisibleBarCount=function(e){return this._minVisibleBarCount.left=e,this},i.prototype.setRightMinVisibleBarCount=function(e){return this._minVisibleBarCount.right=e,this},i.prototype.getVisibleRange=function(){return this._visibleRange},i.prototype.startScroll=function(){this._startScrollOffsetRightBarCount=this._offsetRightBarCount},i.prototype.scroll=function(e){if(this._scrollEnabled){var t=e/this._barSpace;this._chartStore.getActionStore().execute(g.ActionType.OnScroll),this._offsetRightBarCount=this._startScrollOffsetRightBarCount-t,this.adjustVisibleRange(),this._chartStore.getTooltipStore().recalculateCrosshair(!0),this._chartStore.getChart().adjustPaneViewport(!1,!0,!0,!0)}},i.prototype.getDataByDataIndex=function(e){var t;return(t=this._chartStore.getDataList()[e])!==null&&t!==void 0?t:null},i.prototype.coordinateToFloatIndex=function(e){var t=this._chartStore.getDataList().length;return Math.round(1e6*(t+this._offsetRightBarCount-(this._totalBarSpace-e)/this._barSpace))/1e6},i.prototype.dataIndexToTimestamp=function(e){var t,n=this.getDataByDataIndex(e);return(t=n==null?void 0:n.timestamp)!==null&&t!==void 0?t:null},i.prototype.timestampToDataIndex=function(e){var t=this._chartStore.getDataList();return t.length===0?0:xt(t,"timestamp",e)},i.prototype.dataIndexToCoordinate=function(e){var t=this._chartStore.getDataList().length;return this._totalBarSpace-(t+this._offsetRightBarCount-e-.5)*this._barSpace},i.prototype.coordinateToDataIndex=function(e){return Math.ceil(this.coordinateToFloatIndex(e))-1},i.prototype.zoom=function(e,t){var n,o=this;if(this._zoomEnabled){if((t==null?void 0:t.x)===void 0){var r=this._chartStore.getTooltipStore().getCrosshair();t={x:(n=r==null?void 0:r.x)!==null&&n!==void 0?n:this._totalBarSpace/2}}this._chartStore.getActionStore().execute(g.ActionType.OnZoom);var a=this.coordinateToFloatIndex(t.x);this.setBarSpace(this._barSpace+e*(this._barSpace/10),function(){o._offsetRightBarCount+=a-o.coordinateToFloatIndex(t==null?void 0:t.x)})}},i.prototype.setZoomEnabled=function(e){return this._zoomEnabled=e,this},i.prototype.getZoomEnabled=function(){return this._zoomEnabled},i.prototype.setScrollEnabled=function(e){return this._scrollEnabled=e,this},i.prototype.getScrollEnabled=function(){return this._scrollEnabled},i.prototype.setLoadMoreCallback=function(e){return this._loadMoreCallback=e,this},i.prototype.clear=function(){this._more=!0,this._loading=!0,this._visibleRange={from:0,to:0,realFrom:0,realTo:0}},i}();function St(i,e,t,n,o){var r,a=e.result,s=e.figures,l=e.styles,u=U(l,"circles",n.circles),c=u.length,h=U(l,"bars",n.bars),d=h.length,p=U(l,"lines",n.lines),v=p.length,f=0,y=0,m=0;s.forEach(function(_){var x;switch(_.type){case"circle":var C=u[f%c];r=k(k({},C),{color:C.noChangeColor}),f++;break;case"bar":var S=h[y%d];r=k(k({},S),{color:S.noChangeColor}),y++;break;case"line":r=p[m%v],m++}if(Y(r)){var E=(x=_.styles)===null||x===void 0?void 0:x.call(_,{prev:{kLineData:i[t-1],indicatorData:a[t-1]},current:{kLineData:i[t],indicatorData:a[t]},next:{kLineData:i[t+1],indicatorData:a[t+1]}},e,n);o(_,k(k({},r),E))}})}g.IndicatorSeries=void 0,(Ct=g.IndicatorSeries||(g.IndicatorSeries={})).Normal="normal",Ct.Price="price",Ct.Volume="volume";var Gt=function(){function i(e){this.result=[],this._precisionFlag=!1;var t=e.name,n=e.shortName,o=e.series,r=e.calcParams,a=e.figures,s=e.precision,l=e.shouldOhlc,u=e.shouldFormatBigNumber,c=e.visible,h=e.minValue,d=e.maxValue,p=e.styles,v=e.extendData,f=e.regenerateFigures,y=e.createTooltipDataSource,m=e.draw;this.name=t,this.shortName=n??t,this.series=o??g.IndicatorSeries.Normal,this.precision=s??4,this.calcParams=r??[],this.figures=a??[],this.shouldOhlc=l!=null&&l,this.shouldFormatBigNumber=u!=null&&u,this.visible=c==null||c,this.minValue=h??null,this.maxValue=d??null,this.styles=p??{},this.extendData=v,this.regenerateFigures=f??null,this.createTooltipDataSource=y??null,this.draw=m??null}return i.prototype.setShortName=function(e){return this.shortName!==e&&(this.shortName=e,!0)},i.prototype.setSeries=function(e){return this.series!==e&&(this.series=e,!0)},i.prototype.setPrecision=function(e,t){var n=t!=null&&t,o=Math.floor(e);return!(o===this.precision||0>e||n&&(!n||this._precisionFlag))&&(this.precision=o,n||(this._precisionFlag=!0),!0)},i.prototype.setCalcParams=function(e){var t,n;return this.calcParams=e,this.figures=(n=(t=this.regenerateFigures)===null||t===void 0?void 0:t.call(this,e))!==null&&n!==void 0?n:this.figures,!0},i.prototype.setShouldOhlc=function(e){return this.shouldOhlc!==e&&(this.shouldOhlc=e,!0)},i.prototype.setShouldFormatBigNumber=function(e){return this.shouldFormatBigNumber!==e&&(this.shouldFormatBigNumber=e,!0)},i.prototype.setVisible=function(e){return this.visible!==e&&(this.visible=e,!0)},i.prototype.setStyles=function(e){return e!==null&&(I(this.styles,e),!0)},i.prototype.setExtendData=function(e){return this.extendData!==e&&(this.extendData=e,!0)},i.prototype.setFigures=function(e){return this.figures!==e&&(this.figures=e,!0)},i.prototype.setMinValue=function(e){return this.minValue!==e&&(this.minValue=e,!0)},i.prototype.setMaxValue=function(e){return this.maxValue!==e&&(this.maxValue=e,!0)},i.prototype.setRegenerateFigures=function(e){return this.regenerateFigures!==e&&(this.regenerateFigures=e,!0)},i.prototype.setCreateTooltipDataSource=function(e){return this.createTooltipDataSource!==e&&(this.createTooltipDataSource=e,!0)},i.prototype.setDraw=function(e){return this.draw!==e&&(this.draw=e,!0)},i.prototype.calcIndicator=function(e){return et(this,void 0,void 0,function(){var t;return tt(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this.calc(e,this)];case 1:return t=n.sent(),this.result=t,[2,!0];case 2:return n.sent(),[2,!1];case 3:return[2]}})})},i.extend=function(e){return function(t){function n(){return t.call(this,e)||this}return N(n,t),n.prototype.calc=function(o,r){return e.calc(o,r)},n}(i)},i}(),rn={name:"AVP",shortName:"AVP",series:g.IndicatorSeries.Price,precision:2,figures:[{key:"avp",title:"AVP: ",type:"line"}],calc:function(i){var e=0,t=0;return i.map(function(n){var o,r,a={},s=(o=n==null?void 0:n.turnover)!==null&&o!==void 0?o:0,l=(r=n==null?void 0:n.volume)!==null&&r!==void 0?r:0;return e+=s,(t+=l)!==0&&(a.avp=e/t),a})}},an={name:"EMA",shortName:"EMA",series:g.IndicatorSeries.Price,calcParams:[6,12,20],precision:2,shouldOhlc:!0,figures:[{key:"ema1",title:"EMA6: ",type:"line"},{key:"ema2",title:"EMA12: ",type:"line"},{key:"ema3",title:"EMA20: ",type:"line"}],regenerateFigures:function(i){return i.map(function(e,t){return{key:"ema".concat(t+1),title:"EMA".concat(e,": "),type:"line"}})},calc:function(i,e){var t=e.calcParams,n=e.figures,o=0,r=[];return i.map(function(a,s){var l={},u=a.close;return o+=u,t.forEach(function(c,h){c-1>s||(r[h]=s>c-1?(2*u+(c-1)*r[h])/(c+1):o/c,l[n[h].key]=r[h])}),l})}},sn={name:"MA",shortName:"MA",series:g.IndicatorSeries.Price,calcParams:[5,10,30,60],precision:2,shouldOhlc:!0,figures:[{key:"ma5",title:"MA5: ",type:"line"},{key:"ma10",title:"MA10: ",type:"line"},{key:"ma30",title:"MA30: ",type:"line"},{key:"ma60",title:"MA60: ",type:"line"}],regenerateFigures:function(i){return i.map(function(e,t){return{key:"ma".concat(t+1),title:"MA".concat(e,": "),type:"line"}})},calc:function(i,e){var t=e.calcParams,n=e.figures,o=[];return i.map(function(r,a){var s={},l=r.close;return t.forEach(function(u,c){var h;o[c]=((h=o[c])!==null&&h!==void 0?h:0)+l,u-1>a||(s[n[c].key]=o[c]/u,o[c]-=i[a-(u-1)].close)}),s})}},ln={name:"RSI",shortName:"RSI",calcParams:[6,12,24],figures:[{key:"rsi1",title:"RSI1: ",type:"line"},{key:"rsi2",title:"RSI2: ",type:"line"},{key:"rsi3",title:"RSI3: ",type:"line"}],regenerateFigures:function(i){return i.map(function(e,t){var n=t+1;return{key:"rsi".concat(n),title:"RSI".concat(n,": "),type:"line"}})},calc:function(i,e){var t=e.calcParams,n=e.figures,o=[],r=[];return i.map(function(a,s){var l,u={},c=((l=i[s-1])!==null&&l!==void 0?l:a).close,h=a.close-c;return t.forEach(function(d,p){var v,f,y;if(h>0?o[p]=((v=o[p])!==null&&v!==void 0?v:0)+h:r[p]=((f=r[p])!==null&&f!==void 0?f:0)+Math.abs(h),s>=d-1){u[n[p].key]=r[p]!==0?100-100/(1+o[p]/r[p]):0;var m=i[s-(d-1)],_=(y=i[s-d])!==null&&y!==void 0?y:m,x=m.close-_.close;x>0?o[p]-=x:r[p]-=Math.abs(x)}}),u})}},un={name:"VOL",shortName:"VOL",series:g.IndicatorSeries.Volume,calcParams:[5,10,20],shouldFormatBigNumber:!0,precision:0,minValue:0,figures:[{key:"ma1",title:"MA5: ",type:"line"},{key:"ma2",title:"MA10: ",type:"line"},{key:"ma3",title:"MA20: ",type:"line"},{key:"volume",title:"VOLUME: ",type:"bar",baseValue:0,styles:function(i,e,t){var n=i.current.kLineData;return{color:n.close>n.open?U(e.styles,"bars[0].upColor",t.bars[0].upColor):n.open>n.close?U(e.styles,"bars[0].downColor",t.bars[0].downColor):U(e.styles,"bars[0].noChangeColor",t.bars[0].noChangeColor)}}}],regenerateFigures:function(i){var e=i.map(function(t,n){return{key:"ma".concat(n+1),title:"MA".concat(t,": "),type:"line"}});return e.push({key:"volume",title:"VOLUME: ",type:"bar",baseValue:0,styles:function(t,n,o){var r=t.current.kLineData;return{color:r.close>r.open?U(n.styles,"bars[0].upColor",o.bars[0].upColor):r.open>r.close?U(n.styles,"bars[0].downColor",o.bars[0].downColor):U(n.styles,"bars[0].noChangeColor",o.bars[0].noChangeColor)}}}),e},calc:function(i,e){var t=e.calcParams,n=e.figures,o=[];return i.map(function(r,a){var s,l=(s=r.volume)!==null&&s!==void 0?s:0,u={volume:l};return t.forEach(function(c,h){var d,p;o[h]=((d=o[h])!==null&&d!==void 0?d:0)+l,c-1>a||(u[n[h].key]=o[h]/c,o[h]-=(p=i[a-(c-1)].volume)!==null&&p!==void 0?p:0)}),u})}},cn={name:"WR",shortName:"WR",calcParams:[6,10,14],figures:[{key:"wr1",title:"WR1: ",type:"line"},{key:"wr2",title:"WR2: ",type:"line"},{key:"wr3",title:"WR3: ",type:"line"}],regenerateFigures:function(i){return i.map(function(e,t){return{key:"wr".concat(t+1),title:"WR".concat(t+1,": "),type:"line"}})},calc:function(i,e){var t=e.calcParams,n=e.figures;return i.map(function(o,r){var a={},s=o.close;return t.forEach(function(l,u){var c=l-1;if(r>=c){var h=Zt(i.slice(r-c,r+1),"high","low"),d=h[0],p=d-h[1];a[n[u].key]=p===0?0:(s-d)/p*100}}),a})}},nt={},hn=[rn,{name:"AO",shortName:"AO",calcParams:[5,34],figures:[{key:"ao",title:"AO: ",type:"bar",baseValue:0,styles:function(i,e,t){var n,o,r,a,s,l=(o=(n=i.prev.indicatorData)===null||n===void 0?void 0:n.ao)!==null&&o!==void 0?o:Number.MIN_SAFE_INTEGER,u=(a=(r=i.current.indicatorData)===null||r===void 0?void 0:r.ao)!==null&&a!==void 0?a:Number.MIN_SAFE_INTEGER;return{color:s=u>l?U(e.styles,"bars[0].upColor",t.bars[0].upColor):U(e.styles,"bars[0].downColor",t.bars[0].downColor),style:u>l?g.PolygonType.Stroke:g.PolygonType.Fill,borderColor:s}}}],calc:function(i,e){var t=e.calcParams,n=Math.max(t[0],t[1]),o=0,r=0,a=0,s=0;return i.map(function(l,u){var c,h={},d=(l.low+l.high)/2;return o+=d,r+=d,u<t[0]-1||(a=o/t[0],o-=((c=i[u-(t[0]-1)]).low+c.high)/2),u<t[1]-1||(s=r/t[1],r-=((c=i[u-(t[1]-1)]).low+c.high)/2),n-1>u||(h.ao=a-s),h})}},{name:"BIAS",shortName:"BIAS",calcParams:[6,12,24],figures:[{key:"bias1",title:"BIAS6: ",type:"line"},{key:"bias2",title:"BIAS12: ",type:"line"},{key:"bias3",title:"BIAS24: ",type:"line"}],regenerateFigures:function(i){return i.map(function(e,t){return{key:"bias".concat(t+1),title:"BIAS".concat(e,": "),type:"line"}})},calc:function(i,e){var t=e.calcParams,n=e.figures,o=[];return i.map(function(r,a){var s={},l=r.close;return t.forEach(function(u,c){var h;if(o[c]=((h=o[c])!==null&&h!==void 0?h:0)+l,a>=u-1){var d=o[c]/t[c];s[n[c].key]=(l-d)/d*100,o[c]-=i[a-(u-1)].close}}),s})}},{name:"BOLL",shortName:"BOLL",series:g.IndicatorSeries.Price,calcParams:[20,2],precision:2,shouldOhlc:!0,figures:[{key:"up",title:"UP: ",type:"line"},{key:"mid",title:"MID: ",type:"line"},{key:"dn",title:"DN: ",type:"line"}],calc:function(i,e){var t=e.calcParams,n=t[0]-1,o=0;return i.map(function(r,a){var s={};if(o+=r.close,a>=n){s.mid=o/t[0];var l=function(u,c){var h=u.length,d=0;return u.forEach(function(p){var v=p.close-c;d+=v*v}),Math.sqrt((d=Math.abs(d))/h)}(i.slice(a-n,a+1),s.mid);s.up=s.mid+t[1]*l,s.dn=s.mid-t[1]*l,o-=i[a-n].close}return s})}},{name:"BRAR",shortName:"BRAR",calcParams:[26],figures:[{key:"br",title:"BR: ",type:"line"},{key:"ar",title:"AR: ",type:"line"}],calc:function(i,e){var t=e.calcParams,n=0,o=0,r=0,a=0;return i.map(function(s,l){var u,c,h={},d=s.high,p=s.low,v=s.open,f=((u=i[l-1])!==null&&u!==void 0?u:s).close;if(r+=d-v,a+=v-p,n+=d-f,o+=f-p,l>=t[0]-1){h.ar=a!==0?r/a*100:0,h.br=o!==0?n/o*100:0;var y=i[l-(t[0]-1)],m=y.high,_=y.low,x=y.open,C=((c=i[l-t[0]])!==null&&c!==void 0?c:i[l-(t[0]-1)]).close;n-=m-C,o-=C-_,r-=m-x,a-=x-_}return h})}},{name:"BBI",shortName:"BBI",series:g.IndicatorSeries.Price,precision:2,calcParams:[3,6,12,24],shouldOhlc:!0,figures:[{key:"bbi",title:"BBI: ",type:"line"}],calc:function(i,e){var t=e.calcParams,n=Math.max.apply(Math,qt([],ee(t),!1)),o=[],r=[];return i.map(function(a,s){var l={},u=a.close;if(t.forEach(function(h,d){var p;o[d]=((p=o[d])!==null&&p!==void 0?p:0)+u,h-1>s||(r[d]=o[d]/h,o[d]-=i[s-(h-1)].close)}),s>=n-1){var c=0;r.forEach(function(h){c+=h}),l.bbi=c/4}return l})}},{name:"CCI",shortName:"CCI",calcParams:[20],figures:[{key:"cci",title:"CCI: ",type:"line"}],calc:function(i,e){var t=e.calcParams,n=t[0]-1,o=0,r=[];return i.map(function(a,s){var l={},u=(a.high+a.low+a.close)/3;if(o+=u,r.push(u),s>=n){var c=o/t[0],h=r.slice(s-n,s+1),d=0;h.forEach(function(v){d+=Math.abs(v-c)});var p=d/t[0];l.cci=p!==0?(u-c)/p/.015:0,o-=(i[s-n].high+i[s-n].low+i[s-n].close)/3}return l})}},{name:"CR",shortName:"CR",calcParams:[26,10,20,40,60],figures:[{key:"cr",title:"CR: ",type:"line"},{key:"ma1",title:"MA1: ",type:"line"},{key:"ma2",title:"MA2: ",type:"line"},{key:"ma3",title:"MA3: ",type:"line"},{key:"ma4",title:"MA4: ",type:"line"}],calc:function(i,e){var t=e.calcParams,n=Math.ceil(t[1]/2.5+1),o=Math.ceil(t[2]/2.5+1),r=Math.ceil(t[3]/2.5+1),a=Math.ceil(t[4]/2.5+1),s=0,l=[],u=0,c=[],h=0,d=[],p=0,v=[],f=[];return i.forEach(function(y,m){var _,x,C,S,E,b={},T=(_=i[m-1])!==null&&_!==void 0?_:y,D=(T.high+T.close+T.low+T.open)/4,A=Math.max(0,y.high-D),F=Math.max(0,D-y.low);t[0]-1>m||(b.cr=F!==0?A/F*100:0,s+=b.cr,u+=b.cr,h+=b.cr,p+=b.cr,t[0]+t[1]-2>m||(l.push(s/t[1]),t[0]+t[1]+n-3>m||(b.ma1=l[l.length-1-n]),s-=(x=f[m-(t[1]-1)].cr)!==null&&x!==void 0?x:0),t[0]+t[2]-2>m||(c.push(u/t[2]),t[0]+t[2]+o-3>m||(b.ma2=c[c.length-1-o]),u-=(C=f[m-(t[2]-1)].cr)!==null&&C!==void 0?C:0),t[0]+t[3]-2>m||(d.push(h/t[3]),t[0]+t[3]+r-3>m||(b.ma3=d[d.length-1-r]),h-=(S=f[m-(t[3]-1)].cr)!==null&&S!==void 0?S:0),t[0]+t[4]-2>m||(v.push(p/t[4]),t[0]+t[4]+a-3>m||(b.ma4=v[v.length-1-a]),p-=(E=f[m-(t[4]-1)].cr)!==null&&E!==void 0?E:0)),f.push(b)}),f}},{name:"DMA",shortName:"DMA",calcParams:[10,50,10],figures:[{key:"dma",title:"DMA: ",type:"line"},{key:"ama",title:"AMA: ",type:"line"}],calc:function(i,e){var t=e.calcParams,n=Math.max(t[0],t[1]),o=0,r=0,a=0,s=[];return i.forEach(function(l,u){var c,h={},d=l.close;o+=d,r+=d;var p=0,v=0;if(t[0]-1>u||(p=o/t[0],o-=i[u-(t[0]-1)].close),t[1]-1>u||(v=r/t[1],r-=i[u-(t[1]-1)].close),u>=n-1){var f=p-v;h.dma=f,a+=f,n+t[2]-2>u||(h.ama=a/t[2],a-=(c=s[u-(t[2]-1)].dma)!==null&&c!==void 0?c:0)}s.push(h)}),s}},{name:"DMI",shortName:"DMI",calcParams:[14,6],figures:[{key:"pdi",title:"PDI: ",type:"line"},{key:"mdi",title:"MDI: ",type:"line"},{key:"adx",title:"ADX: ",type:"line"},{key:"adxr",title:"ADXR: ",type:"line"}],calc:function(i,e){var t=e.calcParams,n=0,o=0,r=0,a=0,s=0,l=0,u=0,c=0,h=[];return i.forEach(function(d,p){var v,f,y={},m=(v=i[p-1])!==null&&v!==void 0?v:d,_=m.close,x=d.high,C=d.low,S=x-C,E=Math.abs(x-_),b=Math.abs(_-C),T=x-m.high,D=m.low-C,A=Math.max(Math.max(S,E),b),F=T>0&&T>D?T:0,B=D>0&&D>T?D:0;if(n+=A,o+=F,r+=B,p>=t[0]-1){p>t[0]-1?(a=a-a/t[0]+A,s=s-s/t[0]+F,l=l-l/t[0]+B):(a=n,s=o,l=r);var R=0,z=0;a!==0&&(R=100*s/a,z=100*l/a),y.pdi=R,y.mdi=z;var W=0;z+R!==0&&(W=Math.abs(z-R)/(z+R)*100),u+=W,2*t[0]-2>p||(y.adx=c=p>2*t[0]-2?(c*(t[0]-1)+W)/t[0]:u/t[0],2*t[0]+t[1]-3>p||(y.adxr=(((f=h[p-(t[1]-1)].adx)!==null&&f!==void 0?f:0)+c)/2))}h.push(y)}),h}},{name:"EMV",shortName:"EMV",calcParams:[14,9],figures:[{key:"emv",title:"EMV: ",type:"line"},{key:"maEmv",title:"MAEMV: ",type:"line"}],calc:function(i,e){var t=e.calcParams,n=0,o=[];return i.map(function(r,a){var s,l={};if(a>0){var u=i[a-1],c=r.high,h=r.low,d=(s=r.volume)!==null&&s!==void 0?s:0,p=(c+h)/2-(u.high+u.low)/2;d===0||c-h==0?l.emv=0:l.emv=p/(d/1e8/(c-h)),n+=l.emv,o.push(l.emv),t[0]>a||(l.maEmv=n/t[0],n-=o[a-t[0]])}return l})}},an,{name:"MTM",shortName:"MTM",calcParams:[12,6],figures:[{key:"mtm",title:"MTM: ",type:"line"},{key:"maMtm",title:"MAMTM: ",type:"line"}],calc:function(i,e){var t=e.calcParams,n=0,o=[];return i.forEach(function(r,a){var s,l={};a<t[0]||(l.mtm=r.close-i[a-t[0]].close,n+=l.mtm,t[0]+t[1]-1>a||(l.maMtm=n/t[1],n-=(s=o[a-(t[1]-1)].mtm)!==null&&s!==void 0?s:0)),o.push(l)}),o}},sn,{name:"MACD",shortName:"MACD",calcParams:[12,26,9],figures:[{key:"dif",title:"DIF: ",type:"line"},{key:"dea",title:"DEA: ",type:"line"},{key:"macd",title:"MACD: ",type:"bar",baseValue:0,styles:function(i,e,t){var n,o,r,a,s,l=(o=(n=i.prev.indicatorData)===null||n===void 0?void 0:n.macd)!==null&&o!==void 0?o:Number.MIN_SAFE_INTEGER,u=(a=(r=i.current.indicatorData)===null||r===void 0?void 0:r.macd)!==null&&a!==void 0?a:Number.MIN_SAFE_INTEGER;return s=u>0?U(e.styles,"bars[0].upColor",t.bars[0].upColor):0>u?U(e.styles,"bars[0].downColor",t.bars[0].downColor):U(e.styles,"bars[0].noChangeColor",t.bars[0].noChangeColor),{style:u>l?g.PolygonType.Stroke:g.PolygonType.Fill,color:s,borderColor:s}}}],calc:function(i,e){var t,n,o=e.calcParams,r=0,a=0,s=0,l=0,u=Math.max(o[0],o[1]);return i.map(function(c,h){var d={},p=c.close;return r+=p,o[0]-1>h||(t=h>o[0]-1?(2*p+(o[0]-1)*t)/(o[0]+1):r/o[0]),o[1]-1>h||(n=h>o[1]-1?(2*p+(o[1]-1)*n)/(o[1]+1):r/o[1]),u-1>h||(d.dif=a=t-n,s+=a,u+o[2]-2>h||(d.macd=2*(a-(l=h>u+o[2]-2?(2*a+l*(o[2]-1))/(o[2]+1):s/o[2])),d.dea=l)),d})}},{name:"OBV",shortName:"OBV",calcParams:[30],figures:[{key:"obv",title:"OBV: ",type:"line"},{key:"maObv",title:"MAOBV: ",type:"line"}],calc:function(i,e){var t=e.calcParams,n=0,o=0,r=[];return i.forEach(function(a,s){var l,u,c,h,d=(l=i[s-1])!==null&&l!==void 0?l:a;d.close>a.close?o-=(u=a.volume)!==null&&u!==void 0?u:0:a.close>d.close&&(o+=(c=a.volume)!==null&&c!==void 0?c:0);var p={obv:o};n+=o,t[0]-1>s||(p.maObv=n/t[0],n-=(h=r[s-(t[0]-1)].obv)!==null&&h!==void 0?h:0),r.push(p)}),r}},{name:"PVT",shortName:"PVT",figures:[{key:"pvt",title:"PVT: ",type:"line"}],calc:function(i){var e=0;return i.map(function(t,n){var o,r,a={},s=(o=t.volume)!==null&&o!==void 0?o:1,l=((r=i[n-1])!==null&&r!==void 0?r:t).close,u=0,c=l*s;return c!==0&&(u=(t.close-l)/c),a.pvt=e+=u,a})}},{name:"PSY",shortName:"PSY",calcParams:[12,6],figures:[{key:"psy",title:"PSY: ",type:"line"},{key:"maPsy",title:"MAPSY: ",type:"line"}],calc:function(i,e){var t=e.calcParams,n=0,o=0,r=[],a=[];return i.forEach(function(s,l){var u,c,h={},d=((u=i[l-1])!==null&&u!==void 0?u:s).close,p=s.close-d>0?1:0;r.push(p),n+=p,t[0]-1>l||(h.psy=n/t[0]*100,o+=h.psy,t[0]+t[1]-2>l||(h.maPsy=o/t[1],o-=(c=a[l-(t[1]-1)].psy)!==null&&c!==void 0?c:0),n-=r[l-(t[0]-1)]),a.push(h)}),a}},{name:"ROC",shortName:"ROC",calcParams:[12,6],figures:[{key:"roc",title:"ROC: ",type:"line"},{key:"maRoc",title:"MAROC: ",type:"line"}],calc:function(i,e){var t=e.calcParams,n=[],o=0;return i.forEach(function(r,a){var s,l,u={};if(a>=t[0]-1){var c=((s=i[a-t[0]])!==null&&s!==void 0?s:i[a-(t[0]-1)]).close;u.roc=c!==0?(r.close-c)/c*100:0,o+=u.roc,t[0]-1+t[1]-1>a||(u.maRoc=o/t[1],o-=(l=n[a-(t[1]-1)].roc)!==null&&l!==void 0?l:0)}n.push(u)}),n}},ln,{name:"SMA",shortName:"SMA",series:g.IndicatorSeries.Price,calcParams:[12,2],precision:2,figures:[{key:"sma",title:"SMA: ",type:"line"}],shouldOhlc:!0,calc:function(i,e){var t=e.calcParams,n=0,o=0;return i.map(function(r,a){var s={},l=r.close;return n+=l,t[0]-1>a||(s.sma=o=a>t[0]-1?(l*t[1]+o*(t[0]-t[1]+1))/(t[0]+1):n/t[0]),s})}},{name:"KDJ",shortName:"KDJ",calcParams:[9,3,3],figures:[{key:"k",title:"K: ",type:"line"},{key:"d",title:"D: ",type:"line"},{key:"j",title:"J: ",type:"line"}],calc:function(i,e){var t=e.calcParams,n=[];return i.forEach(function(o,r){var a,s,l,u,c={},h=o.close;if(r>=t[0]-1){var d=Zt(i.slice(r-(t[0]-1),r+1),"high","low"),p=d[1],v=d[0]-p;c.k=((t[1]-1)*((s=(a=n[r-1])===null||a===void 0?void 0:a.k)!==null&&s!==void 0?s:50)+(h-p)/(v===0?1:v)*100)/t[1],c.d=((t[2]-1)*((u=(l=n[r-1])===null||l===void 0?void 0:l.d)!==null&&u!==void 0?u:50)+c.k)/t[2],c.j=3*c.k-2*c.d}n.push(c)}),n}},{name:"SAR",shortName:"SAR",series:g.IndicatorSeries.Price,calcParams:[2,2,20],precision:2,shouldOhlc:!0,figures:[{key:"sar",title:"SAR: ",type:"circle",styles:function(i,e,t){var n,o,r=i.current,a=(o=(n=r.indicatorData)===null||n===void 0?void 0:n.sar)!==null&&o!==void 0?o:Number.MIN_SAFE_INTEGER,s=r.kLineData;return{color:((s==null?void 0:s.high)+(s==null?void 0:s.low))/2>a?U(e.styles,"circles[0].upColor",t.circles[0].upColor):U(e.styles,"circles[0].downColor",t.circles[0].downColor)}}}],calc:function(i,e){var t=e.calcParams,n=t[0]/100,o=t[1]/100,r=t[2]/100,a=n,s=-100,l=!1,u=0;return i.map(function(c,h){var d=u,p=c.high,v=c.low;if(l){(s===-100||p>s)&&(s=p,a=Math.min(a+o,r)),u=d+a*(s-d);var f=Math.min(i[Math.max(1,h)-1].low,v);u>c.low?(u=s,a=n,s=-100,l=!l):u>f&&(u=f)}else{(s===-100||s>v)&&(s=v,a=Math.min(a+o,r)),u=d+a*(s-d);var y=Math.max(i[Math.max(1,h)-1].high,p);c.high>u?(u=s,a=0,s=-100,l=!l):y>u&&(u=y)}return{sar:u}})}},{name:"TRIX",shortName:"TRIX",calcParams:[12,9],figures:[{key:"trix",title:"TRIX: ",type:"line"},{key:"maTrix",title:"MATRIX: ",type:"line"}],calc:function(i,e){var t,n,o,r=e.calcParams,a=0,s=0,l=0,u=0,c=[];return i.forEach(function(h,d){var p,v={},f=h.close;if(a+=f,d>=r[0]-1&&(s+=t=d>r[0]-1?(2*f+(r[0]-1)*t)/(r[0]+1):a/r[0],d>=2*r[0]-2&&(l+=n=d>2*r[0]-2?(2*t+(r[0]-1)*n)/(r[0]+1):s/r[0],d>=3*r[0]-3))){var y=void 0,m=0;d>3*r[0]-3?m=((y=(2*n+(r[0]-1)*o)/(r[0]+1))-o)/o*100:y=l/r[0],o=y,v.trix=m,u+=m,3*r[0]+r[1]-4>d||(v.maTrix=u/r[1],u-=(p=c[d-(r[1]-1)].trix)!==null&&p!==void 0?p:0)}c.push(v)}),c}},un,{name:"VR",shortName:"VR",calcParams:[26,6],figures:[{key:"vr",title:"VR: ",type:"line"},{key:"maVr",title:"MAVR: ",type:"line"}],calc:function(i,e){var t=e.calcParams,n=0,o=0,r=0,a=0,s=[];return i.forEach(function(l,u){var c,h,d,p,v,f={},y=l.close,m=((c=i[u-1])!==null&&c!==void 0?c:l).close,_=(h=l.volume)!==null&&h!==void 0?h:0;if(y>m?n+=_:m>y?o+=_:r+=_,u>=t[0]-1){var x=r/2;f.vr=o+x===0?0:(n+x)/(o+x)*100,a+=f.vr,t[0]+t[1]-2>u||(f.maVr=a/t[1],a-=(d=s[u-(t[1]-1)].vr)!==null&&d!==void 0?d:0);var C=i[u-(t[0]-1)],S=(p=i[u-t[0]])!==null&&p!==void 0?p:C,E=C.close,b=(v=C.volume)!==null&&v!==void 0?v:0;E>S.close?n-=b:S.close>E?o-=b:r-=b}s.push(f)}),s}},cn];function $t(i){var e;return(e=nt[i])!==null&&e!==void 0?e:null}hn.forEach(function(i){nt[i.name]=Gt.extend(i)});var bt,dn=function(){function i(e){this._instances=new Map,this._chartStore=e}return i.prototype._overrideInstance=function(e,t){var n=t.shortName,o=t.series,r=t.calcParams,a=t.precision,s=t.figures,l=t.minValue,u=t.maxValue,c=t.shouldOhlc,h=t.shouldFormatBigNumber,d=t.visible,p=t.styles,v=t.extendData,f=t.regenerateFigures,y=t.createTooltipDataSource,m=t.draw,_=t.calc,x=!1;n!==void 0&&e.setShortName(n)&&(x=!0),o!==void 0&&e.setSeries(o)&&(x=!0);var C=!1;return r!==void 0&&e.setCalcParams(r)&&(x=!0,C=!0),s!==void 0&&e.setFigures(s)&&(x=!0,C=!0),l!==void 0&&e.setMinValue(l)&&(x=!0),u!==void 0&&e.setMinValue(u)&&(x=!0),a!==void 0&&e.setPrecision(a)&&(x=!0),c!==void 0&&e.setShouldOhlc(c)&&(x=!0),h!==void 0&&e.setShouldFormatBigNumber(h)&&(x=!0),d!==void 0&&e.setVisible(d)&&(x=!0),p!==void 0&&e.setStyles(p)&&(x=!0),v!==void 0&&e.setExtendData(v)&&(x=!0,C=!0),f!==void 0&&e.setRegenerateFigures(f)&&(x=!0),y!==void 0&&e.setCreateTooltipDataSource(y)&&(x=!0),m!==void 0&&e.setDraw(m)&&(x=!0),_!==void 0&&(e.calc=_,C=!0),[x,C]},i.prototype.addInstance=function(e,t,n){var o;return et(this,void 0,void 0,function(){var r,a,s,l;return tt(this,function(u){switch(u.label){case 0:return r=e.name,a=this._instances.get(t),(o=a==null?void 0:a.has(r))!==null&&o!==void 0&&o?[4,Promise.reject(Error("Duplicate indicators."))]:[3,2];case 1:case 3:return[2,u.sent()];case 2:return a===void 0&&(a=new Map,this._instances.set(t,a)),s=$t(r),l=new s,this._overrideInstance(l,e),n||a.clear(),a.set(r,l),[4,l.calcIndicator(this._chartStore.getDataList())]}})})},i.prototype.getInstances=function(e){var t;return(t=this._instances.get(e))!==null&&t!==void 0?t:new Map},i.prototype.removeInstance=function(e,t){var n=!1,o=this._instances.get(e);return o!==void 0&&(t!==void 0?o.has(t)&&(o.delete(t),n=!0):(o.clear(),n=!0),o.size===0&&this._instances.delete(e)),n},i.prototype.hasInstances=function(e){return this._instances.has(e)},i.prototype.calcInstance=function(e,t){var n;return et(this,void 0,void 0,function(){var o,r,a,s=this;return tt(this,function(l){switch(l.label){case 0:return o=[],e!==void 0?t!==void 0?(r=this._instances.get(t),(n=r==null?void 0:r.has(e))!==null&&n!==void 0&&n&&(a=r==null?void 0:r.get(e),o.push(a.calcIndicator(this._chartStore.getDataList())))):this._instances.forEach(function(u){if(u.has(e)){var c=u==null?void 0:u.get(e);o.push(c.calcIndicator(s._chartStore.getDataList()))}}):this._instances.forEach(function(u){u.forEach(function(c){o.push(c.calcIndicator(s._chartStore.getDataList()))})}),[4,Promise.all(o)];case 1:return[2,l.sent().includes(!0)]}})})},i.prototype.getInstanceByPaneId=function(e,t){var n;if(e!==void 0){var o=this._instances.get(e);return t!==void 0?(n=o==null?void 0:o.get(t))!==null&&n!==void 0?n:null:o??null}return this._instances},i.prototype.setSeriesPrecision=function(e){this._instances.forEach(function(t){t.forEach(function(n){n.series===g.IndicatorSeries.Price&&n.setPrecision(e.price,!0),n.series===g.IndicatorSeries.Volume&&n.setPrecision(e.volume,!0)})})},i.prototype.override=function(e,t){return et(this,void 0,void 0,function(){var n,o,r,a,s,l,u=this;return tt(this,function(c){switch(c.label){case 0:return n=e.name,o=new Map,t!==null?(r=this._instances.get(t))!==void 0&&o.set(t,r):o=this._instances,a=!1,s=[],o.forEach(function(h){var d=h.get(n);if(d!==void 0){var p=u._overrideInstance(d,e);p[1]?s.push(d.calcIndicator(u._chartStore.getDataList())):p[0]&&(a=!0)}}),[4,Promise.all(s)];case 1:return l=c.sent(),[2,[a,l.includes(!0)]]}})})},i}(),pn=function(){function i(e){this._crosshair={},this._activeIcon=null,this._chartStore=e}return i.prototype.setCrosshair=function(e,t){var n,o,r=this._chartStore.getDataList(),a=e??{},s=r[o=a.x!==void 0?0>(n=this._chartStore.getTimeScaleStore().coordinateToDataIndex(a.x))?0:n>r.length-1?r.length-1:n:n=r.length-1],l=this._chartStore.getTimeScaleStore().dataIndexToCoordinate(n),u=this._crosshair.x,c=this._crosshair.y,h=this._crosshair.paneId;this._crosshair=k(k({},a),{realX:l,kLineData:s,realDataIndex:n,dataIndex:o}),u===a.x&&c===a.y&&h===a.paneId||(s!==null&&this._chartStore.getChart().crosshairChange(this._crosshair),t!=null&&t||this._chartStore.getChart().updatePane(1))},i.prototype.recalculateCrosshair=function(e){this.setCrosshair(this._crosshair,e)},i.prototype.getCrosshair=function(){return this._crosshair},i.prototype.setActiveIcon=function(e){this._activeIcon=e??null},i.prototype.getActiveIcon=function(){return this._activeIcon},i.prototype.clear=function(){this.setCrosshair({},!0),this.setActiveIcon()},i}();g.OverlayMode=void 0,(bt=g.OverlayMode||(g.OverlayMode={})).Normal="normal",bt.WeakMagnet="weak_magnet",bt.StrongMagnet="strong_magnet";var Oe="overlay_figure_",gn=Number.MAX_SAFE_INTEGER,Jt=function(){function i(e){this.currentStep=1,this.points=[],this._prevPressedPoint=null,this._prevPressedPoints=[];var t=e.mode,n=e.modeSensitivity,o=e.extendData,r=e.styles,a=e.totalStep,s=e.lock,l=e.visible,u=e.zLevel,c=e.needDefaultPointFigure,h=e.needDefaultXAxisFigure,d=e.needDefaultYAxisFigure,p=e.createPointFigures,v=e.createXAxisFigures,f=e.createYAxisFigures,y=e.performEventPressedMove,m=e.performEventMoveForDrawing,_=e.onDrawStart,x=e.onDrawing,C=e.onDrawEnd,S=e.onClick,E=e.onDoubleClick,b=e.onRightClick,T=e.onPressedMoveStart,D=e.onPressedMoving,A=e.onPressedMoveEnd,F=e.onMouseEnter,B=e.onMouseLeave,R=e.onRemoved,z=e.onSelected,W=e.onDeselected;this.name=e.name,this.totalStep=a===void 0||2>a?1:a,this.lock=s!=null&&s,this.visible=l==null||l,this.zLevel=u??0,this.needDefaultPointFigure=c!=null&&c,this.needDefaultXAxisFigure=h!=null&&h,this.needDefaultYAxisFigure=d!=null&&d,this.mode=t??g.OverlayMode.Normal,this.modeSensitivity=n??8,this.extendData=o,this.styles=r??{},this.createPointFigures=p??null,this.createXAxisFigures=v??null,this.createYAxisFigures=f??null,this.performEventPressedMove=y??null,this.performEventMoveForDrawing=m??null,this.onDrawStart=_??null,this.onDrawing=x??null,this.onDrawEnd=C??null,this.onClick=S??null,this.onDoubleClick=E??null,this.onRightClick=b??null,this.onPressedMoveStart=T??null,this.onPressedMoving=D??null,this.onPressedMoveEnd=A??null,this.onMouseEnter=F??null,this.onMouseLeave=B??null,this.onRemoved=R??null,this.onSelected=z??null,this.onDeselected=W??null}return i.prototype.setId=function(e){return this.id===void 0&&(this.id=e,!0)},i.prototype.setGroupId=function(e){return this.groupId===void 0&&(this.groupId=e,!0)},i.prototype.setDefaultZLevel=function(e){return this.defaultZLevel===void 0&&(this.defaultZLevel=e,!0)},i.prototype.setPaneId=function(e){this.paneId=e},i.prototype.setExtendData=function(e){return e!==this.extendData&&(this.extendData=e,!0)},i.prototype.setStyles=function(e){return e!==null&&(I(this.styles,e),!0)},i.prototype.setPoints=function(e){if(e.length>0){var t=void 0;if(this.points=qt([],ee(e),!1),this.totalStep-1>e.length?(this.currentStep=e.length+1,t=e.length):(this.currentStep=-1,t=this.totalStep-1),this.performEventMoveForDrawing!==null)for(var n=0;t>n;n++)this.performEventMoveForDrawing({currentStep:n+2,mode:this.mode,points:this.points,performPointIndex:n,performPoint:this.points[n]});return this.currentStep===-1&&this.performEventPressedMove!==null&&this.performEventPressedMove({currentStep:this.currentStep,mode:this.mode,points:this.points,performPointIndex:this.points.length-1,performPoint:this.points[this.points.length-1]}),!0}return!1},i.prototype.setLock=function(e){return this.lock!==e&&(this.lock=e,!0)},i.prototype.setVisible=function(e){return this.visible!==e&&(this.visible=e,!0)},i.prototype.resetZLevel=function(){this.zLevel=this.defaultZLevel},i.prototype.setZLevel=function(e){return this.zLevel!==e&&(this.zLevel=e,!0)},i.prototype.setMode=function(e){return this.mode!==e&&(this.mode=e,!0)},i.prototype.setModeSensitivity=function(e){return this.modeSensitivity!==e&&(this.modeSensitivity=e,!0)},i.prototype.setOnDrawStartCallback=function(e){return this.onDrawStart!==e&&(this.onDrawStart=e,!0)},i.prototype.setOnDrawingCallback=function(e){return this.onDrawing!==e&&(this.onDrawing=e,!0)},i.prototype.setOnDrawEndCallback=function(e){return this.onDrawEnd!==e&&(this.onDrawEnd=e,!0)},i.prototype.setOnClickCallback=function(e){return this.onClick!==e&&(this.onClick=e,!0)},i.prototype.setOnDoubleClickCallback=function(e){return this.onDoubleClick!==e&&(this.onDoubleClick=e,!0)},i.prototype.setOnRightClickCallback=function(e){return this.onRightClick!==e&&(this.onRightClick=e,!0)},i.prototype.setOnPressedMoveStartCallback=function(e){return this.onPressedMoveStart!==e&&(this.onPressedMoveStart=e,!0)},i.prototype.setOnPressedMovingCallback=function(e){return this.onPressedMoving!==e&&(this.onPressedMoving=e,!0)},i.prototype.setOnPressedMoveEndCallback=function(e){return this.onPressedMoveEnd!==e&&(this.onPressedMoveEnd=e,!0)},i.prototype.setOnMouseEnterCallback=function(e){return this.onMouseEnter!==e&&(this.onMouseEnter=e,!0)},i.prototype.setOnMouseLeaveCallback=function(e){return this.onMouseLeave!==e&&(this.onMouseLeave=e,!0)},i.prototype.setOnRemovedCallback=function(e){return this.onRemoved!==e&&(this.onRemoved=e,!0)},i.prototype.setOnSelectedCallback=function(e){return this.onSelected!==e&&(this.onSelected=e,!0)},i.prototype.setOnDeselectedCallback=function(e){return this.onDeselected!==e&&(this.onDeselected=e,!0)},i.prototype.nextStep=function(){this.currentStep===this.totalStep-1?this.currentStep=-1:this.currentStep++},i.prototype.forceComplete=function(){this.currentStep=-1},i.prototype.isDrawing=function(){return this.currentStep!==-1},i.prototype.isStart=function(){return this.currentStep===1},i.prototype.eventMoveForDrawing=function(e){var t,n=this.currentStep-1,o={};e.timestamp!==void 0&&(o.timestamp=e.timestamp),e.dataIndex!==void 0&&(o.dataIndex=e.dataIndex),e.value!==void 0&&(o.value=e.value),this.points[n]=o,(t=this.performEventMoveForDrawing)===null||t===void 0||t.call(this,{currentStep:this.currentStep,mode:this.mode,points:this.points,performPointIndex:n,performPoint:o})},i.prototype.eventPressedPointMove=function(e,t){var n;e.dataIndex!==void 0&&(this.points[t].dataIndex=e.dataIndex,this.points[t].timestamp=e.timestamp),e.value!==void 0&&(this.points[t].value=e.value),(n=this.performEventPressedMove)===null||n===void 0||n.call(this,{currentStep:this.currentStep,points:this.points,mode:this.mode,performPointIndex:t,performPoint:this.points[t]})},i.prototype.startPressedMove=function(e){this._prevPressedPoint=k({},e),this._prevPressedPoints=q(this.points)},i.prototype.eventPressedOtherMove=function(e,t){var n,o;this._prevPressedPoint!==null&&(e.dataIndex!==void 0&&this._prevPressedPoint.dataIndex!==void 0&&(n=e.dataIndex-this._prevPressedPoint.dataIndex),e.value!==void 0&&this._prevPressedPoint.value!==void 0&&(o=e.value-this._prevPressedPoint.value),this.points=this._prevPressedPoints.map(function(r){var a;r.dataIndex===void 0&&r.timestamp!==void 0&&(r.dataIndex=t.timestampToDataIndex(r.timestamp));var s=k({},r);return n!==void 0&&r.dataIndex!==void 0&&(s.dataIndex=r.dataIndex+n,s.timestamp=(a=t.dataIndexToTimestamp(s.dataIndex))!==null&&a!==void 0?a:void 0),o!==void 0&&r.value!==void 0&&(s.value=r.value+o),s}))},i.extend=function(e){return function(t){function n(){return t.call(this,e)||this}return N(n,t),n}(i)},i}(),vn={name:"fibonacciLine",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(i){var e=i.coordinates,t=i.precision,n=i.thousandsSeparator,o=i.overlay.points;if(e.length>0){var r=[],a=[],s=i.bounding.width;if(e.length>1&&o[0].value!==void 0&&o[1].value!==void 0){var l=e[0].y-e[1].y,u=o[0].value-o[1].value;[1,.786,.618,.5,.382,.236,0].forEach(function(c){var h,d=e[1].y+l*c,p=J((((h=o[1].value)!==null&&h!==void 0?h:0)+u*c).toFixed(t.price),n);r.push({coordinates:[{x:0,y:d},{x:s,y:d}]}),a.push({x:0,y:d,text:"".concat(p," (").concat((100*c).toFixed(1),"%)"),baseline:"bottom"})})}return[{type:"line",attrs:r},{type:"text",isCheckEvent:!1,attrs:a}]}return[]}},fn={name:"horizontalRayLine",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(i){var e=i.coordinates,t={x:0,y:e[0].y};return e[1]!==void 0&&e[1].x>e[0].x&&(t.x=i.bounding.width),[{type:"line",attrs:{coordinates:[e[0],t]}}]},performEventPressedMove:function(i){var e=i.points,t=i.performPoint;e[0].value=t.value,e[1].value=t.value},performEventMoveForDrawing:function(i){i.currentStep===2&&(i.points[0].value=i.performPoint.value)}},Et=function(){function i(){this._children=[],this._callbacks=new Map}return i.prototype.registerEvent=function(e,t){return this._callbacks.set(e,t),this},i.prototype.onEvent=function(e,t,n){var o=this._callbacks.get(e);return!(o===void 0||!this.checkEventOn(t))&&o(t,n)},i.prototype.checkEventOn=function(e){var t,n;try{for(var o=Xe(this._children),r=o.next();!r.done;r=o.next())if(r.value.checkEventOn(e))return!0}catch(a){t={error:a}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return!1},i.prototype.dispatchEvent=function(e,t,n){var o=this._children.length-1;if(o>-1){for(var r=o;r>-1;r--)if(this._children[r].dispatchEvent(e,t,n))return!0}return this.onEvent(e,t,n)},i.prototype.addChild=function(e){return this._children.push(e),this},i.prototype.clear=function(){this._children=[]},i}(),Qt=function(i){function e(t){var n=i.call(this)||this;return n.attrs=t.attrs,n.styles=t.styles,n}return N(e,i),e.prototype.checkEventOn=function(t){return this.checkEventOnImp(t,this.attrs,this.styles)},e.prototype.draw=function(t){this.drawImp(t,this.attrs,this.styles)},e.extend=function(t){var n=function(o){function r(){return o!==null&&o.apply(this,arguments)||this}return N(r,o),r.prototype.checkEventOnImp=function(a,s,l){return t.checkEventOn(a,s,l)},r.prototype.drawImp=function(a,s,l){t.draw(a,s,l)},r}(e);return n},e}(Et);function eo(i,e){return Math.sqrt(Math.pow(i.x+e.x,2)+Math.pow(i.y+e.y,2))}function yn(i){var e=eo(i[0],i[1]),t=e+eo(i[1],i[2]),n=[i[2].x-i[0].x,i[2].y-i[0].y];return[{x:i[1].x-.5*n[0]*e/t,y:i[1].y-.5*n[1]*e/t},{x:i[1].x+.5*n[0]*e/t,y:i[1].y+.5*n[1]*e/t}]}function to(i,e){var t=e.coordinates;if(t.length>1)for(var n=1;t.length>n;n++){var o=t[n-1],r=t[n];if(o.x===r.x){if(4>Math.abs(o.y-i.y)+Math.abs(r.y-i.y)-Math.abs(o.y-r.y)&&2>Math.abs(i.x-o.x))return!0}else{var a=it(o,r),s=wt(a,i),l=Math.abs(s-i.y);if(4>Math.abs(o.x-i.x)+Math.abs(r.x-i.x)-Math.abs(o.x-r.x)&&4>l*l/(a[0]*a[0]+1))return!0}}return!1}function wt(i,e){return i!=null?e.x*i[0]+i[1]:e.y}function Ke(i,e,t){return wt(it(i,e),t)}function it(i,e){var t=i.x-e.x;if(t!==0){var n=(i.y-e.y)/t;return[n,i.y-n*i.x]}return null}function oo(i,e,t){var n=e.coordinates,o=n.length;if(o>1){var r=t.style,a=r===void 0?g.LineType.Solid:r,s=t.smooth,l=t.size,u=t.color,c=u===void 0?"currentColor":u,h=t.dashedValue,d=h===void 0?[2,2]:h;if(i.lineWidth=l===void 0?1:l,i.strokeStyle=c,i.setLineDash(a===g.LineType.Dashed?d:[]),i.beginPath(),i.moveTo(n[0].x,n[0].y),s!=null&&s){for(var p=[],v=1;o-1>v;v++)p=p.concat(yn([n[v-1],n[v],n[v+1]]));i.quadraticCurveTo(p[0].x,p[0].y,n[1].x,n[1].y);for(var f=2;o-1>f;f++)i.bezierCurveTo(p[2*(f-2)+1].x,p[2*(f-2)+1].y,p[2*(f-1)].x,p[2*(f-1)].y,n[f].x,n[f].y);i.quadraticCurveTo(p[2*(f-2)+1].x,p[2*(f-2)+1].y,n[f].x,n[f].y)}else for(f=1;n.length>f;f++)i.lineTo(n[f].x,n[f].y);i.stroke(),i.closePath()}}var mn={name:"line",checkEventOn:to,draw:function(i,e,t){oo(i,e,t)}};function no(i,e,t){var n=t??0,o=[];if(i.length>1)if(i[0].x===i[1].x){var r=e.height;if(o.push({coordinates:[{x:i[0].x,y:0},{x:i[0].x,y:r}]}),i.length>2){o.push({coordinates:[{x:i[2].x,y:0},{x:i[2].x,y:r}]});for(var a=i[0].x-i[2].x,s=0;n>s;s++){var l=a*(s+1);o.push({coordinates:[{x:i[0].x+l,y:0},{x:i[0].x+l,y:r}]})}}}else{var u=e.width,c=it(i[0],i[1]),h=c[0],d=c[1];if(o.push({coordinates:[{x:0,y:0*h+d},{x:u,y:u*h+d}]}),i.length>2){var p=i[2].y-h*i[2].x;for(o.push({coordinates:[{x:0,y:0*h+p},{x:u,y:u*h+p}]}),a=d-p,s=0;n>s;s++){var v=d+a*(s+1);o.push({coordinates:[{x:0,y:0*h+v},{x:u,y:u*h+v}]})}}}return o}function _n(i,e){if(i.length>1){var t=void 0;return t=i[0].x===i[1].x&&i[0].y!==i[1].y?i[1].y>i[0].y?{x:i[0].x,y:e.height}:{x:i[0].x,y:0}:i[0].x>i[1].x?{x:0,y:Ke(i[0],i[1],{x:0,y:i[0].y})}:{x:e.width,y:Ke(i[0],i[1],{x:e.width,y:i[0].y})},{coordinates:[i[0],t]}}return[]}var xn={name:"simpleAnnotation",totalStep:2,styles:{text:{borderSize:1,borderRadius:2,borderColor:"#1677FF",paddingLeft:4,paddingRight:4,paddingTop:4,paddingBottom:4,backgroundColor:"#1677FF"},line:{style:g.LineType.Dashed}},createPointFigures:function(i){var e,t,n=i.overlay,o=i.coordinates;Y(n.extendData)&&(t=L(n.extendData)?n.extendData(n):(e=n.extendData)!==null&&e!==void 0?e:"");var r=o[0].x,a=o[0].y-6,s=a-50,l=s-5;return[{type:"line",attrs:{coordinates:[{x:r,y:a},{x:r,y:s}]},ignoreEvent:!0},{type:"polygon",attrs:{coordinates:[{x:r,y:s},{x:r-4,y:l},{x:r+4,y:l}]},ignoreEvent:!0},{type:"text",attrs:{x:r,y:l,text:t??"",align:"center",baseline:"bottom"},ignoreEvent:!0}]}},Cn={name:"simpleTag",totalStep:2,styles:{text:{borderSize:1,borderRadius:2,borderColor:"#1677FF",paddingLeft:4,paddingRight:4,paddingTop:4,paddingBottom:4,backgroundColor:"#1677FF"}},createPointFigures:function(i){var e=i.coordinates;return{type:"line",attrs:{coordinates:[{x:0,y:e[0].y},{x:i.bounding.width,y:e[0].y}]},ignoreEvent:!0}},createYAxisFigures:function(i){var e,t,n,o,r,a=i.overlay,s=i.coordinates,l=i.bounding,u=i.yAxis,c=i.precision;return(e=u==null?void 0:u.isFromZero())!==null&&e!==void 0&&e?(n="left",o=0):(n="right",o=l.width),Y(a.extendData)&&(r=L(a.extendData)?a.extendData(a):(t=a.extendData)!==null&&t!==void 0?t:""),Y(r)||a.points[0].value===void 0||(r=G(a.points[0].value,c.price)),{type:"text",attrs:{x:o,y:s[0].y,text:r??"",align:n,baseline:"middle"}}}},Ue={};function Sn(i){var e;return(e=Ue[i])!==null&&e!==void 0?e:null}function io(i){var e={width:0,height:0,left:0,right:0,top:0,bottom:0};return i!==void 0&&I(e,i),e}[vn,fn,{name:"horizontalSegment",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(i){var e=i.coordinates,t=[];return e.length===2&&t.push({coordinates:e}),[{type:"line",attrs:t}]},performEventPressedMove:function(i){var e=i.points,t=i.performPoint;e[0].value=t.value,e[1].value=t.value},performEventMoveForDrawing:function(i){i.currentStep===2&&(i.points[0].value=i.performPoint.value)}},{name:"horizontalStraightLine",totalStep:2,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(i){var e=i.coordinates;return[{type:"line",attrs:{coordinates:[{x:0,y:e[0].y},{x:i.bounding.width,y:e[0].y}]}}]}},{name:"parallelStraightLine",totalStep:4,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(i){return[{type:"line",attrs:no(i.coordinates,i.bounding)}]}},{name:"priceChannelLine",totalStep:4,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(i){return[{type:"line",attrs:no(i.coordinates,i.bounding,1)}]}},{name:"priceLine",totalStep:2,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(i){var e=i.coordinates,t=i.thousandsSeparator,n=i.overlay.points[0].value;return[{type:"line",attrs:{coordinates:[e[0],{x:i.bounding.width,y:e[0].y}]}},{type:"text",ignoreEvent:!0,attrs:{x:e[0].x,y:e[0].y,text:J((n===void 0?0:n).toFixed(i.precision.price),t),baseline:"bottom"}}]}},{name:"rayLine",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(i){return[{type:"line",attrs:_n(i.coordinates,i.bounding)}]}},{name:"segment",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(i){var e=i.coordinates;return e.length===2?[{type:"line",attrs:{coordinates:e}}]:[]}},{name:"straightLine",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(i){var e=i.coordinates,t=i.bounding;return e.length===2?e[0].x===e[1].x?[{type:"line",attrs:{coordinates:[{x:e[0].x,y:0},{x:e[0].x,y:t.height}]}}]:[{type:"line",attrs:{coordinates:[{x:0,y:Ke(e[0],e[1],{x:0,y:e[0].y})},{x:t.width,y:Ke(e[0],e[1],{x:t.width,y:e[0].y})}]}}]:[]}},{name:"verticalRayLine",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(i){var e=i.coordinates;if(e.length===2){var t={x:e[0].x,y:0};return e[1].y>e[0].y&&(t.y=i.bounding.height),[{type:"line",attrs:{coordinates:[e[0],t]}}]}return[]},performEventPressedMove:function(i){var e=i.points,t=i.performPoint;e[0].timestamp=t.timestamp,e[0].dataIndex=t.dataIndex,e[1].timestamp=t.timestamp,e[1].dataIndex=t.dataIndex},performEventMoveForDrawing:function(i){var e=i.points,t=i.performPoint;i.currentStep===2&&(e[0].timestamp=t.timestamp,e[0].dataIndex=t.dataIndex)}},{name:"verticalSegment",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(i){var e=i.coordinates;return e.length===2?[{type:"line",attrs:{coordinates:e}}]:[]},performEventPressedMove:function(i){var e=i.points,t=i.performPoint;e[0].timestamp=t.timestamp,e[0].dataIndex=t.dataIndex,e[1].timestamp=t.timestamp,e[1].dataIndex=t.dataIndex},performEventMoveForDrawing:function(i){var e=i.points,t=i.performPoint;i.currentStep===2&&(e[0].timestamp=t.timestamp,e[0].dataIndex=t.dataIndex)}},{name:"verticalStraightLine",totalStep:2,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(i){var e=i.coordinates;return[{type:"line",attrs:{coordinates:[{x:e[0].x,y:0},{x:e[0].x,y:i.bounding.height}]}}]}},xn,Cn].forEach(function(i){Ue[i.name]=Jt.extend(i)});var te="main",_e="xAxis",xe="yAxis",Ze="separator",ro=function(i){function e(t,n){var o=i.call(this)||this;return o._bounding=io(),o._pane=n,o._init(t),o}return N(e,i),e.prototype._init=function(t){if(this._container=me("div",this.getContainerStyle()),this.insertBefore()){var n=t.lastChild;n!==null?t.insertBefore(this._container,n):t.appendChild(this._container)}else t.appendChild(this._container);this.initDom(this._container)},e.prototype.setBounding=function(t){return I(this._bounding,t),this},e.prototype.getContainer=function(){return this._container},e.prototype.getBounding=function(){return this._bounding},e.prototype.getPane=function(){return this._pane},e.prototype.update=function(t){this.updateImp(this._container,this._bounding,t??3)},e.prototype.insertBefore=function(){return!1},e}(Et),bn=function(i){function e(t,n){var o,r,a,s=i.call(this,t,n)||this;return s._dragFlag=!1,s._dragStartY=0,s._topPaneHeight=0,s._currentPaneHeight=0,s._pressedMouseMoveEvent=(o=s._pressedTouchMouseMoveEvent,r=20,a=0,function(){var l=Date.now();l-a>(r??20)&&(o.apply(this,arguments),a=l)}),s.registerEvent("touchStartEvent",s._mouseDownEvent.bind(s)).registerEvent("touchMoveEvent",s._pressedMouseMoveEvent.bind(s)).registerEvent("touchEndEvent",s._mouseUpEvent.bind(s)).registerEvent("mouseDownEvent",s._mouseDownEvent.bind(s)).registerEvent("mouseUpEvent",s._mouseUpEvent.bind(s)).registerEvent("pressedMouseMoveEvent",s._pressedMouseMoveEvent.bind(s)).registerEvent("mouseEnterEvent",s._mouseEnterEvent.bind(s)).registerEvent("mouseLeaveEvent",s._mouseLeaveEvent.bind(s)),s}return N(e,i),e.prototype.getName=function(){return Ze},e.prototype.checkEventOn=function(){return!0},e.prototype._mouseDownEvent=function(t){var n,o;this._dragFlag=!0,this._dragStartY=t.pageY;var r=this.getPane();return this._topPaneHeight=(o=(n=r.getTopPane())===null||n===void 0?void 0:n.getBounding().height)!==null&&o!==void 0?o:0,this._currentPaneHeight=r.getBounding().height,!0},e.prototype._mouseUpEvent=function(){return this._dragFlag=!1,this._mouseLeaveEvent()},e.prototype._pressedTouchMouseMoveEvent=function(t){var n=t.pageY-this._dragStartY,o=this.getPane(),r=o.getTopPane(),a=0>n;if(r!==null&&o.getOptions().dragEnabled){var s=void 0,l=void 0,u=void 0,c=void 0;a?(s=r,l=o,u=this._topPaneHeight,c=this._currentPaneHeight):(s=o,l=r,u=this._currentPaneHeight,c=this._topPaneHeight);var h=s.getOptions().minHeight;if(u>h){var d=Math.max(u-Math.abs(n),h),p=u-d;s.setBounding({height:d}),l.setBounding({height:c+p});var v=o.getChart();v.getChartStore().getActionStore().execute(g.ActionType.OnPaneDrag,{paneId:o.getId}),v.adjustPaneViewport(!0,!0,!0,!0,!0)}}return!0},e.prototype._mouseEnterEvent=function(){var t=this.getPane();if(t.getOptions().dragEnabled){var n=t.getChart().getStyles().separator;return this._moveDom.style.background=n.activeBackgroundColor,!0}return!1},e.prototype._mouseLeaveEvent=function(){return!this._dragFlag&&(this._moveDom.style.background="",!0)},e.prototype.getContainerStyle=function(){return{margin:"0",padding:"0",position:"relative",boxSizing:"border-box"}},e.prototype.insertBefore=function(){return!0},e.prototype.initDom=function(t){this._moveDom=me("div",{width:"100%",height:"".concat(7,"px"),margin:"0",padding:"0",position:"absolute",top:"-3px",zIndex:"20",boxSizing:"border-box",cursor:"ns-resize"}),t.appendChild(this._moveDom)},e.prototype.updateImp=function(t,n,o){if(o===4||o===2){var r=this.getPane().getChart().getStyles().separator;this._moveDom.style.top="".concat(-Math.floor((7-r.size)/2),"px"),this._moveDom.style.height="".concat(7,"px");var a=r.fill;t.style.backgroundColor=r.color,t.style.height="".concat(r.size,"px"),t.style.marginLeft="".concat(a?0:n.left,"px"),t.style.width=a?"100%":"".concat(n.width,"px")}},e.prototype.getImage=function(){var t=this.getPane().getChart().getStyles().separator,n=this.getContainer().offsetWidth,o=t.size,r=me("canvas",{width:"".concat(n,"px"),height:"".concat(o,"px"),boxSizing:"border-box"}),a=r.getContext("2d"),s=Ie(r);return r.width=n*s,r.height=o*s,a.scale(s,s),a.fillStyle=t.color,a.fillRect(this.getBounding().left,0,n,o),r},e}(ro),oe="candle_pane",En="indicator_pane_",ae="xaxis_pane",ao=function(){function i(e,t,n,o,r){this._yAxisWidget=null,this._separatorWidget=null,this._axis=this.createAxisComponent(),this._bounding=io(),this._options={minHeight:30,dragEnabled:!0,gap:{top:.2,bottom:.1},axisOptions:{scrollZoomEnabled:!0}},this._chart=t,this._id=n,this._topPane=o??null,this._bottomPane=r??null,this._init(e)}return i.prototype._init=function(e){this._container=e,this._seriesContainer=me("div",{width:"100%",margin:"0",padding:"0",position:"relative",overflow:"hidden",boxSizing:"border-box"}),this._separatorWidget=this.createSeparatorWidget(e);var t=e.lastChild;t!==null?e.insertBefore(this._seriesContainer,t):e.appendChild(this._seriesContainer),this._mainWidget=this.createMainWidget(this._seriesContainer),this._yAxisWidget=this.createYAxisWidget(this._seriesContainer)},i.prototype.getContainer=function(){return this._seriesContainer},i.prototype.getId=function(){return this._id},i.prototype.setOptions=function(e){var t,n,o,r,a;return I(this._options,e),this.getId()===ae?(r=this.getMainWidget().getContainer(),a="ew-resize"):(r=(t=this.getYAxisWidget())===null||t===void 0?void 0:t.getContainer(),a="ns-resize"),r.style.cursor=(o=(n=e.axisOptions)===null||n===void 0?void 0:n.scrollZoomEnabled)===null||o===void 0||o?a:"default",this},i.prototype.getOptions=function(){return this._options},i.prototype.getChart=function(){return this._chart},i.prototype.getAxisComponent=function(){return this._axis},i.prototype.setBounding=function(e,t,n){var o,r,a;I(this._bounding,e);var s=0;if(this._separatorWidget!==null){s=this._chart.getStyles().separator.size;var l=k(k({},e),{height:7});e.top!==void 0&&(l.top=e.top-Math.floor((7-s)/2)),this._separatorWidget.setBounding(l)}var u={};return e.height!==void 0&&(u.height=e.height-s),e.top!==void 0&&(u.top=e.top+s),this._mainWidget.setBounding(u),(o=this._yAxisWidget)===null||o===void 0||o.setBounding(u),t!==void 0&&(this._mainWidget.setBounding(t),(r=this._separatorWidget)===null||r===void 0||r.setBounding(t)),n!==void 0&&((a=this._yAxisWidget)===null||a===void 0||a.setBounding(n)),this},i.prototype.getTopPane=function(){return this._topPane},i.prototype.setTopPane=function(e){return this._topPane=e,this},i.prototype.getBottomPane=function(){return this._bottomPane},i.prototype.setBottomPane=function(e){return this._bottomPane=e,this},i.prototype.getBounding=function(){return this._bounding},i.prototype.getMainWidget=function(){return this._mainWidget},i.prototype.getYAxisWidget=function(){return this._yAxisWidget},i.prototype.getSeparatorWidget=function(){return this._separatorWidget},i.prototype.update=function(e){var t,n;this._bounding.width!==this._seriesContainer.offsetWidth&&(this._seriesContainer.style.width="".concat(this._bounding.width,"px"));var o=this._mainWidget.getBounding().height;o!==this._seriesContainer.offsetHeight&&(this._seriesContainer.style.height="".concat(o,"px"));var r=e??3;this._mainWidget.update(r),(t=this._yAxisWidget)===null||t===void 0||t.update(r),(n=this._separatorWidget)===null||n===void 0||n.update(r)},i.prototype.getImage=function(e){var t=this._bounding,n=t.width,o=t.height,r=me("canvas",{width:"".concat(n,"px"),height:"".concat(o,"px"),boxSizing:"border-box"}),a=r.getContext("2d"),s=Ie(r);r.width=n*s,r.height=o*s,a.scale(s,s);var l=0;if(this._separatorWidget!=null){var u=this.getChart().getStyles().separator.size;l=u,a.drawImage(this._separatorWidget.getImage(),0,0,n,u)}var c=this._mainWidget.getBounding();if(a.drawImage(this._mainWidget.getImage(e),c.left,l,c.width,c.height),this._yAxisWidget!==null){var h=this._yAxisWidget.getBounding();a.drawImage(this._yAxisWidget.getImage(e),h.left,l,h.width,h.height)}return r},i.prototype.destroy=function(){this._container.removeChild(this._seriesContainer),this._separatorWidget!==null&&this._container.removeChild(this._separatorWidget.getContainer())},i.prototype.createSeparatorWidget=function(e){return null},i.prototype.createYAxisWidget=function(e){return null},i}(),wn=function(){function i(e){this._instances=new Map,this._counter=new Map,this._progressInstanceInfo=null,this._pressedInstanceInfo={paneId:"",instance:null,figureType:0,figureKey:"",figureIndex:-1,attrsIndex:-1},this._hoverInstanceInfo={paneId:"",instance:null,figureType:0,figureKey:"",figureIndex:-1,attrsIndex:-1},this._clickInstanceInfo={paneId:"",instance:null,figureType:0,figureKey:"",figureIndex:-1,attrsIndex:-1},this._chartStore=e}return i.prototype._overrideInstance=function(e,t){var n=t.id,o=t.groupId,r=t.points,a=t.styles,s=t.lock,l=t.visible,u=t.zLevel,c=t.mode,h=t.modeSensitivity,d=t.extendData,p=t.onDrawStart,v=t.onDrawing,f=t.onDrawEnd,y=t.onClick,m=t.onDoubleClick,_=t.onRightClick,x=t.onPressedMoveStart,C=t.onPressedMoving,S=t.onPressedMoveEnd,E=t.onMouseEnter,b=t.onMouseLeave,T=t.onRemoved,D=t.onSelected,A=t.onDeselected,F=!1,B=!1;return n!==void 0&&e.setId(n),o!==void 0&&e.setGroupId(o),r!==void 0&&e.setPoints(r)&&(F=!0),a!==void 0&&e.setStyles(a)&&(F=!0),s!==void 0&&e.setLock(s),l!==void 0&&e.setVisible(l)&&(F=!0),u!==void 0&&e.setZLevel(u)&&(F=!0,B=!0),c!==void 0&&e.setMode(c),h!==void 0&&e.setModeSensitivity(h),d!==void 0&&e.setExtendData(d)&&(F=!0),p!==void 0&&e.setOnDrawStartCallback(p),v!==void 0&&e.setOnDrawingCallback(v),f!==void 0&&e.setOnDrawEndCallback(f),y!==void 0&&e.setOnClickCallback(y),m!==void 0&&e.setOnDoubleClickCallback(m),_!==void 0&&e.setOnRightClickCallback(_),x!==void 0&&e.setOnPressedMoveStartCallback(x),C!==void 0&&e.setOnPressedMovingCallback(C),S!==void 0&&e.setOnPressedMoveEndCallback(S),E!==void 0&&e.setOnMouseEnterCallback(E),b!==void 0&&e.setOnMouseLeaveCallback(b),T!==void 0&&e.setOnRemovedCallback(T),D!==void 0&&e.setOnSelectedCallback(D),A!==void 0&&e.setOnDeselectedCallback(A),[F,B]},i.prototype.getInstanceById=function(e){var t,n;try{for(var o=Xe(this._instances),r=o.next();!r.done;r=o.next()){var a=r.value[1].find(function(s){return s.id===e});if(a!==void 0)return a}}catch(s){t={error:s}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return this._progressInstanceInfo!==null&&this._progressInstanceInfo.instance.id===e?this._progressInstanceInfo.instance:null},i.prototype._sort=function(e){var t;e!==void 0?(t=this._instances.get(e))===null||t===void 0||t.sort(function(n,o){return n.defaultZLevel-o.defaultZLevel}).sort(function(n,o){return n.zLevel-o.zLevel}):this._instances.forEach(function(n){n.sort(function(o,r){return o.defaultZLevel-r.defaultZLevel}).sort(function(o,r){return o.zLevel-r.zLevel})})},i.prototype.addInstances=function(e,t,n){var o=this,r=e.map(function(a){var s,l,u,c,h,d=(s=a.id)!==null&&s!==void 0?s:Kt("overlay_");if(o.getInstanceById(d)===null){var p=Sn(a.name);if(p!==null){var v=new p,f=((l=o._counter.get(t))!==null&&l!==void 0?l:0)+1;o._counter.set(t,f),v.setDefaultZLevel(f),v.setPaneId(t);var y=(u=a.groupId)!==null&&u!==void 0?u:d;return a.id=d,a.groupId=y,o._overrideInstance(v,a),v.isDrawing()?o._progressInstanceInfo={paneId:t,instance:v,appointPaneFlag:n}:(o._instances.has(t)||o._instances.set(t,[]),(c=o._instances.get(t))===null||c===void 0||c.push(v)),v.isStart()&&((h=v.onDrawStart)===null||h===void 0||h.call(v,{overlay:v})),d}}return null});return r.some(function(a){return a!==null})&&(this._sort(),this._chartStore.getChart().updatePane(1,t)),r},i.prototype.getProgressInstanceInfo=function(){return this._progressInstanceInfo},i.prototype.progressInstanceComplete=function(){var e;if(this._progressInstanceInfo!==null){var t=this._progressInstanceInfo,n=t.instance,o=t.paneId;n.isDrawing()||(this._instances.has(o)||this._instances.set(o,[]),(e=this._instances.get(o))===null||e===void 0||e.push(n),this._sort(o),this._progressInstanceInfo=null)}},i.prototype.updateProgressInstanceInfo=function(e,t){this._progressInstanceInfo!==null&&(t!==void 0&&t&&(this._progressInstanceInfo.appointPaneFlag=t),this._progressInstanceInfo.paneId=e,this._progressInstanceInfo.instance.setPaneId(e))},i.prototype.getInstances=function(e){var t;if(e===void 0){var n=[];return this._instances.forEach(function(o){n=n.concat(o)}),n}return(t=this._instances.get(e))!==null&&t!==void 0?t:[]},i.prototype.override=function(e){var t=this,n=e.id,o=e.groupId,r=e.name,a=!1,s=!1,l=function(h){var d=t._overrideInstance(h,e);d[0]&&(a=!0),d[1]&&(s=!0)};if(n!==void 0){var u=this.getInstanceById(n);u!==null&&l(u)}else if(this._instances.forEach(function(h){h.forEach(function(d){(r!==void 0&&d.name===r||o!==void 0&&d.groupId===o||r===void 0&&o===void 0)&&l(d)})}),this._progressInstanceInfo!==null){var c=this._progressInstanceInfo.instance;(r!==void 0&&c.name===r||o!==void 0&&c.groupId===o||r===void 0&&o===void 0)&&l(c)}s&&this._sort(),a&&this._chartStore.getChart().updatePane(1)},i.prototype.removeInstance=function(e){var t,n,o,r=function(p,v){if(p.id!==void 0){if(v.id!==p.id)return!1}else if(p.groupId!==void 0){if(v.groupId!==p.groupId)return!1}else if(p.name!==void 0&&v.name!==p.name)return!1;return!0},a=[];if(this._progressInstanceInfo!==null){var s=this._progressInstanceInfo.instance;(e===void 0||e!==void 0&&r(e,s))&&(a.push(this._progressInstanceInfo.paneId),(o=s.onRemoved)===null||o===void 0||o.call(s,{overlay:s}),this._progressInstanceInfo=null)}if(e!==void 0){var l=new Map,u=function(p){var v=p[1].filter(function(f){var y;return!r(e,f)||(a.includes(p[0])||a.push(p[0]),(y=f.onRemoved)===null||y===void 0||y.call(f,{overlay:f}),!1)});v.length>0&&l.set(p[0],v)};try{for(var c=Xe(this._instances),h=c.next();!h.done;h=c.next())u(h.value)}catch(p){t={error:p}}finally{try{h&&!h.done&&(n=c.return)&&n.call(c)}finally{if(t)throw t.error}}this._instances=l}else this._instances.forEach(function(p,v){a.push(v),p.forEach(function(f){var y;(y=f.onRemoved)===null||y===void 0||y.call(f,{overlay:f})})}),this._instances.clear();if(a.length>0){var d=this._chartStore.getChart();a.forEach(function(p){d.updatePane(1,p)}),d.updatePane(1,ae)}},i.prototype.setPressedInstanceInfo=function(e){this._pressedInstanceInfo=e},i.prototype.getPressedInstanceInfo=function(){return this._pressedInstanceInfo},i.prototype.setHoverInstanceInfo=function(e,t){var n,o,r=this._hoverInstanceInfo,a=r.instance,s=r.figureKey,l=r.figureIndex;if(((a==null?void 0:a.id)!==((n=e.instance)===null||n===void 0?void 0:n.id)||r.figureType!==e.figureType||l!==e.figureIndex)&&(this._hoverInstanceInfo=e,(a==null?void 0:a.id)!==((o=e.instance)===null||o===void 0?void 0:o.id))){var u=!1,c=!1;a!==null&&(c=!0,a.resetZLevel(),L(a.onMouseLeave)&&(a.onMouseLeave(k({overlay:a,figureKey:s,figureIndex:l},t)),u=!0)),e.instance!==null&&(c=!0,e.instance.setZLevel(gn),L(e.instance.onMouseEnter)&&(e.instance.onMouseEnter(k({overlay:e.instance,figureKey:e.figureKey,figureIndex:e.figureIndex},t)),u=!0)),c&&this._sort(),u||this._chartStore.getChart().updatePane(1)}},i.prototype.getHoverInstanceInfo=function(){return this._hoverInstanceInfo},i.prototype.setClickInstanceInfo=function(e,t){var n,o,r,a,s,l,u,c,h,d=this._clickInstanceInfo,p=d.paneId,v=d.instance,f=d.figureType,y=d.figureKey,m=d.figureIndex;if((o=(n=e.instance)===null||n===void 0?void 0:n.isDrawing())!==null&&o!==void 0&&o||(a=(r=e.instance)===null||r===void 0?void 0:r.onClick)===null||a===void 0||a.call(r,k({overlay:e.instance,figureKey:e.figureKey,figureIndex:e.figureIndex},t)),((v==null?void 0:v.id)!==((s=e.instance)===null||s===void 0?void 0:s.id)||f!==e.figureType||m!==e.figureIndex)&&(this._clickInstanceInfo=e,(v==null?void 0:v.id)!==((l=e.instance)===null||l===void 0?void 0:l.id))){(u=v==null?void 0:v.onDeselected)===null||u===void 0||u.call(v,k({overlay:v,figureKey:y,figureIndex:m},t)),(h=(c=e.instance)===null||c===void 0?void 0:c.onSelected)===null||h===void 0||h.call(c,k({overlay:e.instance,figureKey:e.figureKey,figureIndex:e.figureIndex},t));var _=this._chartStore.getChart();_.updatePane(1,e.paneId),p!==e.paneId&&_.updatePane(1,p),_.updatePane(1,ae)}},i.prototype.getClickInstanceInfo=function(){return this._clickInstanceInfo},i.prototype.isEmpty=function(){return this._instances.size===0&&this._progressInstanceInfo===null},i.prototype.isDrawing=function(){var e,t;return this._progressInstanceInfo!==null&&(t=(e=this._progressInstanceInfo)===null||e===void 0?void 0:e.instance.isDrawing())!==null&&t!==void 0&&t},i}(),Tn=function(){function i(){this._actions=new Map}return i.prototype.execute=function(e,t){var n;(n=this._actions.get(e))===null||n===void 0||n.execute(t)},i.prototype.subscribe=function(e,t){var n;this._actions.has(e)||this._actions.set(e,new en),(n=this._actions.get(e))===null||n===void 0||n.subscribe(t)},i.prototype.unsubscribe=function(e,t){var n=this._actions.get(e);n!==void 0&&(n.unsubscribe(t),n.isEmpty()&&this._actions.delete(e))},i.prototype.has=function(e){var t=this._actions.get(e);return t!==void 0&&!t.isEmpty()},i}(),so={light:{grid:{horizontal:{color:"#EDEDED"},vertical:{color:"#EDEDED"}},candle:{priceMark:{high:{color:"#76808F"},low:{color:"#76808F"}},tooltip:{rect:{color:"#FEFEFE",borderColor:"#F2F3F5"},text:{color:"#76808F"}}},indicator:{tooltip:{text:{color:"#76808F"}}},xAxis:{axisLine:{color:"#DDDDDD"},tickText:{color:"#76808F"},tickLine:{color:"#DDDDDD"}},yAxis:{axisLine:{color:"#DDDDDD"},tickText:{color:"#76808F"},tickLine:{color:"#DDDDDD"}},separator:{color:"#DDDDDD"},crosshair:{horizontal:{line:{color:"#76808F"},text:{borderColor:"#686D76",backgroundColor:"#686D76"}},vertical:{line:{color:"#76808F"},text:{borderColor:"#686D76",backgroundColor:"#686D76"}}}},dark:{grid:{horizontal:{color:"#292929"},vertical:{color:"#292929"}},candle:{priceMark:{high:{color:"#929AA5"},low:{color:"#929AA5"}},tooltip:{rect:{color:"rgba(10, 10, 10, .6)",borderColor:"rgba(10, 10, 10, .6)"},text:{color:"#929AA5"}}},indicator:{tooltip:{text:{color:"#929AA5"}}},xAxis:{axisLine:{color:"#333333"},tickText:{color:"#929AA5"},tickLine:{color:"#333333"}},yAxis:{axisLine:{color:"#333333"},tickText:{color:"#929AA5"},tickLine:{color:"#333333"}},separator:{color:"#333333"},crosshair:{horizontal:{line:{color:"#929AA5"},text:{borderColor:"#373a40",backgroundColor:"#373a40"}},vertical:{line:{color:"#929AA5"},text:{borderColor:"#373a40",backgroundColor:"#373a40"}}}}};function lo(i){var e;return(e=so[i])!==null&&e!==void 0?e:null}var Dn=function(){function i(e,t){this._styles={grid:{show:!0,horizontal:{show:!0,size:1,color:"#EDEDED",style:g.LineType.Dashed,dashedValue:[2,2]},vertical:{show:!0,size:1,color:"#EDEDED",style:g.LineType.Dashed,dashedValue:[2,2]}},candle:{type:g.CandleType.CandleSolid,bar:{upColor:"#2DC08E",downColor:"#F92855",noChangeColor:"#888888",upBorderColor:"#2DC08E",downBorderColor:"#F92855",noChangeBorderColor:"#888888",upWickColor:"#2DC08E",downWickColor:"#F92855",noChangeWickColor:"#888888"},area:{lineSize:2,lineColor:"#1677FF",value:"close",backgroundColor:[{offset:0,color:"rgba(22, 119, 255, 0.01)"},{offset:1,color:"rgba(22, 119, 255, 0.2)"}]},priceMark:{show:!0,high:{show:!0,color:"#76808F",textOffset:5,textSize:10,textFamily:"Helvetica Neue",textWeight:"normal"},low:{show:!0,color:"#76808F",textOffset:5,textSize:10,textFamily:"Helvetica Neue",textWeight:"normal"},last:{show:!0,upColor:"#2DC08E",downColor:"#F92855",noChangeColor:"#888888",line:{show:!0,style:g.LineType.Dashed,dashedValue:[4,4],size:1},text:{show:!0,style:g.PolygonType.Fill,size:12,paddingLeft:4,paddingTop:4,paddingRight:4,paddingBottom:4,borderColor:"transparent",borderStyle:g.LineType.Solid,borderSize:0,borderDashedValue:[2,2],color:"#FFFFFF",family:"Helvetica Neue",weight:"normal",borderRadius:2}}},tooltip:{showRule:g.TooltipShowRule.Always,showType:g.TooltipShowType.Standard,custom:null,defaultValue:"n/a",rect:{position:Qe.Fixed,paddingLeft:0,paddingRight:0,paddingTop:0,paddingBottom:8,offsetLeft:10,offsetTop:8,offsetRight:10,offsetBottom:8,borderRadius:4,borderSize:1,borderColor:"#F2F3F5",color:"#FEFEFE"},text:{size:12,family:"Helvetica Neue",weight:"normal",color:"#76808F",marginLeft:10,marginTop:8,marginRight:6,marginBottom:0},icons:[]}},indicator:{ohlc:{upColor:"rgba(45, 192, 142, .7)",downColor:"rgba(249, 40, 85, .7)",noChangeColor:"#888888"},bars:[{style:g.PolygonType.Fill,borderStyle:g.LineType.Solid,borderSize:1,borderDashedValue:[2,2],upColor:"rgba(45, 192, 142, .7)",downColor:"rgba(249, 40, 85, .7)",noChangeColor:"#888888"}],lines:[{style:g.LineType.Solid,smooth:!1,size:1,dashedValue:[2,2],color:"#FF9600"},{style:g.LineType.Solid,smooth:!1,size:1,dashedValue:[2,2],color:"#935EBD"},{style:g.LineType.Solid,smooth:!1,size:1,dashedValue:[2,2],color:"#1677FF"},{style:g.LineType.Solid,smooth:!1,size:1,dashedValue:[2,2],color:"#E11D74"},{style:g.LineType.Solid,smooth:!1,size:1,dashedValue:[2,2],color:"#01C5C4"}],circles:[{style:g.PolygonType.Fill,borderStyle:g.LineType.Solid,borderSize:1,borderDashedValue:[2,2],upColor:"rgba(45, 192, 142, .7)",downColor:"rgba(249, 40, 85, .7)",noChangeColor:"#888888"}],lastValueMark:{show:!1,text:{show:!1,style:g.PolygonType.Fill,color:"#FFFFFF",size:12,family:"Helvetica Neue",weight:"normal",borderStyle:g.LineType.Solid,borderColor:"transparent",borderSize:1,borderDashedValue:[2,2],paddingLeft:4,paddingTop:4,paddingRight:4,paddingBottom:4,borderRadius:2}},tooltip:{showRule:g.TooltipShowRule.Always,showType:g.TooltipShowType.Standard,showName:!0,showParams:!0,defaultValue:"n/a",text:{size:12,family:"Helvetica Neue",weight:"normal",color:"#76808F",marginLeft:10,marginTop:8,marginRight:6,marginBottom:0},icons:[]}},xAxis:{show:!0,size:"auto",axisLine:{show:!0,color:"#DDDDDD",size:1},tickText:{show:!0,color:"#76808F",size:12,family:"Helvetica Neue",weight:"normal",marginStart:4,marginEnd:4},tickLine:{show:!0,size:1,length:3,color:"#DDDDDD"}},yAxis:{show:!0,size:"auto",type:g.YAxisType.Normal,position:g.YAxisPosition.Right,inside:!1,reverse:!1,axisLine:{show:!0,color:"#DDDDDD",size:1},tickText:{show:!0,color:"#76808F",size:12,family:"Helvetica Neue",weight:"normal",marginStart:4,marginEnd:4},tickLine:{show:!0,size:1,length:3,color:"#DDDDDD"}},separator:{size:1,color:"#DDDDDD",fill:!0,activeBackgroundColor:"rgba(33, 150, 243, 0.08)"},crosshair:{show:!0,horizontal:{show:!0,line:{show:!0,style:g.LineType.Dashed,dashedValue:[4,2],size:1,color:"#76808F"},text:{show:!0,style:g.PolygonType.Fill,color:"#FFFFFF",size:12,family:"Helvetica Neue",weight:"normal",borderStyle:g.LineType.Solid,borderDashedValue:[2,2],borderSize:1,borderColor:"#686D76",borderRadius:2,paddingLeft:4,paddingRight:4,paddingTop:4,paddingBottom:4,backgroundColor:"#686D76"}},vertical:{show:!0,line:{show:!0,style:g.LineType.Dashed,dashedValue:[4,2],size:1,color:"#76808F"},text:{show:!0,style:g.PolygonType.Fill,color:"#FFFFFF",size:12,family:"Helvetica Neue",weight:"normal",borderStyle:g.LineType.Solid,borderDashedValue:[2,2],borderSize:1,borderRadius:2,borderColor:"#686D76",paddingLeft:4,paddingRight:4,paddingTop:4,paddingBottom:4,backgroundColor:"#686D76"}}},overlay:{point:{color:"#1677FF",borderColor:"rgba(22, 119, 255, 0.35)",borderSize:1,radius:5,activeColor:"#1677FF",activeBorderColor:"rgba(22, 119, 255, 0.35)",activeBorderSize:3,activeRadius:5},line:{style:g.LineType.Solid,smooth:!1,color:"#1677FF",size:1,dashedValue:[2,2]},rect:{style:g.PolygonType.Fill,color:"rgba(22, 119, 255, 0.25)",borderColor:"#1677FF",borderSize:1,borderRadius:0,borderStyle:g.LineType.Solid,borderDashedValue:[2,2]},polygon:{style:g.PolygonType.Fill,color:"#1677FF",borderColor:"#1677FF",borderSize:1,borderStyle:g.LineType.Solid,borderDashedValue:[2,2]},circle:{style:g.PolygonType.Fill,color:"rgba(22, 119, 255, 0.25)",borderColor:"#1677FF",borderSize:1,borderStyle:g.LineType.Solid,borderDashedValue:[2,2]},arc:{style:g.LineType.Solid,color:"#1677FF",size:1,dashedValue:[2,2]},text:{style:g.PolygonType.Fill,color:"#FFFFFF",size:12,family:"Helvetica Neue",weight:"normal",borderStyle:g.LineType.Solid,borderDashedValue:[2,2],borderSize:0,borderRadius:2,borderColor:"#1677FF",paddingLeft:0,paddingRight:0,paddingTop:0,paddingBottom:0,backgroundColor:"transparent"},rectText:{style:g.PolygonType.Fill,color:"#FFFFFF",size:12,family:"Helvetica Neue",weight:"normal",borderStyle:g.LineType.Solid,borderDashedValue:[2,2],borderSize:1,borderRadius:2,borderColor:"#1677FF",paddingLeft:4,paddingRight:4,paddingTop:4,paddingBottom:4,backgroundColor:"#1677FF"}}},this._customApi={formatDate:Ht,formatBigNumber:Xt},this._locale="en-US",this._precision={price:2,volume:0},this._thousandsSeparator=",",this._dataList=[],this._timeScaleStore=new nn(this),this._indicatorStore=new dn(this),this._overlayStore=new wn(this),this._tooltipStore=new pn(this),this._actionStore=new Tn,this._visibleDataList=[],this._chart=e,this.setOptions(t)}return i.prototype.adjustVisibleDataList=function(){this._visibleDataList=[];for(var e=this._timeScaleStore.getVisibleRange(),t=e.to,n=e.from;t>n;n++){var o=this._dataList[n],r=this._timeScaleStore.dataIndexToCoordinate(n);this._visibleDataList.push({dataIndex:n,x:r,data:o})}},i.prototype.setOptions=function(e){if(e!==void 0){var t=e.locale,n=e.timezone,o=e.styles,r=e.customApi;t!==void 0&&(this._locale=t),n!==void 0&&this._timeScaleStore.setTimezone(n),o!==void 0&&(ce(o)?I(this._styles,lo(o)):I(this._styles,o)),r!==void 0&&I(this._customApi,r),e.thousandsSeparator!==void 0&&(this._thousandsSeparator=e.thousandsSeparator)}return this},i.prototype.getStyles=function(){return this._styles},i.prototype.getLocale=function(){return this._locale},i.prototype.getCustomApi=function(){return this._customApi},i.prototype.getThousandsSeparator=function(){return this._thousandsSeparator},i.prototype.getPrecision=function(){return this._precision},i.prototype.setPrecision=function(e){return this._precision=e,this._indicatorStore.setSeriesPrecision(e),this},i.prototype.getDataList=function(){return this._dataList},i.prototype.getVisibleDataList=function(){return this._visibleDataList},i.prototype.addData=function(e,t,n){if(M(e)){this._timeScaleStore.setLoading(!1),this._timeScaleStore.setMore(n==null||n);var o=this._dataList.length===0;this._dataList=e.concat(this._dataList),o&&this._timeScaleStore.resetOffsetRightDistance(),this._timeScaleStore.adjustVisibleRange()}else if(t<this._dataList.length)this._dataList[t]=e,this.adjustVisibleDataList();else{this._dataList.push(e);var r=this._timeScaleStore.getOffsetRightBarCount();0>r&&this._timeScaleStore.setOffsetRightBarCount(--r),this._timeScaleStore.adjustVisibleRange()}this._tooltipStore.recalculateCrosshair(!0)},i.prototype.clear=function(){this._dataList=[],this._visibleDataList=[],this._timeScaleStore.clear(),this._tooltipStore.clear()},i.prototype.getTimeScaleStore=function(){return this._timeScaleStore},i.prototype.getIndicatorStore=function(){return this._indicatorStore},i.prototype.getOverlayStore=function(){return this._overlayStore},i.prototype.getTooltipStore=function(){return this._tooltipStore},i.prototype.getActionStore=function(){return this._actionStore},i.prototype.getChart=function(){return this._chart},i}();function Tt(i){return window.requestAnimationFrame==null?window.setTimeout(i,20):window.requestAnimationFrame(i)}function rt(i){window.cancelAnimationFrame==null&&window.clearTimeout(i),window.cancelAnimationFrame(i)}var Ne=-1,Dt=function(i){function e(){var t=i!==null&&i.apply(this,arguments)||this;return t._mainRequestAnimationId=Ne,t._overlayRequestAnimationId=Ne,t}return N(e,i),e.prototype.getContainerStyle=function(){return{margin:"0",padding:"0",position:"absolute",top:"0",overflow:"hidden",boxSizing:"border-box"}},e.prototype.initDom=function(t){this._mainCanvas=me("canvas",{position:"absolute",top:"0",left:"0",zIndex:"2",boxSizing:"border-box"}),this._mainCtx=this._mainCanvas.getContext("2d"),this._overlayCanvas=me("canvas",{position:"absolute",top:"0",left:"0",zIndex:"2",boxSizing:"border-box"}),this._overlayCtx=this._overlayCanvas.getContext("2d"),t.appendChild(this._mainCanvas),t.appendChild(this._overlayCanvas)},e.prototype._optimalUpdateMain=function(t,n){var o=this;this._mainRequestAnimationId!==Ne&&(rt(this._mainRequestAnimationId),this._mainRequestAnimationId=Ne),this._mainRequestAnimationId=Tt(function(){if(t!==o._mainCanvas.offsetWidth||n!==o._mainCanvas.offsetHeight){o._mainCtx.clearRect(0,0,o._mainCanvas.offsetWidth,o._mainCanvas.offsetHeight);var r=Ie(o._mainCanvas),a=Math.floor(t*r),s=Math.floor(n*r);o._mainCanvas.style.width="".concat(t,"px"),o._mainCanvas.style.height="".concat(n,"px"),o._mainCanvas.width=a,o._mainCanvas.height=s,o._mainCtx.scale(r,r)}else o._mainCtx.clearRect(0,0,o._mainCanvas.offsetWidth,o._mainCanvas.offsetHeight);o.updateMain(o._mainCtx)})},e.prototype._optimalUpdateOverlay=function(t,n){var o=this;this._overlayRequestAnimationId!==Ne&&(rt(this._overlayRequestAnimationId),this._overlayRequestAnimationId=Ne),this._overlayRequestAnimationId=Tt(function(){if(t!==o._overlayCanvas.offsetWidth||n!==o._overlayCanvas.offsetHeight){o._overlayCtx.clearRect(0,0,o._overlayCanvas.offsetWidth,o._overlayCanvas.offsetHeight);var r=Ie(o._overlayCanvas),a=Math.floor(t*r),s=Math.floor(n*r);o._overlayCanvas.style.width="".concat(t,"px"),o._overlayCanvas.style.height="".concat(n,"px"),o._overlayCanvas.width=a,o._overlayCanvas.height=s,o._overlayCtx.scale(r,r)}else o._overlayCtx.clearRect(0,0,o._overlayCanvas.offsetWidth,o._overlayCanvas.offsetHeight);o.updateOverlay(o._overlayCtx)})},e.prototype.updateImp=function(t,n,o){var r=n.width,a=n.height;t.style.left="".concat(n.left,"px");var s=o;switch(r===t.offsetWidth&&a===t.offsetHeight||(t.style.width="".concat(r,"px"),t.style.height="".concat(a,"px"),s=3),s){case 0:this._optimalUpdateMain(r,a);break;case 1:this._optimalUpdateOverlay(r,a);break;case 3:case 4:this._optimalUpdateMain(r,a),this._optimalUpdateOverlay(r,a)}},e.prototype.getImage=function(t){var n=this.getBounding(),o=n.width,r=n.height,a=me("canvas",{width:"".concat(o,"px"),height:"".concat(r,"px"),boxSizing:"border-box"}),s=a.getContext("2d"),l=Ie(a);return a.width=o*l,a.height=r*l,s.scale(l,l),s.drawImage(this._mainCanvas,0,0,o,r),t&&s.drawImage(this._overlayCanvas,0,0,o,r),a},e}(ro);function uo(i,e){var t=i.x-e.x,n=i.y-e.y,o=e.r;return!(t*t+n*n>o*o)}function co(i,e,t){var n=e.x,o=e.y,r=e.r,a=t.style,s=a===void 0?g.PolygonType.Fill:a,l=t.color,u=t.borderSize,c=u===void 0?1:u,h=t.borderColor,d=h===void 0?"currentColor":h,p=t.borderStyle,v=p===void 0?g.LineType.Solid:p,f=t.borderDashedValue,y=f===void 0?[2,2]:f;s!==g.PolygonType.Fill&&t.style!==g.PolygonType.StrokeFill||(i.fillStyle=l===void 0?"currentColor":l,i.beginPath(),i.arc(n,o,r,0,2*Math.PI),i.closePath(),i.fill()),s!==g.PolygonType.Stroke&&t.style!==g.PolygonType.StrokeFill||(i.strokeStyle=d,i.lineWidth=c,i.setLineDash(v===g.LineType.Dashed?y:[]),i.beginPath(),i.arc(n,o,r,0,2*Math.PI),i.closePath(),i.stroke())}var Fn={name:"circle",checkEventOn:uo,draw:function(i,e,t){co(i,e,t)}};function ho(i,e){for(var t=!1,n=e.coordinates,o=0,r=n.length-1;n.length>o;r=o++)n[o].y>i.y!=n[r].y>i.y&&(n[r].x-n[o].x)*(i.y-n[o].y)/(n[r].y-n[o].y)+n[o].x>i.x&&(t=!t);return t}function po(i,e,t){var n=e.coordinates,o=t.style,r=o===void 0?g.PolygonType.Fill:o,a=t.color,s=t.borderSize,l=s===void 0?1:s,u=t.borderColor,c=u===void 0?"currentColor":u,h=t.borderStyle,d=h===void 0?g.LineType.Solid:h,p=t.borderDashedValue,v=p===void 0?[2,2]:p;if(r===g.PolygonType.Fill||t.style===g.PolygonType.StrokeFill){i.fillStyle=a===void 0?"currentColor":a,i.beginPath(),i.moveTo(n[0].x,n[0].y);for(var f=1;n.length>f;f++)i.lineTo(n[f].x,n[f].y);i.closePath(),i.fill()}if(r===g.PolygonType.Stroke||t.style===g.PolygonType.StrokeFill){for(i.strokeStyle=c,i.lineWidth=l,i.setLineDash(d===g.LineType.Dashed?v:[]),i.beginPath(),i.moveTo(n[0].x,n[0].y),f=1;n.length>f;f++)i.lineTo(n[f].x,n[f].y);i.closePath(),i.stroke()}}var An={name:"polygon",checkEventOn:ho,draw:function(i,e,t){po(i,e,t)}};function go(i){return i==="transparent"}function vo(i,e){var t=e.x,n=e.width;4>n&&(t-=2,n=4);var o=e.y,r=e.height;return 4>r&&(o-=2,r=4),!(t>i.x||i.x>t+n||o>i.y||i.y>o+r)}function Ft(i,e,t){var n=e.x,o=e.y,r=e.width,a=e.height,s=t.style,l=s===void 0?g.PolygonType.Fill:s,u=t.color,c=u===void 0?"transparent":u,h=t.borderSize,d=h===void 0?1:h,p=t.borderColor,v=p===void 0?"transparent":p,f=t.borderStyle,y=f===void 0?g.LineType.Solid:f,m=t.borderRadius,_=m===void 0?0:m,x=t.borderDashedValue,C=x===void 0?[2,2]:x;if(l===g.PolygonType.Fill||t.style===g.PolygonType.StrokeFill){var S=!0;ce(c)&&(S=!go(c)),S&&(i.fillStyle=c,i.beginPath(),i.moveTo(n+_,o),i.arcTo(n+r,o,n+r,o+a,_),i.arcTo(n+r,o+a,n,o+a,_),i.arcTo(n,o+a,n,o,_),i.arcTo(n,o,n+r,o,_),i.closePath(),i.fill())}l!==g.PolygonType.Stroke&&t.style!==g.PolygonType.StrokeFill||go(v)||0>d||(i.strokeStyle=v,i.lineWidth=d,i.setLineDash(y===g.LineType.Dashed?C:[]),i.beginPath(),i.moveTo(n+_,o),i.arcTo(n+r,o,n+r,o+a,_),i.arcTo(n+r,o+a,n,o+a,_),i.arcTo(n,o+a,n,o,_),i.arcTo(n,o,n+r,o,_),i.closePath(),i.stroke())}var In={name:"rect",checkEventOn:vo,draw:function(i,e,t){Ft(i,e,t)}};function fo(i,e){var t,n,o=e.size,r=o===void 0?12:o,a=e.paddingLeft,s=e.paddingTop,l=s===void 0?0:s,u=e.paddingRight,c=u===void 0?0:u,h=e.paddingBottom,d=h===void 0?0:h,p=e.weight,v=i.x,f=i.y,y=i.align,m=y===void 0?"left":y,_=i.baseline,x=_===void 0?"top":_,C=i.width,S=i.height,E=C??(a===void 0?0:a)+qe(i.text,r,p===void 0?"normal":p,e.family)+c,b=S??l+r+d;switch(m){case"left":case"start":t=v;break;case"right":case"end":t=v-E;break;default:t=v-E/2}switch(x){case"top":case"hanging":n=f;break;case"bottom":case"ideographic":case"alphabetic":n=f-b;break;default:n=f-b/2}return{x:t,y:n,width:E,height:b}}function yo(i,e,t){var n=fo(e,t),o=n.x,r=n.y;return!(o>i.x||i.x>o+n.width||r>i.y||i.y>r+n.height)}function At(i,e,t){var n=e.text,o=t.color,r=o===void 0?"currentColor":o,a=t.size,s=a===void 0?12:a,l=t.family,u=t.weight,c=t.paddingLeft,h=c===void 0?0:c,d=t.paddingTop,p=d===void 0?0:d,v=t.paddingRight,f=v===void 0?0:v,y=fo(e,t);Ft(i,y,k(k({},t),{color:t.backgroundColor})),i.textAlign="left",i.textBaseline="top",i.font=ke(s,u,l),i.fillStyle=r,i.fillText(n,y.x+h,y.y+p,y.width-h-f)}var mo={name:"text",checkEventOn:function(i,e,t){return yo(i,e,t)},draw:function(i,e,t){At(i,e,t)}},kn=At;function _o(i,e){if(2>Math.abs(Math.sqrt((h=(u=i).x-(c=e).x)*h+(d=u.y-c.y)*d)-e.r)){var t=e.r,n=e.startAngle,o=e.endAngle,r=t*Math.cos(n)+e.x,a=t*Math.sin(n)+e.y,s=t*Math.cos(o)+e.x,l=t*Math.sin(o)+e.y;return!(i.x>Math.max(r,s)+2||Math.min(r,s)-2>i.x||i.y>Math.max(a,l)+2||Math.min(a,l)-2>i.y)}var u,c,h,d;return!1}function xo(i,e,t){var n=e.x,o=e.y,r=e.r,a=e.startAngle,s=e.endAngle,l=t.style,u=l===void 0?g.LineType.Solid:l,c=t.size,h=t.color,d=h===void 0?"currentColor":h,p=t.dashedValue,v=p===void 0?[2,2]:p;i.lineWidth=c===void 0?1:c,i.strokeStyle=d,i.setLineDash(u===g.LineType.Dashed?v:[]),i.beginPath(),i.arc(n,o,r,a,s),i.stroke(),i.closePath()}var Pn={name:"arc",checkEventOn:_o,draw:function(i,e,t){xo(i,e,t)}},Ge={};[Fn,mn,An,In,mo,mo,Pn].forEach(function(i){Ge[i.name]=Qt.extend(i)});var Ce=function(i){function e(t){var n=i.call(this)||this;return n._widget=t,n}return N(e,i),e.prototype.getWidget=function(){return this._widget},e.prototype.createFigure=function(t,n,o,r){var a=function(u){var c;return(c=Ge[u])!==null&&c!==void 0?c:null}(t);if(a!==null){var s=new a({name:t,attrs:n,styles:o});if(r!==void 0){for(var l in r)r.hasOwnProperty(l)&&s.registerEvent(l,r[l]);this.addChild(s)}return s}return null},e.prototype.draw=function(t){this.clear(),this.drawImp(t)},e}(Et),Mn=function(i){function e(){return i!==null&&i.apply(this,arguments)||this}return N(e,i),e.prototype.drawImp=function(t){var n,o=this,r=this.getWidget(),a=this.getWidget().getPane(),s=a.getChart(),l=r.getBounding(),u=s.getStyles().grid;if(u.show){t.save(),t.globalCompositeOperation="destination-over";var c=u.horizontal;c.show&&a.getAxisComponent().getTicks().forEach(function(d){var p;(p=o.createFigure("line",{coordinates:[{x:0,y:d.coord},{x:l.width,y:d.coord}]},c))===null||p===void 0||p.draw(t)});var h=u.vertical;h.show&&((n=s.getPaneById(ae))===null||n===void 0?void 0:n.getAxisComponent()).getTicks().forEach(function(d){var p;(p=o.createFigure("line",{coordinates:[{x:d.coord,y:0},{x:d.coord,y:l.height}]},h))===null||p===void 0||p.draw(t)}),t.restore()}},e}(Ce),It=function(i){function e(){return i!==null&&i.apply(this,arguments)||this}return N(e,i),e.prototype.eachChildren=function(t){var n=this.getWidget().getPane().getChart().getChartStore(),o=n.getVisibleDataList(),r=n.getTimeScaleStore().getBarSpace();o.forEach(function(a,s){t(a,r,s)})},e}(Ce),Co=function(i){function e(){var t=i!==null&&i.apply(this,arguments)||this;return t._boundCandleBarClickEvent=function(n){return function(){return t.getWidget().getPane().getChart().getChartStore().getActionStore().execute(g.ActionType.OnCandleBarClick,n),!1}},t}return N(e,i),e.prototype.drawImp=function(t){var n=this,o=this.getWidget().getPane(),r=o.getId()===oe,a=o.getChart().getChartStore(),s=this.getCandleBarOptions(a);if(s!==null){var l=o.getAxisComponent();this.eachChildren(function(u,c){n._drawCandleBar(t,l,u,c,s,r)})}},e.prototype.getCandleBarOptions=function(t){var n=t.getStyles().candle;return{type:n.type,styles:n.bar}},e.prototype._drawCandleBar=function(t,n,o,r,a,s){var l,u,c,h=this,d=o.data,p=o.x,v=d.open,f=d.high,y=d.low,m=d.close,_=r.halfGapBar,x=r.gapBar,C=a.type,S=a.styles;m>v?(l=S.upColor,u=S.upBorderColor,c=S.upWickColor):v>m?(l=S.downColor,u=S.downBorderColor,c=S.downWickColor):(l=S.noChangeColor,u=S.noChangeBorderColor,c=S.noChangeWickColor);var E=n.convertToPixel(v),b=n.convertToPixel(m),T=[E,b,n.convertToPixel(f),n.convertToPixel(y)];T.sort(function(F,B){return F-B});var D=Math.max(1,T[2]-T[1]),A=[];C!==g.CandleType.Ohlc?(A.push({name:"rect",attrs:{x:p-.5,y:T[0],width:1,height:T[1]-T[0]},styles:{color:c}}),A.push(C===g.CandleType.CandleStroke||C===g.CandleType.CandleUpStroke&&m>v||C===g.CandleType.CandleDownStroke&&v>m?{name:"rect",attrs:{x:p-_+.5,y:T[1],width:x-1,height:D},styles:{style:g.PolygonType.Stroke,borderColor:u}}:{name:"rect",attrs:{x:p-_+.5,y:T[1],width:x-1,height:D},styles:{style:g.PolygonType.StrokeFill,color:l,borderColor:u}}),A.push({name:"rect",attrs:{x:p-.5,y:T[2],width:1,height:T[3]-T[2]},styles:{color:c}})):A=[{name:"rect",attrs:{x:p-.5,y:T[0],width:1,height:T[3]-T[0]},styles:{color:l}},{name:"rect",attrs:{x:p-_,y:E,width:_,height:1},styles:{color:l}},{name:"rect",attrs:{x:p,y:b,width:_,height:1},styles:{color:l}}],A.forEach(function(F){var B,R,z=F.attrs,W=F.styles;s&&(R={mouseClickEvent:h._boundCandleBarClickEvent(o)}),(B=h.createFigure("rect",z,W,R))===null||B===void 0||B.draw(t)})},e}(It),Bn=function(i){function e(){return i!==null&&i.apply(this,arguments)||this}return N(e,i),e.prototype.getCandleBarOptions=function(t){var n,o,r=this.getWidget().getPane();if(!r.getAxisComponent().isInCandle()){var a=t.getIndicatorStore().getInstances(r.getId());try{for(var s=Xe(a),l=s.next();!l.done;l=s.next()){var u=l.value[1];if(u.shouldOhlc&&u.visible){var c=u.styles,h=t.getStyles().indicator,d=U(c,"ohlc.upColor",h.ohlc.upColor),p=U(c,"ohlc.downColor",h.ohlc.downColor),v=U(c,"ohlc.noChangeColor",h.ohlc.noChangeColor);return{type:g.CandleType.Ohlc,styles:{upColor:d,downColor:p,noChangeColor:v,upBorderColor:d,downBorderColor:p,noChangeBorderColor:v,upWickColor:d,downWickColor:p,noChangeWickColor:v}}}}}catch(f){n={error:f}}finally{try{l&&!l.done&&(o=s.return)&&o.call(s)}finally{if(n)throw n.error}}}return null},e.prototype.drawImp=function(t){var n,o=this;i.prototype.drawImp.call(this,t);var r=this.getWidget(),a=r.getPane(),s=a.getChart(),l=r.getBounding(),u=(n=s.getPaneById(ae))===null||n===void 0?void 0:n.getAxisComponent(),c=a.getAxisComponent(),h=s.getChartStore(),d=h.getDataList(),p=h.getTimeScaleStore(),v=p.getVisibleRange(),f=h.getIndicatorStore().getInstances(a.getId()),y=h.getStyles().indicator;f.forEach(function(m){var _;if(m.visible){var x=!1;if(m.draw!==null&&(t.save(),x=(_=m.draw({ctx:t,kLineDataList:d,indicator:m,visibleRange:v,bounding:l,barSpace:p.getBarSpace(),defaultStyles:y,xAxis:u,yAxis:c}))!==null&&_!==void 0&&_,t.restore()),!x){var C=m.result;o.eachChildren(function(S,E){var b,T,D,A=E.halfGapBar,F=E.gapBar,B=S.dataIndex,R=S.x,z=u.convertToPixel(B-1),W=u.convertToPixel(B+1),j=(b=C[B-1])!==null&&b!==void 0?b:{},X=(T=C[B])!==null&&T!==void 0?T:{},Q=(D=C[B+1])!==null&&D!==void 0?D:{},ne={x:z},se={x:R},K={x:W};m.figures.forEach(function(H){var $=H.key;ne[$]=c.convertToPixel(j[$]),se[$]=c.convertToPixel(X[$]),K[$]=c.convertToPixel(Q[$])}),St(d,m,B,y,function(H,$){var ie,ue,Te;if(Y(X[H.key])){var ve=se[H.key],fe=(ie=H.attrs)===null||ie===void 0?void 0:ie.call(H,{coordinate:{prev:ne,current:se,next:K},bounding:l,barSpace:E,xAxis:u,yAxis:c});if(!Y(fe))switch(H.type){case"circle":fe={x:R,y:ve,r:A};break;case"rect":case"bar":var De=(ue=H.baseValue)!==null&&ue!==void 0?ue:c.getExtremum().min,Se=c.convertToPixel(De),he=Math.abs(Se-ve);De!==X[H.key]&&(he=Math.max(1,he)),fe={x:R-A,y:ve>Se?Se:ve,width:F,height:he};break;case"line":Z(se[H.key])&&Z(K[H.key])&&(fe={coordinates:[{x:se.x,y:se[H.key]},{x:K.x,y:K[H.key]}]})}if(Y(fe)){var lt=H.type;(Te=o.createFigure(lt==="bar"?"rect":lt,fe,$))===null||Te===void 0||Te.draw(t)}}})})}}})},e}(Co),Ln=function(i){function e(){return i!==null&&i.apply(this,arguments)||this}return N(e,i),e.prototype.drawImp=function(t){var n=this.getWidget(),o=n.getPane(),r=n.getBounding(),a=n.getPane().getChart().getChartStore(),s=a.getTooltipStore().getCrosshair(),l=a.getStyles().crosshair;if(s.paneId!==void 0&&l.show){if(s.paneId===o.getId()){var u=s.y;this._drawLine(t,[{x:0,y:u},{x:r.width,y:u}],l.horizontal)}var c=s.realX;this._drawLine(t,[{x:c,y:0},{x:c,y:r.height}],l.vertical)}},e.prototype._drawLine=function(t,n,o){var r;if(o.show){var a=o.line;a.show&&((r=this.createFigure("line",{coordinates:n},a))===null||r===void 0||r.draw(t))}},e}(Ce),So=function(i){function e(){var t=i!==null&&i.apply(this,arguments)||this;return t._boundIconClickEvent=function(n,o){return function(){return t.getWidget().getPane().getChart().getChartStore().getActionStore().execute(g.ActionType.OnTooltipIconClick,k(k({},n),{iconId:o})),!0}},t._boundIconMouseMoveEvent=function(n,o){return function(){return t.getWidget().getPane().getChart().getChartStore().getTooltipStore().setActiveIcon(k(k({},n),{iconId:o})),!0}},t}return N(e,i),e.prototype.drawImp=function(t){var n=this.getWidget(),o=n.getPane(),r=o.getChart().getChartStore(),a=r.getTooltipStore().getCrosshair();if(a.kLineData!==void 0){var s=n.getBounding(),l=r.getCustomApi(),u=r.getThousandsSeparator(),c=r.getIndicatorStore().getInstances(o.getId()),h=r.getTooltipStore().getActiveIcon(),d=r.getStyles().indicator;this.drawIndicatorTooltip(t,o.getId(),r.getDataList(),a,h,c,l,u,s,d)}},e.prototype.drawIndicatorTooltip=function(t,n,o,r,a,s,l,u,c,h,d){var p=this,v=h.tooltip,f=0;if(this.isDrawTooltip(r,v)){var y=v.text,m=0,_=d??0,x=0;s.forEach(function(C){var S=p.getIndicatorTooltipData(o,r,C,l,u,h),E=S.name,b=S.calcParamsText,T=S.values,D=E.length>0,A=T.length>0;if(D||A){var F=ee(p.classifyTooltipIcons(S.icons),3),B=F[1],R=F[2],z=ee(p.drawStandardTooltipIcons(t,c,{paneId:n,indicatorName:C.name,iconId:""},a,F[0],m,_,x),4);if(m=z[0],_=z[1],f+=z[3],x=z[2],D){var W=E;b.length>0&&(W="".concat(W).concat(b));var j=ee(p.drawStandardTooltipLabels(t,c,[{title:{text:"",color:y.color},value:{text:W,color:y.color}}],m,_,x,y),4);m=j[0],_=j[1],f+=j[3],x=j[2]}var X=ee(p.drawStandardTooltipIcons(t,c,{paneId:n,indicatorName:C.name,iconId:""},a,B,m,_,x),4);if(m=X[0],_=X[1],f+=X[3],x=X[2],A){var Q=ee(p.drawStandardTooltipLabels(t,c,T,m,_,x,y),4);m=Q[0],_=Q[1],f+=Q[3],x=Q[2]}var ne=ee(p.drawStandardTooltipIcons(t,c,{paneId:n,indicatorName:C.name,iconId:""},a,R,m,_,x),4);m=0,f+=ne[3],_=ne[1]+ne[2],x=0}})}return f},e.prototype.drawStandardTooltipIcons=function(t,n,o,r,a,s,l,u){var c=this,h=s,d=l,p=0,v=0,f=0;return a.length>0&&(a.forEach(function(y){var m=y.marginLeft,_=y.marginTop,x=y.marginRight,C=y.marginBottom,S=y.paddingLeft,E=y.paddingTop,b=y.paddingRight,T=y.paddingBottom,D=y.size,A=y.icon;t.font=ke(D,"normal",y.fontFamily),p+=m+S+t.measureText(A).width+b+x,v=Math.max(v,_+E+D+T+C)}),h+p>n.width?(h=a[0].marginLeft,d+=u,f=v):f=Math.max(0,v-u),a.forEach(function(y){var m,_=y.marginRight,x=y.paddingLeft,C=y.paddingRight,S=y.icon,E=(r==null?void 0:r.paneId)===o.paneId&&(r==null?void 0:r.indicatorName)===o.indicatorName&&(r==null?void 0:r.iconId)===y.id;(m=c.createFigure("text",{text:S,x:h+=y.marginLeft,y:d+y.marginTop},{paddingLeft:x,paddingTop:y.paddingTop,paddingRight:C,paddingBottom:y.paddingBottom,color:E?y.activeColor:y.color,size:y.size,family:y.fontFamily,backgroundColor:E?y.activeBackgroundColor:y.backgroundColor},{mouseClickEvent:c._boundIconClickEvent(o,y.id),mouseMoveEvent:c._boundIconMouseMoveEvent(o,y.id)}))===null||m===void 0||m.draw(t),h+=x+t.measureText(S).width+C+_})),[h,d,Math.max(u,v),f]},e.prototype.drawStandardTooltipLabels=function(t,n,o,r,a,s,l){var u=this,c=r,h=a,d=0,p=0,v=s;if(o.length>0){var f=l.marginLeft,y=l.marginTop,m=l.marginRight,_=l.marginBottom,x=l.size,C=l.family,S=l.weight;t.font=ke(x,S,C),o.forEach(function(E){var b,T,D=E.title,A=E.value,F=t.measureText(D.text).width,B=t.measureText(A.text).width,R=x+y+_;c+f+(F+B)+m>n.width?(c=f,h+=R,p+=R):(c+=f,p+=Math.max(0,R-v)),v=d=Math.max(v,R),D.text.length>0&&((b=u.createFigure("text",{x:c,y:h+y,text:D.text},{color:D.color,size:x,family:C,weight:S}))===null||b===void 0||b.draw(t),c+=F),(T=u.createFigure("text",{x:c,y:h+y,text:A.text},{color:A.color,size:x,family:C,weight:S}))===null||T===void 0||T.draw(t),c+=B+m})}return[c,h,d,p]},e.prototype.isDrawTooltip=function(t,n){var o=n.showRule;return o===g.TooltipShowRule.Always||o===g.TooltipShowRule.FollowCross&&t.paneId!==void 0},e.prototype.getIndicatorTooltipData=function(t,n,o,r,a,s){var l,u,c,h=s.tooltip,d=h.showName?o.shortName:"",p="",v=o.calcParams;v.length>0&&h.showParams&&(p="(".concat(v.join(","),")"));var f={name:d,calcParamsText:p,values:[],icons:h.icons},y=n.dataIndex,m=(l=o.result)!==null&&l!==void 0?l:[],_=[];if(o.visible){var x=(u=m[y])!==null&&u!==void 0?u:{};St(t,o,y,s,function(z,W){if(z.title!==void 0){var j=W.color,X=x[z.key];Y(X)&&(X=G(X,o.precision),o.shouldFormatBigNumber&&(X=r.formatBigNumber(X))),_.push({title:{text:z.title,color:j},value:{text:J(X??h.defaultValue,a),color:j}})}}),f.values=_}if(o.createTooltipDataSource!==null){var C=this.getWidget(),S=C.getPane(),E=S.getChart().getChartStore(),b=o.createTooltipDataSource({kLineDataList:t,indicator:o,visibleRange:E.getTimeScaleStore().getVisibleRange(),bounding:C.getBounding(),crosshair:n,defaultStyles:s,xAxis:(c=S.getChart().getPaneById(ae))===null||c===void 0?void 0:c.getAxisComponent(),yAxis:S.getAxisComponent()}),T=b.name,D=b.calcParamsText,A=b.values,F=b.icons;if(T!==void 0&&h.showName&&(f.name=T),D!==void 0&&h.showParams&&(f.calcParamsText=D),F!==void 0&&(f.icons=F),A!==void 0&&o.visible){var B=[],R=s.tooltip.text.color;A.forEach(function(z){var W={text:"",color:R};O(z.title)?W=z.title:W.text=z.title;var j={text:"",color:R};O(z.value)?j=z.value:j.text=z.value,j.text=J(j.text,a),B.push({title:W,value:j})}),f.values=B}}return f},e.prototype.classifyTooltipIcons=function(t){var n=[],o=[],r=[];return t.forEach(function(a){switch(a.position){case g.TooltipIconPosition.Left:n.push(a);break;case g.TooltipIconPosition.Middle:o.push(a);break;case g.TooltipIconPosition.Right:r.push(a)}}),[n,o,r]},e}(Ce),bo=function(i){function e(t){var n=i.call(this,t)||this;return n._initEvent(),n}return N(e,i),e.prototype._initEvent=function(){var t=this,n=this.getWidget().getPane(),o=n.getId(),r=n.getChart().getChartStore().getOverlayStore();this.registerEvent("mouseMoveEvent",function(a){var s,l=r.getProgressInstanceInfo();if(l!==null){var u=l.instance,c=l.paneId;u.isStart()&&(r.updateProgressInstanceInfo(o),c=o);var h=u.points.length-1,d="".concat(Oe,"point_").concat(h);return u.isDrawing()&&c===o&&(u.eventMoveForDrawing(t._coordinateToPoint(l.instance,a)),(s=u.onDrawing)===null||s===void 0||s.call(u,k({overlay:u,figureKey:d,figureIndex:h},a))),t._figureMouseMoveEvent(u,1,d,h,0)(a)}return r.setHoverInstanceInfo({paneId:o,instance:null,figureType:0,figureKey:"",figureIndex:-1,attrsIndex:-1},a),!1}).registerEvent("mouseClickEvent",function(a){var s,l,u=r.getProgressInstanceInfo();if(u!==null){var c=u.instance,h=u.paneId;c.isStart()&&(r.updateProgressInstanceInfo(o,!0),h=o);var d=c.points.length-1,p="".concat(Oe,"point_").concat(d);return c.isDrawing()&&h===o&&(c.eventMoveForDrawing(t._coordinateToPoint(c,a)),(s=c.onDrawing)===null||s===void 0||s.call(c,k({overlay:c,figureKey:p,figureIndex:d},a)),c.nextStep(),c.isDrawing()||(r.progressInstanceComplete(),(l=c.onDrawEnd)===null||l===void 0||l.call(c,k({overlay:c,figureKey:p,figureIndex:d},a)))),t._figureMouseClickEvent(c,1,p,d,0)(a)}return r.setClickInstanceInfo({paneId:o,instance:null,figureType:0,figureKey:"",figureIndex:-1,attrsIndex:-1},a),!1}).registerEvent("mouseDoubleClickEvent",function(a){var s,l=r.getProgressInstanceInfo();if(l!==null){var u=l.instance,c=l.paneId;if(u.isDrawing()&&c===o&&(u.forceComplete(),!u.isDrawing())){r.progressInstanceComplete();var h=u.points.length-1,d="".concat(Oe,"point_").concat(h);(s=u.onDrawEnd)===null||s===void 0||s.call(u,k({overlay:u,figureKey:d,figureIndex:h},a))}var p=u.points.length-1;return t._figureMouseClickEvent(u,1,"".concat(Oe,"point_").concat(p),p,0)(a)}return!1}).registerEvent("mouseRightClickEvent",function(a){var s=r.getProgressInstanceInfo();if(s!==null){var l=s.instance;if(l.isDrawing()){var u=l.points.length-1;return t._figureMouseRightClickEvent(l,1,"".concat(Oe,"point_").concat(u),u,0)(a)}}return!1}).registerEvent("mouseUpEvent",function(a){var s,l=r.getPressedInstanceInfo(),u=l.instance;return u!==null&&((s=u.onPressedMoveEnd)===null||s===void 0||s.call(u,k({overlay:u,figureKey:l.figureKey,figureIndex:l.figureIndex},a))),r.setPressedInstanceInfo({paneId:o,instance:null,figureType:0,figureKey:"",figureIndex:-1,attrsIndex:-1}),!1}).registerEvent("pressedMouseMoveEvent",function(a){var s,l,u=r.getPressedInstanceInfo(),c=u.instance,h=u.figureType,d=u.figureIndex;if(c!==null){if(!(c.lock||(l=(s=c.onPressedMoving)===null||s===void 0?void 0:s.call(c,k({overlay:c,figureIndex:d,figureKey:u.figureKey},a)))!==null&&l!==void 0&&l)){var p=t._coordinateToPoint(c,a);h===1?c.eventPressedPointMove(p,d):c.eventPressedOtherMove(p,t.getWidget().getPane().getChart().getChartStore().getTimeScaleStore())}return!0}return!1})},e.prototype._createFigureEvents=function(t,n,o,r,a,s){var l;if(!t.isDrawing()){var u=[];if(s!==void 0&&(re(s)?s&&(u=["mouseClickEvent","mouseDoubleClickEvent","mouseRightClickEvent","tapEvent","doubleTapEvent","mouseDownEvent","touchStartEvent","mouseMoveEvent","touchMoveEvent"]):u=s),u.length===0)return{mouseMoveEvent:this._figureMouseMoveEvent(t,n,o,r,a),mouseDownEvent:this._figureMouseDownEvent(t,n,o,r,a),mouseClickEvent:this._figureMouseClickEvent(t,n,o,r,a),mouseRightClickEvent:this._figureMouseRightClickEvent(t,n,o,r,a),mouseDoubleClickEvent:this._figureMouseDoubleClickEvent(t,n,o,r,a)};l={},u.includes("mouseMoveEvent")||u.includes("touchMoveEvent")||(l.mouseMoveEvent=this._figureMouseMoveEvent(t,n,o,r,a)),u.includes("mouseDownEvent")||u.includes("touchStartEvent")||(l.mouseDownEvent=this._figureMouseDownEvent(t,n,o,r,a)),u.includes("mouseClickEvent")||u.includes("tapEvent")||(l.mouseClickEvent=this._figureMouseClickEvent(t,n,o,r,a)),u.includes("mouseDoubleClickEvent")||u.includes("doubleTapEvent")||(l.mouseDoubleClickEvent=this._figureMouseDoubleClickEvent(t,n,o,r,a)),u.includes("mouseRightClickEvent")||(l.mouseRightClickEvent=this._figureMouseRightClickEvent(t,n,o,r,a))}return l},e.prototype._figureMouseMoveEvent=function(t,n,o,r,a){var s=this;return function(l){var u=s.getWidget().getPane();return u.getChart().getChartStore().getOverlayStore().setHoverInstanceInfo({paneId:u.getId(),instance:t,figureType:n,figureKey:o,figureIndex:r,attrsIndex:a},l),!0}},e.prototype._figureMouseDownEvent=function(t,n,o,r,a){var s=this;return function(l){var u,c=s.getWidget().getPane(),h=c.getId(),d=c.getChart().getChartStore().getOverlayStore();return t.startPressedMove(s._coordinateToPoint(t,l)),(u=t.onPressedMoveStart)===null||u===void 0||u.call(t,k({overlay:t,figureIndex:r,figureKey:o},l)),d.setPressedInstanceInfo({paneId:h,instance:t,figureType:n,figureKey:o,figureIndex:r,attrsIndex:a}),!0}},e.prototype._figureMouseClickEvent=function(t,n,o,r,a){var s=this;return function(l){var u=s.getWidget().getPane(),c=u.getId();return u.getChart().getChartStore().getOverlayStore().setClickInstanceInfo({paneId:c,instance:t,figureType:n,figureKey:o,figureIndex:r,attrsIndex:a},l),!0}},e.prototype._figureMouseDoubleClickEvent=function(t,n,o,r,a){return function(s){var l;return(l=t.onDoubleClick)===null||l===void 0||l.call(t,k(k({},s),{figureIndex:r,figureKey:o,overlay:t})),!0}},e.prototype._figureMouseRightClickEvent=function(t,n,o,r,a){var s=this;return function(l){var u,c;return(c=(u=t.onRightClick)===null||u===void 0?void 0:u.call(t,k({overlay:t,figureIndex:r,figureKey:o},l)))!==null&&c!==void 0&&c||s.getWidget().getPane().getChart().getChartStore().getOverlayStore().removeInstance(t),!0}},e.prototype._coordinateToPoint=function(t,n){var o,r,a={},s=this.getWidget().getPane(),l=s.getChart(),u=s.getId(),c=l.getChartStore().getTimeScaleStore();if(this.coordinateToPointTimestampDataIndexFlag()){var h=((o=l.getPaneById(ae))===null||o===void 0?void 0:o.getAxisComponent()).convertFromPixel(n.x),d=(r=c.dataIndexToTimestamp(h))!==null&&r!==void 0?r:void 0;a.dataIndex=h,a.timestamp=d}if(this.coordinateToPointValueFlag()){var p=s.getAxisComponent(),v=p.convertFromPixel(n.y);if(t.mode!==g.OverlayMode.Normal&&u===oe&&a.dataIndex!==void 0){var f=c.getDataByDataIndex(a.dataIndex);if(f!==null){var y=t.modeSensitivity;if(v>f.high)if(t.mode===g.OverlayMode.WeakMagnet){var m=p.convertToPixel(f.high);p.convertFromPixel(m-y)>v&&(v=f.high)}else v=f.high;else if(f.low>v)if(t.mode===g.OverlayMode.WeakMagnet){var _=p.convertToPixel(f.low);v>p.convertFromPixel(_-y)&&(v=f.low)}else v=f.low;else{var x=Math.max(f.open,f.close),C=Math.min(f.open,f.close);v=v>x?f.high-v>v-x?x:f.high:C>v?C-v>v-f.low?f.low:C:v-C>x-v?x:C}}}a.value=v}return a},e.prototype.coordinateToPointValueFlag=function(){return!0},e.prototype.coordinateToPointTimestampDataIndexFlag=function(){return!0},e.prototype.dispatchEvent=function(t,n,o){return this.getWidget().getPane().getChart().getChartStore().getOverlayStore().isDrawing()?this.onEvent(t,n,o):i.prototype.dispatchEvent.call(this,t,n,o)},e.prototype.checkEventOn=function(){return!0},e.prototype.drawImp=function(t){var n,o=this,r=this.getWidget(),a=r.getPane(),s=a.getId(),l=a.getChart(),u=a.getAxisComponent(),c=(n=l.getPaneById(ae))===null||n===void 0?void 0:n.getAxisComponent(),h=r.getBounding(),d=l.getChartStore(),p=d.getCustomApi(),v=d.getThousandsSeparator(),f=d.getTimeScaleStore(),y=f.getDateTimeFormat(),m=f.getBarSpace(),_=d.getPrecision(),x=d.getStyles().overlay,C=d.getOverlayStore(),S=C.getHoverInstanceInfo(),E=C.getClickInstanceInfo();this.getCompleteOverlays(C,s).forEach(function(D){D.visible&&o._drawOverlay(t,D,h,m,_,y,p,v,x,c,u,S,E,f)});var b=C.getProgressInstanceInfo();if(b!==null){var T=this.getProgressOverlay(b,s);T!==null&&T.visible&&this._drawOverlay(t,T,h,m,_,y,p,v,x,c,u,S,E,f)}},e.prototype._drawOverlay=function(t,n,o,r,a,s,l,u,c,h,d,p,v,f){var y=n.points.map(function(_){var x,C,S=_.dataIndex;_.timestamp!==void 0&&(S=f.timestampToDataIndex(_.timestamp));var E={x:0,y:0};return S!==void 0&&(E.x=(x=h==null?void 0:h.convertToPixel(S))!==null&&x!==void 0?x:0),_.value!==void 0&&(E.y=(C=d==null?void 0:d.convertToPixel(_.value))!==null&&C!==void 0?C:0),E});if(y.length>0){var m=[].concat(this.getFigures(n,y,o,r,a,u,s,c,h,d));this.drawFigures(t,n,m,c)}this.drawDefaultFigures(t,n,y,o,a,s,l,u,c,h,d,p,v)},e.prototype.drawFigures=function(t,n,o,r){var a=this;o.forEach(function(s,l){var u=s.type,c=s.styles,h=s.ignoreEvent;[].concat(s.attrs).forEach(function(d,p){var v,f,y,m=a._createFigureEvents(n,2,(v=s.key)!==null&&v!==void 0?v:"",l,p,h),_=k(k(k({},r[u]),(f=n.styles)===null||f===void 0?void 0:f[u]),c);(y=a.createFigure(u,d,_,m))===null||y===void 0||y.draw(t)})})},e.prototype.getCompleteOverlays=function(t,n){return t.getInstances(n)},e.prototype.getProgressOverlay=function(t,n){return t.paneId===n?t.instance:null},e.prototype.getFigures=function(t,n,o,r,a,s,l,u,c,h){var d,p;return(p=(d=t.createPointFigures)===null||d===void 0?void 0:d.call(t,{overlay:t,coordinates:n,bounding:o,barSpace:r,precision:a,thousandsSeparator:s,dateTimeFormat:l,defaultStyles:u,xAxis:c,yAxis:h}))!==null&&p!==void 0?p:[]},e.prototype.drawDefaultFigures=function(t,n,o,r,a,s,l,u,c,h,d,p,v){var f,y,m=this;if(n.needDefaultPointFigure&&(((f=p.instance)===null||f===void 0?void 0:f.id)===n.id&&p.figureType!==0||((y=v.instance)===null||y===void 0?void 0:y.id)===n.id&&v.figureType!==0)){var _=n.styles,x=k(k({},c.point),_==null?void 0:_.point);o.forEach(function(C,S){var E,b,T,D=C.x,A=C.y,F=x.radius,B=x.color,R=x.borderColor,z=x.borderSize;((E=p.instance)===null||E===void 0?void 0:E.id)===n.id&&p.figureType===1&&p.figureIndex===S&&(F=x.activeRadius,B=x.activeColor,R=x.activeBorderColor,z=x.activeBorderSize),(b=m.createFigure("circle",{x:D,y:A,r:F+z},{color:R},m._createFigureEvents(n,1,"".concat(Oe,"point_").concat(S),S,0)))===null||b===void 0||b.draw(t),(T=m.createFigure("circle",{x:D,y:A,r:F},{color:B}))===null||T===void 0||T.draw(t)})}},e}(Ce),Eo=function(i){function e(t,n){var o=i.call(this,t,n)||this;return o._gridView=new Mn(o),o._indicatorView=new Bn(o),o._crosshairLineView=new Ln(o),o._tooltipView=o.createTooltipView(),o._overlayView=new bo(o),o.addChild(o._tooltipView),o.addChild(o._overlayView),o.getContainer().style.cursor="crosshair",o.registerEvent("mouseMoveEvent",function(){return n.getChart().getChartStore().getTooltipStore().setActiveIcon(),!1}),o}return N(e,i),e.prototype.getName=function(){return te},e.prototype.updateMain=function(t){this.updateMainContent(t),this._indicatorView.draw(t),this._gridView.draw(t)},e.prototype.createTooltipView=function(){return new So(this)},e.prototype.updateMainContent=function(t){},e.prototype.updateOverlay=function(t){this._overlayView.draw(t),this._crosshairLineView.draw(t),this._tooltipView.draw(t)},e}(Dt),Rn=function(i){function e(){return i!==null&&i.apply(this,arguments)||this}return N(e,i),e.prototype.drawImp=function(t){var n,o,r=this.getWidget(),a=r.getPane(),s=a.getChart(),l=r.getBounding(),u=a.getAxisComponent(),c=s.getStyles().candle.area,h=[],d=[],p=Number.MAX_SAFE_INTEGER;this.eachChildren(function(C,S,E){var b=C.x,T=S.halfGapBar,D=C.data[c.value];if(Z(D)){var A=u.convertToPixel(D);if(E===0){var F=b-T;d.push({x:F,y:l.height}),d.push({x:F,y:A}),h.push({x:F,y:A})}h.push({x:b,y:A}),d.push({x:b,y:A}),p=Math.min(p,A)}});var v=d.length;if(v>0){var f=d[v-1],y=f.x;h.push({x:y,y:f.y}),d.push({x:y,y:f.y}),d.push({x:y,y:l.height})}if(h.length>0&&((n=this.createFigure("line",{coordinates:h},{color:c.lineColor,size:c.lineSize}))===null||n===void 0||n.draw(t)),d.length>0){var m=c.backgroundColor,_=void 0;if(M(m)){var x=t.createLinearGradient(0,l.height,0,p);try{m.forEach(function(C){x.addColorStop(C.offset,C.color)})}catch{}_=x}else _=m;(o=this.createFigure("polygon",{coordinates:d},{color:_}))===null||o===void 0||o.draw(t)}},e}(It),zn=function(i){function e(){return i!==null&&i.apply(this,arguments)||this}return N(e,i),e.prototype.drawImp=function(t){var n=this.getWidget().getPane(),o=n.getChart().getChartStore(),r=o.getStyles().candle.priceMark,a=r.high,s=r.low;if(r.show&&(a.show||s.show)){var l=o.getThousandsSeparator(),u=o.getPrecision(),c=n.getAxisComponent(),h=Number.MIN_SAFE_INTEGER,d=0,p=Number.MAX_SAFE_INTEGER,v=0;this.eachChildren(function(m){var _=m.data,x=m.x;_.high>h&&(h=_.high,d=x),p>_.low&&(p=_.low,v=x)});var f=c.convertToPixel(h),y=c.convertToPixel(p);a.show&&h!==Number.MIN_SAFE_INTEGER&&this._drawMark(t,J(G(h,u.price),l),{x:d,y:f},y>f?[-2,-5]:[2,5],a),s.show&&p!==Number.MAX_SAFE_INTEGER&&this._drawMark(t,J(G(p,u.price),l),{x:v,y},y>f?[2,5]:[-2,-5],s)}},e.prototype._drawMark=function(t,n,o,r,a){var s,l,u,c,h,d,p=o.x,v=o.y+r[0];(s=this.createFigure("line",{coordinates:[{x:p-2,y:v+r[0]},{x:p,y:v},{x:p+2,y:v+r[0]}]},{color:a.color}))===null||s===void 0||s.draw(t),p>this.getWidget().getBounding().width/2?(h=(c=p-5)-a.textOffset,d="right"):(d="left",h=(c=p+5)+a.textOffset);var f=v+r[1];(l=this.createFigure("line",{coordinates:[{x:p,y:v},{x:p,y:f},{x:c,y:f}]},{color:a.color}))===null||l===void 0||l.draw(t),(u=this.createFigure("text",{x:h,y:f,text:n,align:d,baseline:"middle"},{color:a.color,size:a.textSize,family:a.textFamily,weight:a.textWeight}))===null||u===void 0||u.draw(t)},e}(It),Vn=function(i){function e(){return i!==null&&i.apply(this,arguments)||this}return N(e,i),e.prototype.drawImp=function(t){var n,o=this.getWidget(),r=o.getPane(),a=o.getBounding(),s=r.getChart().getChartStore(),l=s.getStyles().candle.priceMark,u=l.last,c=u.line;if(l.show&&u.show&&c.show){var h=r.getAxisComponent(),d=s.getDataList(),p=d[d.length-1];if(p!=null){var v=p.close,f=p.open,y=h.convertToNicePixel(v);(n=this.createFigure("line",{coordinates:[{x:0,y},{x:a.width,y}]},{style:c.style,color:v>f?u.upColor:f>v?u.downColor:u.noChangeColor,size:c.size,dashedValue:c.dashedValue}))===null||n===void 0||n.draw(t)}}},e}(Ce),at={"zh-CN":{time:"时间：",open:"开：",high:"高：",low:"低：",close:"收：",volume:"成交量：",change:"涨幅："},"en-US":{time:"Time: ",open:"Open: ",high:"High: ",low:"Low: ",close:"Close: ",volume:"Volume: ",change:"Change: "}},On=function(i){function e(){return i!==null&&i.apply(this,arguments)||this}return N(e,i),e.prototype.drawImp=function(t){var n,o=this.getWidget(),r=o.getPane(),a=r.getId(),s=r.getChart().getChartStore(),l=s.getTooltipStore().getCrosshair();if(l.kLineData!==void 0){var u=o.getBounding(),c=(n=r.getYAxisWidget())===null||n===void 0?void 0:n.getBounding(),h=s.getDataList(),d=s.getPrecision(),p=s.getLocale(),v=s.getCustomApi(),f=s.getThousandsSeparator(),y=s.getTooltipStore().getActiveIcon(),m=s.getIndicatorStore().getInstances(r.getId()),_=s.getTimeScaleStore().getDateTimeFormat(),x=s.getStyles(),C=x.candle,S=x.indicator;if(C.tooltip.showType===g.TooltipShowType.Rect&&S.tooltip.showType===g.TooltipShowType.Rect){var E=this.isDrawTooltip(l,C.tooltip),b=this.isDrawTooltip(l,S.tooltip);this._drawRectTooltip(t,h,m,u,c,l,d,_,p,v,f,E,b,x,0)}else if(C.tooltip.showType===g.TooltipShowType.Standard&&S.tooltip.showType===g.TooltipShowType.Standard){var T=this._drawCandleStandardTooltip(t,h,a,u,l,y,d,_,p,v,f,C);this.drawIndicatorTooltip(t,a,h,l,y,m,v,f,u,S,T)}else if(C.tooltip.showType===g.TooltipShowType.Rect&&S.tooltip.showType===g.TooltipShowType.Standard){var D=this.drawIndicatorTooltip(t,a,h,l,y,m,v,f,u,S,0);E=this.isDrawTooltip(l,C.tooltip),this._drawRectTooltip(t,h,m,u,c,l,d,_,p,v,f,E,!1,x,D)}else{var A=this._drawCandleStandardTooltip(t,h,a,u,l,y,d,_,p,v,f,C);b=this.isDrawTooltip(l,S.tooltip),this._drawRectTooltip(t,h,m,u,c,l,d,_,p,v,f,!1,b,x,A)}}},e.prototype._drawCandleStandardTooltip=function(t,n,o,r,a,s,l,u,c,h,d,p){var v,f,y,m=p.tooltip,_=m.text,x=0;if(this.isDrawTooltip(a,m)){var C=(v=a.dataIndex)!==null&&v!==void 0?v:0,S=this._getCandleTooltipData({prev:(f=n[C-1])!==null&&f!==void 0?f:null,current:a.kLineData,next:(y=n[C+1])!==null&&y!==void 0?y:null},l,u,c,h,d,p),E=0,b=0,T=0,D=ee(this.classifyTooltipIcons(m.icons),3),A=D[1],F=D[2],B=ee(this.drawStandardTooltipIcons(t,r,{paneId:o,indicatorName:"",iconId:""},s,D[0],E,b,0),4);x+=B[3];var R=ee(this.drawStandardTooltipIcons(t,r,{paneId:o,indicatorName:"",iconId:""},s,A,E=B[0],b=B[1],T=B[2]),4);if(E=R[0],b=R[1],x+=R[3],T=R[2],S.length>0){var z=ee(this.drawStandardTooltipLabels(t,r,S,E,b,T,_),4);E=z[0],b=z[1],x+=z[3],T=z[2]}var W=ee(this.drawStandardTooltipIcons(t,r,{paneId:o,indicatorName:"",iconId:""},s,F,E,b,T),4);E=W[0],b=W[1],x+=W[3],T=W[2]}return x},e.prototype._drawRectTooltip=function(t,n,o,r,a,s,l,u,c,h,d,p,v,f,y){var m,_,x,C,S,E=this,b=f.candle,T=f.indicator,D=b.tooltip,A=T.tooltip;if(p||v){var F=(m=s.dataIndex)!==null&&m!==void 0?m:0,B=this._getCandleTooltipData({prev:(_=n[F-1])!==null&&_!==void 0?_:null,current:s.kLineData,next:(x=n[F+1])!==null&&x!==void 0?x:null},l,u,c,h,d,b),R=D.text,z=R.marginLeft,W=R.marginRight,j=R.marginTop,X=R.marginBottom,Q=R.size,ne=R.weight,se=R.family,K=D.rect,H=K.position,$=K.paddingLeft,ie=K.paddingRight,ue=K.paddingTop,Te=K.paddingBottom,ve=K.offsetLeft,fe=K.offsetRight,De=K.offsetTop,Se=K.offsetBottom,he=K.borderSize,lt=K.borderRadius,ni=K.borderColor,ii=K.color,$e=0,Me=0,Fe=0;p&&(t.font=ke(Q,ne,se),B.forEach(function(we){var de=we.value,pe="".concat(we.title.text).concat(de.text),ye=t.measureText(pe).width+z+W;$e=Math.max($e,ye)}),Fe+=(X+j+Q)*B.length);var Be=A.text,Po=Be.marginLeft,Mo=Be.marginRight,Bo=Be.marginTop,Lo=Be.marginBottom,Je=Be.size,Mt=Be.weight,Bt=Be.family,Ro=[];if(v&&(t.font=ke(Je,Mt,Bt),o.forEach(function(we){var de,pe=(de=E.getIndicatorTooltipData(n,s,we,h,d,T).values)!==null&&de!==void 0?de:[];Ro.push(pe),pe.forEach(function(ye){var Le=ye.value,ut="".concat(ye.title.text).concat(Le.text),si=t.measureText(ut).width+Po+Mo;$e=Math.max($e,si),Fe+=Bo+Lo+Je})})),(Me+=$e)!==0&&Fe!==0){Me+=2*he+$+ie,Fe+=2*he+ue+Te;var zo=H===Qe.Pointer&&s.paneId===oe,Vo=((C=s.realX)!==null&&C!==void 0?C:0)>r.width/2,be=0;if(zo){var Oo=s.realX;be=Vo?Oo-fe-Me:Oo+ve}else Vo?(be=ve,f.yAxis.inside&&f.yAxis.position===g.YAxisPosition.Left&&(be+=a.width)):(be=r.width-fe-Me,f.yAxis.inside&&f.yAxis.position===g.YAxisPosition.Right&&(be-=a.width));var We=y+De;zo&&((We=s.y-Fe/2)+Fe>r.height-Se&&(We=r.height-Se-Fe),y+De>We&&(We=y+De)),(S=this.createFigure("rect",{x:be,y:We,width:Me,height:Fe},{style:g.PolygonType.StrokeFill,color:ii,borderColor:ni,borderSize:he,borderRadius:lt}))===null||S===void 0||S.draw(t);var ri=be+he+$+z,Ye=We+he+ue;if(p&&B.forEach(function(we){var de,pe,ye=we.title;(de=E.createFigure("text",{x:ri,y:Ye+=j,text:ye.text},{color:ye.color,size:Q,family:se,weight:ne}))===null||de===void 0||de.draw(t);var Le=we.value;(pe=E.createFigure("text",{x:be+Me-he-W-ie,y:Ye,text:Le.text,align:"right"},{color:Le.color,size:Q,family:se,weight:ne}))===null||pe===void 0||pe.draw(t),Ye+=Q+X}),v){var ai=be+he+$+Po;Ro.forEach(function(we){we.forEach(function(de){var pe,ye,Le=de.title,ut=de.value;(pe=E.createFigure("text",{x:ai,y:Ye+=Bo,text:Le.text},{color:Le.color,size:Je,family:Bt,weight:Mt}))===null||pe===void 0||pe.draw(t),(ye=E.createFigure("text",{x:be+Me-he-Mo-ie,y:Ye,text:ut.text,align:"right"},{color:ut.color,size:Je,family:Bt,weight:Mt}))===null||ye===void 0||ye.draw(t),Ye+=Je+Lo})})}}}},e.prototype._getCandleTooltipData=function(t,n,o,r,a,s,l){var u,c,h,d,p,v=l.tooltip,f=v.text.color,y=t.current,m=(c=(u=t.prev)===null||u===void 0?void 0:u.close)!==null&&c!==void 0?c:y.close,_=y.close-m,x=n.price,C=n.volume,S={"{time}":a.formatDate(o,y.timestamp,"YYYY-MM-DD HH:mm",g.FormatDateType.Tooltip),"{open}":J(G(y.open,x),s),"{high}":J(G(y.high,x),s),"{low}":J(G(y.low,x),s),"{close}":J(G(y.close,x),s),"{volume}":J(a.formatBigNumber(G((h=y.volume)!==null&&h!==void 0?h:v.defaultValue,C)),s),"{change}":m===0?v.defaultValue:"".concat(G(_/m*100),"%")};return((p=L(v.custom)?(d=v.custom)===null||d===void 0?void 0:d.call(v,t,l):v.custom)!==null&&p!==void 0?p:[{title:"time",value:"{time}"},{title:"open",value:"{open}"},{title:"high",value:"{high}"},{title:"low",value:"{low}"},{title:"close",value:"{close}"},{title:"volume",value:"{volume}"}]).map(function(E){var b,T=E.title,D=E.value,A={text:"",color:""};O(T)?A=k({},T):(A.text=T,A.color=f),A.text=function(z,W){var j,X;return(X=(j=at[W])===null||j===void 0?void 0:j[z])!==null&&X!==void 0?X:z}(A.text,r);var F={text:v.defaultValue,color:""};O(D)?F=k({},D):(F.text=D,F.color=f);var B=F.text.match(/{(\S*)}/);if(B!==null&&B.length>1){var R="{".concat(B[1],"}");F.text=F.text.replace(R,(b=S[R])!==null&&b!==void 0?b:v.defaultValue),R==="{change}"&&(F.color=_===0?l.priceMark.last.noChangeColor:_>0?l.priceMark.last.upColor:l.priceMark.last.downColor)}return{title:A,value:F}})},e}(So),Nn=function(i){function e(t,n){var o=i.call(this,t,n)||this;return o._candleBarView=new Co(o),o._candleAreaView=new Rn(o),o._candleHighLowPriceView=new zn(o),o._candleLastPriceLineView=new Vn(o),o.addChild(o._candleBarView),o}return N(e,i),e.prototype.updateMainContent=function(t){this.getPane().getChart().getStyles().candle.type!==g.CandleType.Area?(this._candleBarView.draw(t),this._candleHighLowPriceView.draw(t)):this._candleAreaView.draw(t),this._candleLastPriceLineView.draw(t)},e.prototype.createTooltipView=function(){return new On(this)},e}(Eo),wo=function(i){function e(){return i!==null&&i.apply(this,arguments)||this}return N(e,i),e.prototype.drawImp=function(t){var n,o=this,r=this.getWidget(),a=r.getPane(),s=r.getBounding(),l=a.getAxisComponent(),u=this.getAxisStyles(a.getChart().getStyles());if(u.show){u.axisLine.show&&((n=this.createFigure("line",this.createAxisLine(s,u),u.axisLine))===null||n===void 0||n.draw(t));var c=l.getTicks();u.tickLine.show&&this.createTickLines(c,s,u).forEach(function(h){var d;(d=o.createFigure("line",h,u.tickLine))===null||d===void 0||d.draw(t)}),u.tickText.show&&this.createTickTexts(c,s,u).forEach(function(h){var d;(d=o.createFigure("text",h,u.tickText))===null||d===void 0||d.draw(t)})}},e}(Ce),Wn=function(i){function e(){return i!==null&&i.apply(this,arguments)||this}return N(e,i),e.prototype.getAxisStyles=function(t){return t.yAxis},e.prototype.createAxisLine=function(t,n){var o,r=this.getWidget().getPane().getAxisComponent(),a=n.axisLine.size;return{coordinates:[{x:o=r.isFromZero()?a/2:t.width-a,y:0},{x:o,y:t.height}]}},e.prototype.createTickLines=function(t,n,o){var r=this.getWidget().getPane().getAxisComponent(),a=o.axisLine,s=o.tickLine,l=0,u=0;return r.isFromZero()?(l=0,a.show&&(l+=a.size),u=l+s.length):(l=n.width,a.show&&(l-=a.size),u=l-s.length),t.map(function(c){return{coordinates:[{x:l,y:c.coord},{x:u,y:c.coord}]}})},e.prototype.createTickTexts=function(t,n,o){var r=this.getWidget().getPane().getAxisComponent(),a=o.axisLine,s=o.tickLine,l=o.tickText,u=0;r.isFromZero()?(u=l.marginStart,a.show&&(u+=a.size),s.show&&(u+=s.length)):(u=n.width-l.marginEnd,a.show&&(u-=a.size),s.show&&(u-=s.length));var c=this.getWidget().getPane().getAxisComponent().isFromZero()?"left":"right";return t.map(function(h){return{x:u,y:h.coord,text:h.text,align:c,baseline:"middle"}})},e}(wo),Yn=function(i){function e(){return i!==null&&i.apply(this,arguments)||this}return N(e,i),e.prototype.drawImp=function(t){var n,o=this.getWidget(),r=o.getPane(),a=o.getBounding(),s=r.getChart().getChartStore(),l=s.getStyles().candle.priceMark,u=l.last,c=u.text;if(l.show&&u.show&&c.show){var h=s.getPrecision(),d=r.getAxisComponent(),p=s.getDataList(),v=s.getVisibleDataList(),f=p[p.length-1];if(f!==void 0){var y=f.close,m=f.open,_=d.convertToNicePixel(y),x=void 0;x=y>m?u.upColor:m>y?u.downColor:u.noChangeColor;var C=void 0;if(d.getType()===g.YAxisType.Percentage){var S=v[0].data.close;C="".concat(((y-S)/S*100).toFixed(2),"%")}else C=G(y,h.price);C=J(C,s.getThousandsSeparator());var E=void 0,b=void 0;d.isFromZero()?(E=0,b="left"):(E=a.width,b="right"),(n=this.createFigure("text",{x:E,y:_,text:C,align:b,baseline:"middle"},k(k({},c),{backgroundColor:x})))===null||n===void 0||n.draw(t)}}},e}(Ce),Hn=function(i){function e(){return i!==null&&i.apply(this,arguments)||this}return N(e,i),e.prototype.drawImp=function(t){var n=this,o=this.getWidget(),r=o.getPane(),a=o.getBounding(),s=r.getChart().getChartStore(),l=s.getCustomApi(),u=s.getStyles().indicator,c=u.lastValueMark,h=c.text;if(c.show){var d=r.getAxisComponent(),p=s.getDataList(),v=p.length-1,f=s.getIndicatorStore().getInstances(r.getId()),y=s.getThousandsSeparator();f.forEach(function(m){var _=m.result[v];if(_!==void 0&&m.visible){var x=m.precision;St(p,m,v,u,function(C,S){var E,b=_[C.key];if(Y(b)){var T=d.convertToNicePixel(b),D=G(b,x);m.shouldFormatBigNumber&&(D=l.formatBigNumber(D)),D=J(D,y);var A=void 0,F=void 0;d.isFromZero()?(A=0,F="left"):(A=a.width,F="right"),(E=n.createFigure("text",{x:A,y:T,text:D,align:F,baseline:"middle"},k(k({},h),{backgroundColor:S.color})))===null||E===void 0||E.draw(t)}})}})}},e}(Ce),To=function(i){function e(){return i!==null&&i.apply(this,arguments)||this}return N(e,i),e.prototype.coordinateToPointTimestampDataIndexFlag=function(){return!1},e.prototype.drawDefaultFigures=function(t,n,o,r,a,s,l,u,c,h,d,p,v){this.drawFigures(t,n,this.getDefaultFigures(n,o,r,a,s,l,u,h,d,v),c)},e.prototype.getDefaultFigures=function(t,n,o,r,a,s,l,u,c,h){var d,p,v=[];if(t.needDefaultYAxisFigure&&t.id===((d=h.instance)===null||d===void 0?void 0:d.id)&&h.paneId===this.getWidget().getPane().getId()){var f,y,m=Number.MAX_SAFE_INTEGER,_=Number.MIN_SAFE_INTEGER;(p=c==null?void 0:c.isFromZero())!==null&&p!==void 0&&p?(f="left",y=0):(f="right",y=o.width),n.forEach(function(x,C){var S=t.points[C];if(S.value!==void 0){m=Math.min(m,x.y),_=Math.max(_,x.y);var E=J(G(S.value,r.price),l);v.push({type:"text",attrs:{x:y,y:x.y,text:E,align:f,baseline:"middle"},ignoreEvent:!0})}}),n.length>1&&v.unshift({type:"rect",attrs:{x:0,y:m,width:o.width,height:_-m},ignoreEvent:!0})}return v},e.prototype.getFigures=function(t,n,o,r,a,s,l,u,c,h){var d,p;return(p=(d=t.createYAxisFigures)===null||d===void 0?void 0:d.call(t,{overlay:t,coordinates:n,bounding:o,barSpace:r,precision:a,thousandsSeparator:s,dateTimeFormat:l,defaultStyles:u,xAxis:c,yAxis:h}))!==null&&p!==void 0?p:[]},e}(bo),Do=function(i){function e(){return i!==null&&i.apply(this,arguments)||this}return N(e,i),e.prototype.drawImp=function(t){var n,o=this.getWidget(),r=o.getPane(),a=o.getBounding(),s=o.getPane().getChart().getChartStore(),l=s.getTooltipStore().getCrosshair(),u=s.getStyles().crosshair;if(l.paneId!==void 0&&this.compare(l,r.getId())&&u.show){var c=this.getDirectionStyles(u),h=c.text;if(c.show&&h.show){var d=r.getAxisComponent(),p=this.getText(l,s,d);t.font=ke(h.size,h.weight,h.family),(n=this.createFigure("text",this.getTextAttrs(p,t.measureText(p).width,l,a,d,h),h))===null||n===void 0||n.draw(t)}}},e.prototype.compare=function(t,n){return t.paneId===n},e.prototype.getDirectionStyles=function(t){return t.horizontal},e.prototype.getText=function(t,n,o){var r,a,s,l=o,u=o.convertFromPixel(t.y);if(l.getType()===g.YAxisType.Percentage){var c=(a=(r=n.getVisibleDataList()[0])===null||r===void 0?void 0:r.data)!==null&&a!==void 0?a:{};s="".concat(((u-c.close)/c.close*100).toFixed(2),"%")}else{var h=n.getIndicatorStore().getInstances(t.paneId),d=0,p=!1;l.isInCandle()?d=n.getPrecision().price:h.forEach(function(v){d=Math.max(v.precision,d),p||(p=v.shouldFormatBigNumber)}),s=G(u,d),p&&(s=n.getCustomApi().formatBigNumber(s))}return J(s,n.getThousandsSeparator())},e.prototype.getTextAttrs=function(t,n,o,r,a,s){var l,u;return a.isFromZero()?(l=0,u="left"):(l=r.width,u="right"),{x:l,y:o.y,text:t,align:u,baseline:"middle"}},e}(Ce),Xn=function(i){function e(t,n){var o=i.call(this,t,n)||this;return o._yAxisView=new Wn(o),o._candleLastPriceLabelView=new Yn(o),o._indicatorLastValueView=new Hn(o),o._overlayYAxisView=new To(o),o._crosshairHorizontalLabelView=new Do(o),o.getContainer().style.cursor="ns-resize",o.addChild(o._overlayYAxisView),o}return N(e,i),e.prototype.getName=function(){return xe},e.prototype.updateMain=function(t){this._yAxisView.draw(t),this.getPane().getAxisComponent().isInCandle()&&this._candleLastPriceLabelView.draw(t),this._indicatorLastValueView.draw(t)},e.prototype.updateOverlay=function(t){this._overlayYAxisView.draw(t),this._crosshairHorizontalLabelView.draw(t)},e}(Dt),Fo=function(){function i(e){this._extremum={min:0,max:0,range:0,realMin:0,realMax:0,realRange:0},this._prevExtremum={min:0,max:0,range:0,realMin:0,realMax:0,realRange:0},this._ticks=[],this._autoCalcTickFlag=!0,this._parent=e}return i.prototype.getParent=function(){return this._parent},i.prototype.buildTicks=function(e){return this._autoCalcTickFlag&&(this._extremum=this.calcExtremum()),!(this._prevExtremum.min===this._extremum.min&&this._prevExtremum.max===this._extremum.max&&!e)&&(this._prevExtremum=this._extremum,this._ticks=this.optimalTicks(this._calcTicks()),!0)},i.prototype.getTicks=function(){return this._ticks},i.prototype.getScrollZoomEnabled=function(){var e;return(e=this.getParent().getOptions().axisOptions.scrollZoomEnabled)===null||e===void 0||e},i.prototype.setExtremum=function(e){this._autoCalcTickFlag=!1,this._extremum=e},i.prototype.getExtremum=function(){return this._extremum},i.prototype.setAutoCalcTickFlag=function(e){this._autoCalcTickFlag=e},i.prototype.getAutoCalcTickFlag=function(){return this._autoCalcTickFlag},i.prototype._calcTicks=function(){var e=this._extremum,t=e.realMin,n=e.realMax,o=e.realRange,r=[];if(o>=0){var a=ee(this._calcTickInterval(o),2),s=a[0],l=a[1],u=Ut(Math.ceil(t/s)*s,l),c=Ut(Math.floor(n/s)*s,l),h=0,d=u;if(s!==0)for(;c>=d;){var p=d.toFixed(l);r[h]={text:p,coord:0,value:p},++h,d+=s}}return r},i.prototype._calcTickInterval=function(e){var t,n,o,r,a=(n=Math.floor(je(t=e/8)),o=Pe(n),t=(1.5>(r=t/o)?1:2.5>r?2:3.5>r?3:4.5>r?4:5.5>r?5:6.5>r?6:8)*o,-20>n?t:+t.toFixed(0>n?-n:0)),s=function(l){var u=""+l,c=u.indexOf("e");if(c>0){var h=+u.slice(c+1);return 0>h?-h:0}var d=u.indexOf(".");return 0>d?0:u.length-1-d}(a);return[a,s]},i}(),qn=function(i){function e(){return i!==null&&i.apply(this,arguments)||this}return N(e,i),e.prototype.calcExtremum=function(){var t,n,o,r,a,s=this.getParent(),l=s.getChart(),u=l.getChartStore(),c=Number.MAX_SAFE_INTEGER,h=Number.MIN_SAFE_INTEGER,d=[],p=!1,v=Number.MAX_SAFE_INTEGER,f=Number.MIN_SAFE_INTEGER,y=Number.MAX_SAFE_INTEGER;u.getIndicatorStore().getInstances(s.getId()).forEach(function(H){var $,ie,ue;p||(p=($=H.shouldOhlc)!==null&&$!==void 0&&$),y=Math.min(y,H.precision),H.minValue!==null&&(v=Math.min(v,H.minValue)),H.maxValue!==null&&(f=Math.max(f,H.maxValue)),d.push({figures:(ie=H.figures)!==null&&ie!==void 0?ie:[],result:(ue=H.result)!==null&&ue!==void 0?ue:[]})});var m=4,_=this.isInCandle();if(_){var x=u.getPrecision().price;m=y!==Number.MAX_SAFE_INTEGER?Math.min(y,x):x}else y!==Number.MAX_SAFE_INTEGER&&(m=y);var C=u.getVisibleDataList(),S=l.getStyles().candle,E=S.type===g.CandleType.Area,b=S.area.value,T=_&&!E||!_&&p;C.forEach(function(H){var $=H.dataIndex,ie=H.data;if(T&&(c=Math.min(c,ie.low),h=Math.max(h,ie.high)),_&&E){var ue=ie[b];c=Math.min(c,ue),h=Math.max(h,ue)}d.forEach(function(Te){var ve,fe=(ve=Te.result[$])!==null&&ve!==void 0?ve:{};Te.figures.forEach(function(De){var Se=fe[De.key];Y(Se)&&(c=Math.min(c,Se),h=Math.max(h,Se))})})}),c!==Number.MAX_SAFE_INTEGER&&h!==Number.MIN_SAFE_INTEGER?(c=Math.min(v,c),h=Math.max(f,h)):(c=0,h=10);var D,A=this.getType();switch(A){case g.YAxisType.Percentage:var F=(t=C[0])===null||t===void 0?void 0:t.data;(F==null?void 0:F.close)!==void 0&&(c=(c-F.close)/F.close*100,h=(h-F.close)/F.close*100),D=.01;break;case g.YAxisType.Log:c=je(c),h=je(h),D=.05*Pe(-m);break;default:D=Pe(-m)}if(c===h||D>Math.abs(c-h)){var B=v===c,R=f===h;c=B?c:R?c-8*D:c-4*D,h=R?h:B?h+8*D:h+4*D}var z=(o=(n=this.getParent().getYAxisWidget())===null||n===void 0?void 0:n.getBounding().height)!==null&&o!==void 0?o:0,W=s.getOptions().gap,j=(r=W==null?void 0:W.top)!==null&&r!==void 0?r:.2;1>j||(j/=z);var X=(a=W==null?void 0:W.bottom)!==null&&a!==void 0?a:.1;1>X||(X/=z);var Q,ne,se,K=Math.abs(h-c);return K=Math.abs((h+=K*j)-(c-=K*X)),A===g.YAxisType.Log?(Q=Pe(c),ne=Pe(h),se=Math.abs(ne-Q)):(Q=c,ne=h,se=K),{min:c,max:h,range:K,realMin:Q,realMax:ne,realRange:se}},e.prototype._innerConvertToPixel=function(t){var n,o,r=(o=(n=this.getParent().getYAxisWidget())===null||n===void 0?void 0:n.getBounding().height)!==null&&o!==void 0?o:0,a=this.getExtremum(),s=(t-a.min)/a.range;return this.isReverse()?Math.round(s*r):Math.round((1-s)*r)},e.prototype.isInCandle=function(){return this.getParent().getName()==="candle"},e.prototype.getType=function(){return this.isInCandle()?this.getParent().getChart().getStyles().yAxis.type:g.YAxisType.Normal},e.prototype.getPosition=function(){return this.getParent().getChart().getStyles().yAxis.position},e.prototype.isReverse=function(){return!!this.isInCandle()&&this.getParent().getChart().getStyles().yAxis.reverse},e.prototype.isFromZero=function(){var t=this.getParent().getChart().getStyles().yAxis,n=t.inside;return t.position===g.YAxisPosition.Left&&n||t.position===g.YAxisPosition.Right&&!n},e.prototype.optimalTicks=function(t){var n,o,r=this,a=this.getParent(),s=(o=(n=a.getYAxisWidget())===null||n===void 0?void 0:n.getBounding().height)!==null&&o!==void 0?o:0,l=a.getChart().getChartStore(),u=l.getCustomApi(),c=[],h=this.getType(),d=l.getIndicatorStore().getInstances(a.getId()),p=l.getThousandsSeparator(),v=0,f=!1;this.isInCandle()?v=l.getPrecision().price:d.forEach(function(_){v=Math.max(v,_.precision),f||(f=_.shouldFormatBigNumber)});var y,m=l.getStyles().xAxis.tickText.size;return t.forEach(function(_){var x,C=_.value,S=r._innerConvertToPixel(+C);switch(h){case g.YAxisType.Percentage:x="".concat(G(C,2),"%");break;case g.YAxisType.Log:S=r._innerConvertToPixel(je(+C)),x=G(C,v);break;default:x=G(C,v),f&&(x=u.formatBigNumber(C))}x=J(x,p),S>m&&s-m>S&&(y!==void 0&&Math.abs(y-S)>2*m||y===void 0)&&(c.push({text:x,coord:S,value:C}),y=S)}),c},e.prototype.getAutoSize=function(){var t=this.getParent(),n=t.getChart(),o=n.getStyles(),r=o.yAxis,a=r.size;if(a!=="auto")return a;var s=n.getChartStore(),l=s.getCustomApi(),u=0;if(r.show&&(r.axisLine.show&&(u+=r.axisLine.size),r.tickLine.show&&(u+=r.tickLine.length),r.tickText.show)){var c=0;this.getTicks().forEach(function(C){c=Math.max(c,qe(C.text,r.tickText.size,r.tickText.weight,r.tickText.family))}),u+=r.tickText.marginStart+r.tickText.marginEnd+c}var h=o.crosshair,d=0;if(h.show&&h.horizontal.show&&h.horizontal.text.show){var p=s.getIndicatorStore().getInstances(t.getId()),v=0,f=!1;p.forEach(function(C){v=Math.max(C.precision,v),f||(f=C.shouldFormatBigNumber)});var y=2;if(this.getType()!==g.YAxisType.Percentage)if(this.isInCandle()){var m=s.getPrecision().price,_=o.indicator.lastValueMark;y=_.show&&_.text.show?Math.max(v,m):m}else y=v;var x=G(this.getExtremum().max,y);f&&(x=l.formatBigNumber(x)),d+=h.horizontal.text.paddingLeft+h.horizontal.text.paddingRight+2*h.horizontal.text.borderSize+qe(x,h.horizontal.text.size,h.horizontal.text.weight,h.horizontal.text.family)}return Math.max(u,d)},e.prototype.convertFromPixel=function(t){var n,o,r,a=(o=(n=this.getParent().getYAxisWidget())===null||n===void 0?void 0:n.getBounding().height)!==null&&o!==void 0?o:0,s=this.getExtremum(),l=s.min,u=s.range,c=(this.isReverse()?t/a:1-t/a)*u+l;switch(this.getType()){case g.YAxisType.Percentage:var h=(r=this.getParent().getChart().getChartStore().getVisibleDataList()[0])===null||r===void 0?void 0:r.data;return(h==null?void 0:h.close)!==void 0?h.close*c/100+h.close:0;case g.YAxisType.Log:return Pe(c);default:return c}},e.prototype.convertToRealValue=function(t){var n=t;return this.getType()===g.YAxisType.Log&&(n=Pe(t)),n},e.prototype.convertToPixel=function(t){var n,o=t;switch(this.getType()){case g.YAxisType.Percentage:var r=(n=this.getParent().getChart().getChartStore().getVisibleDataList()[0])===null||n===void 0?void 0:n.data;(r==null?void 0:r.close)!==void 0&&(o=(t-r.close)/r.close*100);break;case g.YAxisType.Log:o=je(t);break;default:o=t}return this._innerConvertToPixel(o)},e.prototype.convertToNicePixel=function(t){var n,o,r=(o=(n=this.getParent().getYAxisWidget())===null||n===void 0?void 0:n.getBounding().height)!==null&&o!==void 0?o:0,a=this.convertToPixel(t);return Math.round(Math.max(.05*r,Math.min(a,.98*r)))},e}(Fo),Ao=function(i){function e(){return i!==null&&i.apply(this,arguments)||this}return N(e,i),e.prototype.getName=function(){return"indicator"},e.prototype.createAxisComponent=function(){return new qn(this)},e.prototype.createMainWidget=function(t){return new Eo(t,this)},e.prototype.createSeparatorWidget=function(t){return new bn(t,this)},e.prototype.createYAxisWidget=function(t){return new Xn(t,this)},e}(ao),jn=function(i){function e(){return i!==null&&i.apply(this,arguments)||this}return N(e,i),e.prototype.getName=function(){return"candle"},e.prototype.createMainWidget=function(t){return new Nn(t,this)},e.prototype.createSeparatorWidget=function(){return null},e}(Ao),Kn=function(i){function e(){return i!==null&&i.apply(this,arguments)||this}return N(e,i),e.prototype.getAxisStyles=function(t){return t.xAxis},e.prototype.createAxisLine=function(t,n){var o=n.axisLine.size/2;return{coordinates:[{x:0,y:o},{x:t.width,y:o}]}},e.prototype.createTickLines=function(t,n,o){var r=o.tickLine,a=o.axisLine.size;return t.map(function(s){return{coordinates:[{x:s.coord,y:0},{x:s.coord,y:a+r.length}]}})},e.prototype.createTickTexts=function(t,n,o){var r=o.tickText,a=o.axisLine.size,s=o.tickLine.length;return t.map(function(l){return{x:l.coord,y:a+s+r.marginStart,text:l.text,align:"center",baseline:"top"}})},e}(wo),Un=function(i){function e(){return i!==null&&i.apply(this,arguments)||this}return N(e,i),e.prototype.coordinateToPointTimestampDataIndexFlag=function(){return!0},e.prototype.coordinateToPointValueFlag=function(){return!1},e.prototype.getCompleteOverlays=function(t){return t.getInstances()},e.prototype.getProgressOverlay=function(t){return t.instance},e.prototype.getDefaultFigures=function(t,n,o,r,a,s,l,u,c,h){var d,p=[];if(t.needDefaultXAxisFigure&&t.id===((d=h.instance)===null||d===void 0?void 0:d.id)){var v=Number.MAX_SAFE_INTEGER,f=Number.MIN_SAFE_INTEGER;n.forEach(function(y,m){v=Math.min(v,y.x),f=Math.max(f,y.x);var _=t.points[m];if(_.timestamp!==void 0){var x=s.formatDate(a,_.timestamp,"YYYY-MM-DD HH:mm",g.FormatDateType.Crosshair);p.push({type:"text",attrs:{x:y.x,y:0,text:x,align:"center"},ignoreEvent:!0})}}),n.length>1&&p.unshift({type:"rect",attrs:{x:v,y:0,width:f-v,height:o.height},ignoreEvent:!0})}return p},e.prototype.getFigures=function(t,n,o,r,a,s,l,u,c,h){var d,p;return(p=(d=t.createXAxisFigures)===null||d===void 0?void 0:d.call(t,{overlay:t,coordinates:n,bounding:o,barSpace:r,precision:a,thousandsSeparator:s,dateTimeFormat:l,defaultStyles:u,xAxis:c,yAxis:h}))!==null&&p!==void 0?p:[]},e}(To),Zn=function(i){function e(){return i!==null&&i.apply(this,arguments)||this}return N(e,i),e.prototype.compare=function(t){return t.kLineData!==void 0&&t.dataIndex===t.realDataIndex},e.prototype.getDirectionStyles=function(t){return t.vertical},e.prototype.getText=function(t,n){var o,r=(o=t.kLineData)===null||o===void 0?void 0:o.timestamp;return n.getCustomApi().formatDate(n.getTimeScaleStore().getDateTimeFormat(),r,"YYYY-MM-DD HH:mm",g.FormatDateType.Crosshair)},e.prototype.getTextAttrs=function(t,n,o,r,a,s){var l,u=o.realX,c="center";return 0>u-n/2-s.paddingLeft?(l=0,c="left"):u+n/2+s.paddingRight>r.width?(l=r.width,c="right"):l=u,{x:l,y:0,text:t,align:c,baseline:"top"}},e}(Do),Gn=function(i){function e(t,n){var o=i.call(this,t,n)||this;return o._xAxisView=new Kn(o),o._overlayXAxisView=new Un(o),o._crosshairVerticalLabelView=new Zn(o),o.getContainer().style.cursor="ew-resize",o.addChild(o._overlayXAxisView),o}return N(e,i),e.prototype.getName=function(){return _e},e.prototype.updateMain=function(t){this._xAxisView.draw(t)},e.prototype.updateOverlay=function(t){this._overlayXAxisView.draw(t),this._crosshairVerticalLabelView.draw(t)},e}(Dt),$n=function(i){function e(){return i!==null&&i.apply(this,arguments)||this}return N(e,i),e.prototype.calcExtremum=function(){var t=this.getParent().getChart().getChartStore().getTimeScaleStore().getVisibleRange(),n=t.from,o=t.to,r=o-1,a=o-n;return{min:n,max:r,range:a,realMin:n,realMax:r,realRange:a}},e.prototype.optimalTicks=function(t){var n,o,r=this.getParent().getChart(),a=r.getChartStore(),s=a.getCustomApi().formatDate,l=[],u=t.length,c=a.getDataList();if(u>0){var h=a.getTimeScaleStore().getDateTimeFormat(),d=r.getStyles().xAxis.tickText,p=qe("00-00 00:00",d.size,d.weight,d.family),v=this.convertToPixel(parseInt(t[0].value,10)),f=1;if(u>1){var y=this.convertToPixel(parseInt(t[1].value,10)),m=Math.abs(y-v);p>m&&(f=Math.ceil(p/m))}for(var _=0;u>_;_+=f){var x=parseInt(t[_].value,10),C=c[x].timestamp,S=s(h,C,"HH:mm",g.FormatDateType.XAxis);_!==0&&(S=(n=this._optimalTickLabel(s,h,C,c[parseInt(t[_-f].value,10)].timestamp))!==null&&n!==void 0?n:S);var E=this.convertToPixel(x);l.push({text:S,coord:E,value:C})}if(l.length===1)l[0].text=s(h,l[0].value,"YYYY-MM-DD HH:mm",g.FormatDateType.XAxis);else{var b=l[0].value,T=l[1].value;if(l[2]!==void 0){var D=l[2].text;/^[0-9]{2}-[0-9]{2}$/.test(D)?l[0].text=s(h,b,"MM-DD",g.FormatDateType.XAxis):/^[0-9]{4}-[0-9]{2}$/.test(D)?l[0].text=s(h,b,"YYYY-MM",g.FormatDateType.XAxis):/^[0-9]{4}$/.test(D)&&(l[0].text=s(h,b,"YYYY",g.FormatDateType.XAxis))}else l[0].text=(o=this._optimalTickLabel(s,h,b,T))!==null&&o!==void 0?o:l[0].text}}return l},e.prototype._optimalTickLabel=function(t,n,o,r){var a=t(n,o,"YYYY",g.FormatDateType.XAxis),s=t(n,o,"YYYY-MM",g.FormatDateType.XAxis),l=t(n,o,"MM-DD",g.FormatDateType.XAxis);return a!==t(n,r,"YYYY",g.FormatDateType.XAxis)?a:s!==t(n,r,"YYYY-MM",g.FormatDateType.XAxis)?s:l!==t(n,r,"MM-DD",g.FormatDateType.XAxis)?l:null},e.prototype.getAutoSize=function(){var t=this.getParent().getChart().getStyles(),n=t.xAxis,o=n.size;if(o!=="auto")return o;var r=t.crosshair,a=0;n.show&&(n.axisLine.show&&(a+=n.axisLine.size),n.tickLine.show&&(a+=n.tickLine.length),n.tickText.show&&(a+=n.tickText.marginStart+n.tickText.marginEnd+n.tickText.size));var s=0;return r.show&&r.vertical.show&&r.vertical.text.show&&(s+=r.vertical.text.paddingTop+r.vertical.text.paddingBottom+2*r.vertical.text.borderSize+r.vertical.text.size),Math.max(a,s)},e.prototype.convertTimestampFromPixel=function(t){var n=this.getParent().getChart().getChartStore().getTimeScaleStore(),o=n.coordinateToDataIndex(t);return n.dataIndexToTimestamp(o)},e.prototype.convertTimestampToPixel=function(t){var n=this.getParent().getChart().getChartStore().getTimeScaleStore(),o=n.timestampToDataIndex(t);return n.dataIndexToCoordinate(o)},e.prototype.convertFromPixel=function(t){return this.getParent().getChart().getChartStore().getTimeScaleStore().coordinateToDataIndex(t)},e.prototype.convertToPixel=function(t){return this.getParent().getChart().getChartStore().getTimeScaleStore().dataIndexToCoordinate(t)},e}(Fo),Jn=function(i){function e(){return i!==null&&i.apply(this,arguments)||this}return N(e,i),e.prototype.getName=function(){return"xAxis"},e.prototype.createAxisComponent=function(){return new $n(this)},e.prototype.createMainWidget=function(t){return new Gn(t,this)},e}(ao);function Io(){var i;return typeof window<"u"&&((i=window.navigator.userAgent.toLowerCase().indexOf("firefox"))!==null&&i!==void 0?i:-1)>-1}function kt(){return typeof window<"u"&&/iPhone|iPad|iPod/.test(window.navigator.platform)}var Pt,Qn=function(){function i(e,t,n){var o=this;this._clickCount=0,this._clickTimeoutId=null,this._clickCoordinate={x:-1/0,y:1/0},this._tapCount=0,this._tapTimeoutId=null,this._tapCoordinate={x:-1/0,y:1/0},this._longTapTimeoutId=null,this._longTapActive=!1,this._mouseMoveStartCoordinate=null,this._touchMoveStartCoordinate=null,this._touchMoveExceededManhattanDistance=!1,this._cancelClick=!1,this._cancelTap=!1,this._unsubscribeOutsideMouseEvents=null,this._unsubscribeOutsideTouchEvents=null,this._unsubscribeMobileSafariEvents=null,this._unsubscribeMousemove=null,this._unsubscribeMouseWheel=null,this._unsubscribeContextMenu=null,this._unsubscribeRootMouseEvents=null,this._unsubscribeRootTouchEvents=null,this._startPinchMiddleCoordinate=null,this._startPinchDistance=0,this._pinchPrevented=!1,this._preventTouchDragProcess=!1,this._mousePressed=!1,this._lastTouchEventTimeStamp=0,this._activeTouchId=null,this._acceptMouseLeave=!kt(),this._onFirefoxOutsideMouseUp=function(r){o._mouseUpHandler(r)},this._onMobileSafariDoubleClick=function(r){o._firesTouchEvents(r)?(++o._tapCount,o._tapTimeoutId!==null&&o._tapCount>1&&(30>o._mouseTouchMoveWithDownInfo(o._getCoordinate(r),o._tapCoordinate).manhattanDistance&&!o._cancelTap&&o._processEvent(o._makeCompatEvent(r),o._handler.doubleTapEvent),o._resetTapTimeout())):(++o._clickCount,o._clickTimeoutId!==null&&o._clickCount>1&&(5>o._mouseTouchMoveWithDownInfo(o._getCoordinate(r),o._clickCoordinate).manhattanDistance&&!o._cancelClick&&o._processEvent(o._makeCompatEvent(r),o._handler.mouseDoubleClickEvent),o._resetClickTimeout()))},this._target=e,this._handler=t,this._options=n,this._init()}return i.prototype.destroy=function(){this._unsubscribeOutsideMouseEvents!==null&&(this._unsubscribeOutsideMouseEvents(),this._unsubscribeOutsideMouseEvents=null),this._unsubscribeOutsideTouchEvents!==null&&(this._unsubscribeOutsideTouchEvents(),this._unsubscribeOutsideTouchEvents=null),this._unsubscribeMousemove!==null&&(this._unsubscribeMousemove(),this._unsubscribeMousemove=null),this._unsubscribeMouseWheel!==null&&(this._unsubscribeMouseWheel(),this._unsubscribeMouseWheel=null),this._unsubscribeContextMenu!==null&&(this._unsubscribeContextMenu(),this._unsubscribeContextMenu=null),this._unsubscribeRootMouseEvents!==null&&(this._unsubscribeRootMouseEvents(),this._unsubscribeRootMouseEvents=null),this._unsubscribeRootTouchEvents!==null&&(this._unsubscribeRootTouchEvents(),this._unsubscribeRootTouchEvents=null),this._unsubscribeMobileSafariEvents!==null&&(this._unsubscribeMobileSafariEvents(),this._unsubscribeMobileSafariEvents=null),this._clearLongTapTimeout(),this._resetClickTimeout()},i.prototype._mouseEnterHandler=function(e){var t,n,o,r=this;(t=this._unsubscribeMousemove)===null||t===void 0||t.call(this),(n=this._unsubscribeMouseWheel)===null||n===void 0||n.call(this),(o=this._unsubscribeContextMenu)===null||o===void 0||o.call(this);var a=this._mouseMoveHandler.bind(this);this._unsubscribeMousemove=function(){r._target.removeEventListener("mousemove",a)},this._target.addEventListener("mousemove",a);var s=this._mouseWheelHandler.bind(this);this._unsubscribeMouseWheel=function(){r._target.removeEventListener("wheel",s)},this._target.addEventListener("wheel",s,{passive:!1});var l=this._contextMenuHandler.bind(this);this._unsubscribeContextMenu=function(){r._target.removeEventListener("contextmenu",l)},this._target.addEventListener("contextmenu",l,{passive:!1}),this._firesTouchEvents(e)||(this._processEvent(this._makeCompatEvent(e),this._handler.mouseEnterEvent),this._acceptMouseLeave=!0)},i.prototype._resetClickTimeout=function(){this._clickTimeoutId!==null&&clearTimeout(this._clickTimeoutId),this._clickCount=0,this._clickTimeoutId=null,this._clickCoordinate={x:-1/0,y:1/0}},i.prototype._resetTapTimeout=function(){this._tapTimeoutId!==null&&clearTimeout(this._tapTimeoutId),this._tapCount=0,this._tapTimeoutId=null,this._tapCoordinate={x:-1/0,y:1/0}},i.prototype._mouseMoveHandler=function(e){this._mousePressed||this._touchMoveStartCoordinate!==null||this._firesTouchEvents(e)||(this._processEvent(this._makeCompatEvent(e),this._handler.mouseMoveEvent),this._acceptMouseLeave=!0)},i.prototype._mouseWheelHandler=function(e){if(Math.abs(e.deltaX)>Math.abs(e.deltaY)){if(this._handler.mouseWheelHortEvent===void 0||(this._preventDefault(e),Math.abs(e.deltaX)===0))return;this._handler.mouseWheelHortEvent(this._makeCompatEvent(e),-e.deltaX)}else{if(this._handler.mouseWheelVertEvent===void 0)return;var t=-e.deltaY/100;if(t===0)return;switch(this._preventDefault(e),e.deltaMode){case e.DOM_DELTA_PAGE:t*=120;break;case e.DOM_DELTA_LINE:t*=32}if(t!==0){var n=Math.sign(t)*Math.min(1,Math.abs(t));this._handler.mouseWheelVertEvent(this._makeCompatEvent(e),n)}}},i.prototype._contextMenuHandler=function(e){this._preventDefault(e)},i.prototype._touchMoveHandler=function(e){var t=this._touchWithId(e.changedTouches,this._activeTouchId);if(t!==null&&(this._lastTouchEventTimeStamp=this._eventTimeStamp(e),this._startPinchMiddleCoordinate===null&&!this._preventTouchDragProcess)){this._pinchPrevented=!0;var n=this._mouseTouchMoveWithDownInfo(this._getCoordinate(t),this._touchMoveStartCoordinate),o=n.yOffset;if(this._touchMoveExceededManhattanDistance||n.manhattanDistance>=5){if(!this._touchMoveExceededManhattanDistance){var r=.5*n.xOffset,a=o>=r&&!this._options.treatVertDragAsPageScroll(),s=r>o&&!this._options.treatHorzDragAsPageScroll();a||s||(this._preventTouchDragProcess=!0),this._touchMoveExceededManhattanDistance=!0,this._cancelTap=!0,this._clearLongTapTimeout(),this._resetTapTimeout()}this._preventTouchDragProcess||this._processEvent(this._makeCompatEvent(e,t),this._handler.touchMoveEvent)}}},i.prototype._mouseMoveWithDownHandler=function(e){e.button===0&&(5>this._mouseTouchMoveWithDownInfo(this._getCoordinate(e),this._mouseMoveStartCoordinate).manhattanDistance||(this._cancelClick=!0,this._resetClickTimeout()),this._cancelClick&&this._processEvent(this._makeCompatEvent(e),this._handler.pressedMouseMoveEvent))},i.prototype._mouseTouchMoveWithDownInfo=function(e,t){var n=Math.abs(t.x-e.x),o=Math.abs(t.y-e.y);return{xOffset:n,yOffset:o,manhattanDistance:n+o}},i.prototype._touchEndHandler=function(e){var t=this._touchWithId(e.changedTouches,this._activeTouchId);if(t===null&&e.touches.length===0&&(t=e.changedTouches[0]),t!==null){this._activeTouchId=null,this._lastTouchEventTimeStamp=this._eventTimeStamp(e),this._clearLongTapTimeout(),this._touchMoveStartCoordinate=null,this._unsubscribeRootTouchEvents!==null&&(this._unsubscribeRootTouchEvents(),this._unsubscribeRootTouchEvents=null);var n=this._makeCompatEvent(e,t);this._processEvent(n,this._handler.touchEndEvent),++this._tapCount,this._tapTimeoutId!==null&&this._tapCount>1?(30>this._mouseTouchMoveWithDownInfo(this._getCoordinate(t),this._tapCoordinate).manhattanDistance&&!this._cancelTap&&this._processEvent(n,this._handler.doubleTapEvent),this._resetTapTimeout()):this._cancelTap||(this._processEvent(n,this._handler.tapEvent),this._handler.tapEvent!==void 0&&this._preventDefault(e)),this._tapCount===0&&this._preventDefault(e),e.touches.length===0&&this._longTapActive&&(this._longTapActive=!1,this._preventDefault(e))}},i.prototype._mouseUpHandler=function(e){if(e.button===0){var t=this._makeCompatEvent(e);this._mouseMoveStartCoordinate=null,this._mousePressed=!1,this._unsubscribeRootMouseEvents!==null&&(this._unsubscribeRootMouseEvents(),this._unsubscribeRootMouseEvents=null),Io()&&this._target.ownerDocument.documentElement.removeEventListener("mouseleave",this._onFirefoxOutsideMouseUp),this._firesTouchEvents(e)||(this._processEvent(t,this._handler.mouseUpEvent),++this._clickCount,this._clickTimeoutId!==null&&this._clickCount>1?(5>this._mouseTouchMoveWithDownInfo(this._getCoordinate(e),this._clickCoordinate).manhattanDistance&&!this._cancelClick&&this._processEvent(t,this._handler.mouseDoubleClickEvent),this._resetClickTimeout()):this._cancelClick||this._processEvent(t,this._handler.mouseClickEvent))}},i.prototype._clearLongTapTimeout=function(){this._longTapTimeoutId!==null&&(clearTimeout(this._longTapTimeoutId),this._longTapTimeoutId=null)},i.prototype._touchStartHandler=function(e){if(this._activeTouchId===null){var t=e.changedTouches[0];this._activeTouchId=t.identifier,this._lastTouchEventTimeStamp=this._eventTimeStamp(e);var n=this._target.ownerDocument.documentElement;this._cancelTap=!1,this._touchMoveExceededManhattanDistance=!1,this._preventTouchDragProcess=!1,this._touchMoveStartCoordinate=this._getCoordinate(t),this._unsubscribeRootTouchEvents!==null&&(this._unsubscribeRootTouchEvents(),this._unsubscribeRootTouchEvents=null);var o=this._touchMoveHandler.bind(this),r=this._touchEndHandler.bind(this);this._unsubscribeRootTouchEvents=function(){n.removeEventListener("touchmove",o),n.removeEventListener("touchend",r)},n.addEventListener("touchmove",o,{passive:!1}),n.addEventListener("touchend",r,{passive:!1}),this._clearLongTapTimeout(),this._longTapTimeoutId=setTimeout(this._longTapHandler.bind(this,e),500),this._processEvent(this._makeCompatEvent(e,t),this._handler.touchStartEvent),this._tapTimeoutId===null&&(this._tapCount=0,this._tapTimeoutId=setTimeout(this._resetTapTimeout.bind(this),500),this._tapCoordinate=this._getCoordinate(t))}},i.prototype._mouseDownHandler=function(e){if(e.button===2)return this._preventDefault(e),void this._processEvent(this._makeCompatEvent(e),this._handler.mouseRightClickEvent);if(e.button===0){var t=this._target.ownerDocument.documentElement;Io()&&t.addEventListener("mouseleave",this._onFirefoxOutsideMouseUp),this._cancelClick=!1,this._mouseMoveStartCoordinate=this._getCoordinate(e),this._unsubscribeRootMouseEvents!==null&&(this._unsubscribeRootMouseEvents(),this._unsubscribeRootMouseEvents=null);var n=this._mouseMoveWithDownHandler.bind(this),o=this._mouseUpHandler.bind(this);this._unsubscribeRootMouseEvents=function(){t.removeEventListener("mousemove",n),t.removeEventListener("mouseup",o)},t.addEventListener("mousemove",n),t.addEventListener("mouseup",o),this._mousePressed=!0,this._firesTouchEvents(e)||(this._processEvent(this._makeCompatEvent(e),this._handler.mouseDownEvent),this._clickTimeoutId===null&&(this._clickCount=0,this._clickTimeoutId=setTimeout(this._resetClickTimeout.bind(this),500),this._clickCoordinate=this._getCoordinate(e)))}},i.prototype._init=function(){var e=this;this._target.addEventListener("mouseenter",this._mouseEnterHandler.bind(this)),this._target.addEventListener("touchcancel",this._clearLongTapTimeout.bind(this));var t=this._target.ownerDocument,n=function(o){e._handler.mouseDownOutsideEvent!=null&&(o.composed&&e._target.contains(o.composedPath()[0])||o.target!==null&&e._target.contains(o.target)||e._handler.mouseDownOutsideEvent({x:0,y:0,pageX:0,pageY:0}))};this._unsubscribeOutsideTouchEvents=function(){t.removeEventListener("touchstart",n)},this._unsubscribeOutsideMouseEvents=function(){t.removeEventListener("mousedown",n)},t.addEventListener("mousedown",n),t.addEventListener("touchstart",n,{passive:!0}),kt()&&(this._unsubscribeMobileSafariEvents=function(){e._target.removeEventListener("dblclick",e._onMobileSafariDoubleClick)},this._target.addEventListener("dblclick",this._onMobileSafariDoubleClick)),this._target.addEventListener("mouseleave",this._mouseLeaveHandler.bind(this)),this._target.addEventListener("touchstart",this._touchStartHandler.bind(this),{passive:!0}),this._target.addEventListener("mousedown",function(o){if(o.button===1)return o.preventDefault(),!1}),this._target.addEventListener("mousedown",this._mouseDownHandler.bind(this)),this._initPinch(),this._target.addEventListener("touchmove",function(){},{passive:!1})},i.prototype._initPinch=function(){var e=this;this._handler.pinchStartEvent===void 0&&this._handler.pinchEvent===void 0&&this._handler.pinchEndEvent===void 0||(this._target.addEventListener("touchstart",function(t){return e._checkPinchState(t.touches)},{passive:!0}),this._target.addEventListener("touchmove",function(t){if(t.touches.length===2&&e._startPinchMiddleCoordinate!==null&&e._handler.pinchEvent!==void 0){var n=e._getTouchDistance(t.touches[0],t.touches[1])/e._startPinchDistance;e._handler.pinchEvent(k(k({},e._startPinchMiddleCoordinate),{pageX:0,pageY:0}),n),e._preventDefault(t)}},{passive:!1}),this._target.addEventListener("touchend",function(t){e._checkPinchState(t.touches)}))},i.prototype._checkPinchState=function(e){e.length===1&&(this._pinchPrevented=!1),e.length!==2||this._pinchPrevented||this._longTapActive?this._stopPinch():this._startPinch(e)},i.prototype._startPinch=function(e){var t,n=(t=this._target.getBoundingClientRect())!==null&&t!==void 0?t:{left:0,top:0};this._startPinchMiddleCoordinate={x:(e[0].clientX-n.left+(e[1].clientX-n.left))/2,y:(e[0].clientY-n.top+(e[1].clientY-n.top))/2},this._startPinchDistance=this._getTouchDistance(e[0],e[1]),this._handler.pinchStartEvent!==void 0&&this._handler.pinchStartEvent({x:0,y:0,pageX:0,pageY:0}),this._clearLongTapTimeout()},i.prototype._stopPinch=function(){this._startPinchMiddleCoordinate!==null&&(this._startPinchMiddleCoordinate=null,this._handler.pinchEndEvent!==void 0&&this._handler.pinchEndEvent({x:0,y:0,pageX:0,pageY:0}))},i.prototype._mouseLeaveHandler=function(e){var t,n,o;(t=this._unsubscribeMousemove)===null||t===void 0||t.call(this),(n=this._unsubscribeMouseWheel)===null||n===void 0||n.call(this),(o=this._unsubscribeContextMenu)===null||o===void 0||o.call(this),this._firesTouchEvents(e)||this._acceptMouseLeave&&(this._processEvent(this._makeCompatEvent(e),this._handler.mouseLeaveEvent),this._acceptMouseLeave=!kt())},i.prototype._longTapHandler=function(e){var t=this._touchWithId(e.touches,this._activeTouchId);t!==null&&(this._processEvent(this._makeCompatEvent(e,t),this._handler.longTapEvent),this._cancelTap=!0,this._longTapActive=!0)},i.prototype._firesTouchEvents=function(e){var t;return((t=e.sourceCapabilities)===null||t===void 0?void 0:t.firesTouchEvents)!==void 0?e.sourceCapabilities.firesTouchEvents:this._eventTimeStamp(e)<this._lastTouchEventTimeStamp+500},i.prototype._processEvent=function(e,t){t==null||t.call(this._handler,e)},i.prototype._makeCompatEvent=function(e,t){var n,o=this,r=t??e,a=(n=this._target.getBoundingClientRect())!==null&&n!==void 0?n:{left:0,top:0};return{x:r.clientX-a.left,y:r.clientY-a.top,pageX:r.pageX,pageY:r.pageY,isTouch:!e.type.startsWith("mouse")&&e.type!=="contextmenu"&&e.type!=="click",preventDefault:function(){e.type!=="touchstart"&&o._preventDefault(e)}}},i.prototype._getTouchDistance=function(e,t){var n=e.clientX-t.clientX,o=e.clientY-t.clientY;return Math.sqrt(n*n+o*o)},i.prototype._preventDefault=function(e){e.cancelable&&e.preventDefault()},i.prototype._getCoordinate=function(e){return{x:e.pageX,y:e.pageY}},i.prototype._eventTimeStamp=function(e){var t;return(t=e.timeStamp)!==null&&t!==void 0?t:performance.now()},i.prototype._touchWithId=function(e,t){for(var n=0;e.length>n;++n)if(e[n].identifier===t)return e[n];return null},i}(),ei=function(){function i(e,t){var n=this;this._flingStartTime=new Date().getTime(),this._flingScrollRequestId=null,this._startScrollCoordinate=null,this._touchCoordinate=null,this._touchCancelCrosshair=!1,this._touchZoomed=!1,this._pinchScale=1,this._mouseDownWidget=null,this._prevYAxisExtremum=null,this._xAxisStartScaleCoordinate=null,this._xAxisStartScaleDistance=0,this._xAxisScale=1,this._yAxisStartScaleDistance=0,this._mouseMoveTriggerWidgetInfo={pane:null,widget:null},this._boundKeyBoardDownEvent=function(o){if(o.shiftKey)switch(o.code){case"Equal":n._chart.getChartStore().getTimeScaleStore().zoom(.5);break;case"Minus":n._chart.getChartStore().getTimeScaleStore().zoom(-.5);break;case"ArrowLeft":(r=n._chart.getChartStore().getTimeScaleStore()).startScroll(),r.scroll(-3*r.getBarSpace().bar);break;case"ArrowRight":var r;(r=n._chart.getChartStore().getTimeScaleStore()).startScroll(),r.scroll(3*r.getBarSpace().bar)}},this._container=e,this._chart=t,this._event=new Qn(e,this,{treatVertDragAsPageScroll:function(){return!1},treatHorzDragAsPageScroll:function(){return!1}}),e.addEventListener("keydown",this._boundKeyBoardDownEvent)}return i.prototype.pinchStartEvent=function(){return this._touchZoomed=!0,this._pinchScale=1,!0},i.prototype.pinchEvent=function(e,t){var n=this._findWidgetByEvent(e),o=n.pane,r=n.widget;if((o==null?void 0:o.getId())!==ae&&(r==null?void 0:r.getName())===te){var a=this._makeWidgetEvent(e,r),s=5*(t-this._pinchScale);return this._pinchScale=t,this._chart.getChartStore().getTimeScaleStore().zoom(s,{x:a.x,y:a.y}),!0}return!1},i.prototype.mouseWheelHortEvent=function(e,t){var n=this._chart.getChartStore().getTimeScaleStore();return n.startScroll(),n.scroll(t),!0},i.prototype.mouseWheelVertEvent=function(e,t){var n,o,r=this._findWidgetByEvent(e).widget,a=(n=e.isTouch)!==null&&n!==void 0&&n,s=this._makeWidgetEvent(e,r),l=null,u=r==null?void 0:r.getName();if(a)if(u===te||u===_e)l={x:s.x,y:s.y};else{var c=(o=this._chart.getPaneById(oe))===null||o===void 0?void 0:o.getBounding();l={x:c.width/2,y:c.height/2}}else u===te&&(l={x:s.x,y:s.y});return l!==null&&(this._chart.getChartStore().getTimeScaleStore().zoom(t,{x:s.x,y:s.y}),!0)},i.prototype.mouseDownEvent=function(e){var t,n,o=this._findWidgetByEvent(e),r=o.pane,a=o.widget;if(this._mouseDownWidget=a,a!==null){var s=this._makeWidgetEvent(e,a);switch(a.getName()){case Ze:return a.dispatchEvent("mouseDownEvent",s);case te:var l=(t=r==null?void 0:r.getAxisComponent().getExtremum())!==null&&t!==void 0?t:null;return this._prevYAxisExtremum=l===null?l:k({},l),this._startScrollCoordinate={x:s.x,y:s.y},this._chart.getChartStore().getTimeScaleStore().startScroll(),a.dispatchEvent("mouseDownEvent",s);case _e:return(u=a.dispatchEvent("mouseDownEvent",s))&&this._chart.updatePane(1),this._xAxisStartScaleCoordinate={x:s.x,y:s.y},this._xAxisStartScaleDistance=s.pageX,u;case xe:var u;return(u=a.dispatchEvent("mouseDownEvent",s))&&this._chart.updatePane(1),l=(n=r==null?void 0:r.getAxisComponent().getExtremum())!==null&&n!==void 0?n:null,this._prevYAxisExtremum=l===null?l:k({},l),this._yAxisStartScaleDistance=s.pageY,u}}return!1},i.prototype.mouseMoveEvent=function(e){var t,n,o,r=this._findWidgetByEvent(e),a=r.pane,s=r.widget,l=this._makeWidgetEvent(e,s);if(((t=this._mouseMoveTriggerWidgetInfo.pane)===null||t===void 0?void 0:t.getId())===(a==null?void 0:a.getId())&&((n=this._mouseMoveTriggerWidgetInfo.widget)===null||n===void 0?void 0:n.getName())===(s==null?void 0:s.getName())||(s==null||s.dispatchEvent("mouseEnterEvent",l),(o=this._mouseMoveTriggerWidgetInfo.widget)===null||o===void 0||o.dispatchEvent("mouseLeaveEvent",l),this._mouseMoveTriggerWidgetInfo={pane:a,widget:s}),s!==null)switch(s.getName()){case te:var u=s.dispatchEvent("mouseMoveEvent",l),c=this._chart.getChartStore(),h={x:l.x,y:l.y,paneId:a==null?void 0:a.getId()};return u&&c.getTooltipStore().getActiveIcon()!==null&&(h=void 0,s!==null&&(s.getContainer().style.cursor="pointer")),this._chart.getChartStore().getTooltipStore().setCrosshair(h),u;case Ze:case _e:case xe:return u=s.dispatchEvent("mouseMoveEvent",l),this._chart.getChartStore().getTooltipStore().setCrosshair(),u}return!1},i.prototype.pressedMouseMoveEvent=function(e){var t,n,o,r,a;if(this._mouseDownWidget!==null&&this._mouseDownWidget.getName()===Ze)return this._mouseDownWidget.dispatchEvent("pressedMouseMoveEvent",e);var s=this._findWidgetByEvent(e),l=s.pane,u=s.widget;if(u!==null&&((t=this._mouseDownWidget)===null||t===void 0?void 0:t.getPane().getId())===(l==null?void 0:l.getId())&&((n=this._mouseDownWidget)===null||n===void 0?void 0:n.getName())===u.getName()){var c=this._makeWidgetEvent(e,u);switch(u.getName()){case te:var h=u.getBounding();if(!(S=u.dispatchEvent("pressedMouseMoveEvent",c))&&this._startScrollCoordinate!==null){var d=l==null?void 0:l.getAxisComponent();if(this._prevYAxisExtremum!==null&&!d.getAutoCalcTickFlag()&&d.getScrollZoomEnabled()){var p=this._prevYAxisExtremum,v=p.min,f=p.max+(T=(E=p.range)*(b=((o=d==null?void 0:d.isReverse())!==null&&o!==void 0&&o?this._startScrollCoordinate.y-c.y:c.y-this._startScrollCoordinate.y)/h.height)),y=d.convertToRealValue(F=v+T),m=d.convertToRealValue(f);d.setExtremum({min:F,max:f,range:f-F,realMin:y,realMax:m,realRange:m-y})}var _=c.x-this._startScrollCoordinate.x;this._chart.getChartStore().getTimeScaleStore().scroll(_)}return this._chart.getChartStore().getTooltipStore().setCrosshair({x:c.x,y:c.y,paneId:l==null?void 0:l.getId()}),S;case _e:if(S=u.dispatchEvent("pressedMouseMoveEvent",c))this._chart.updatePane(1);else{var x=l==null?void 0:l.getAxisComponent();if((r=x==null?void 0:x.getScrollZoomEnabled())===null||r===void 0||r){var C=10*((b=this._xAxisStartScaleDistance/c.pageX)-this._xAxisScale);this._xAxisScale=b,this._chart.getChartStore().getTimeScaleStore().zoom(C,(a=this._xAxisStartScaleCoordinate)!==null&&a!==void 0?a:void 0)}}return S;case xe:var S;if(S=u.dispatchEvent("pressedMouseMoveEvent",c))this._chart.updatePane(1);else if(d=l==null?void 0:l.getAxisComponent(),this._prevYAxisExtremum!==null&&d.getScrollZoomEnabled()){var E,b,T,D=this._prevYAxisExtremum,A=(E=D.range)*(b=c.pageY/this._yAxisStartScaleDistance),F=(v=D.min)-(T=(A-E)/2),B=(f=D.max+T,l==null?void 0:l.getAxisComponent());y=B.convertToRealValue(F),m=B.convertToRealValue(f),B.setExtremum({min:F,max:f,range:A,realMin:y,realMax:m,realRange:m-y}),this._chart.adjustPaneViewport(!1,!0,!0,!0)}return S}}return!1},i.prototype.mouseUpEvent=function(e){var t=this._findWidgetByEvent(e).widget,n=!1;if(t!==null){var o=this._makeWidgetEvent(e,t);switch(t.getName()){case te:case Ze:case _e:case xe:n=t.dispatchEvent("mouseUpEvent",o)}n&&this._chart.updatePane(1)}return this._mouseDownWidget=null,this._startScrollCoordinate=null,this._prevYAxisExtremum=null,this._xAxisStartScaleCoordinate=null,this._xAxisStartScaleDistance=0,this._xAxisScale=1,this._yAxisStartScaleDistance=0,n},i.prototype.mouseClickEvent=function(e){var t=this._findWidgetByEvent(e).widget;if(t!==null){var n=this._makeWidgetEvent(e,t);return t.dispatchEvent("mouseClickEvent",n)}return!1},i.prototype.mouseRightClickEvent=function(e){var t=this._findWidgetByEvent(e).widget,n=!1;if(t!==null){var o=this._makeWidgetEvent(e,t);switch(t.getName()){case te:case _e:case xe:n=t.dispatchEvent("mouseRightClickEvent",o)}n&&this._chart.updatePane(1)}return!1},i.prototype.mouseDoubleClickEvent=function(e){var t=this._findWidgetByEvent(e),n=t.pane,o=t.widget;if(o!==null)switch(o.getName()){case te:var r=this._makeWidgetEvent(e,o);return o.dispatchEvent("mouseDoubleClickEvent",r);case xe:var a=n==null?void 0:n.getAxisComponent();if(!a.getAutoCalcTickFlag())return a.setAutoCalcTickFlag(!0),this._chart.adjustPaneViewport(!1,!0,!0,!0),!0}return!1},i.prototype.mouseLeaveEvent=function(){return this._chart.getChartStore().getTooltipStore().setCrosshair(),!0},i.prototype.touchStartEvent=function(e){var t=this._findWidgetByEvent(e),n=t.pane,o=t.widget;if(o!==null){var r=this._makeWidgetEvent(e,o);switch(o.getName()){case te:var a=this._chart.getChartStore(),s=a.getTooltipStore();if(o.dispatchEvent("mouseDownEvent",r))return this._touchCancelCrosshair=!0,this._touchCoordinate=null,s.setCrosshair(void 0,!0),this._chart.updatePane(1),!0;if(this._flingScrollRequestId!==null&&(rt(this._flingScrollRequestId),this._flingScrollRequestId=null),this._flingStartTime=new Date().getTime(),this._startScrollCoordinate={x:r.x,y:r.y},a.getTimeScaleStore().startScroll(),this._touchZoomed=!1,this._touchCoordinate!==null){var l=r.x-this._touchCoordinate.x,u=r.y-this._touchCoordinate.y;10>Math.sqrt(l*l+u*u)?(this._touchCoordinate={x:r.x,y:r.y},s.setCrosshair({x:r.x,y:r.y,paneId:n==null?void 0:n.getId()})):(this._touchCoordinate=null,this._touchCancelCrosshair=!0,s.setCrosshair())}return!0;case _e:case xe:var c=o.dispatchEvent("mouseDownEvent",r);return c&&this._chart.updatePane(1),c}}return!1},i.prototype.touchMoveEvent=function(e){var t,n,o,r=this._findWidgetByEvent(e),a=r.pane,s=r.widget;if(s!==null){var l=this._makeWidgetEvent(e,s),u=s.getName(),c=this._chart.getChartStore(),h=c.getTooltipStore();switch(u){case te:if(s.dispatchEvent("pressedMouseMoveEvent",l))return(t=l.preventDefault)===null||t===void 0||t.call(l),h.setCrosshair(void 0,!0),this._chart.updatePane(1),!0;if(this._touchCoordinate!==null)(n=l.preventDefault)===null||n===void 0||n.call(l),h.setCrosshair({x:l.x,y:l.y,paneId:a==null?void 0:a.getId()});else if(this._startScrollCoordinate!==null&&Math.abs(this._startScrollCoordinate.x-l.x)>this._startScrollCoordinate.y-l.y){var d=l.x-this._startScrollCoordinate.x;c.getTimeScaleStore().scroll(d)}return!0;case _e:case xe:var p=s.dispatchEvent("pressedMouseMoveEvent",l);return p&&((o=l.preventDefault)===null||o===void 0||o.call(l),this._chart.updatePane(1)),p}}return!1},i.prototype.touchEndEvent=function(e){var t=this,n=this._findWidgetByEvent(e).widget;if(n!==null){var o=this._makeWidgetEvent(e,n);switch(n.getName()){case te:if(n.dispatchEvent("mouseUpEvent",o),this._startScrollCoordinate!==null){var r=new Date().getTime()-this._flingStartTime,a=(o.x-this._startScrollCoordinate.x)/(r>0?r:1)*20;if(200>r&&Math.abs(a)>0){var s=this._chart.getChartStore().getTimeScaleStore(),l=function(){t._flingScrollRequestId=Tt(function(){s.startScroll(),s.scroll(a),1>Math.abs(a*=.975)?t._flingScrollRequestId!==null&&(rt(t._flingScrollRequestId),t._flingScrollRequestId=null):l()})};l()}}return!0;case _e:case xe:n.dispatchEvent("mouseUpEvent",o)&&this._chart.updatePane(1)}}return!1},i.prototype.tapEvent=function(e){var t=this._findWidgetByEvent(e),n=t.pane,o=t.widget,r=!1;if(o!==null){var a=this._makeWidgetEvent(e,o),s=o.dispatchEvent("mouseClickEvent",a);if(o.getName()===te){var l=this._makeWidgetEvent(e,o),u=this._chart.getChartStore().getTooltipStore();s?(this._touchCancelCrosshair=!0,this._touchCoordinate=null,u.setCrosshair(void 0,!0),r=!0):(this._touchCancelCrosshair||this._touchZoomed||(this._touchCoordinate={x:l.x,y:l.y},u.setCrosshair({x:l.x,y:l.y,paneId:n==null?void 0:n.getId()},!0),r=!0),this._touchCancelCrosshair=!1)}(r||s)&&this._chart.updatePane(1)}return r},i.prototype.doubleTapEvent=function(e){return this.mouseDoubleClickEvent(e)},i.prototype.longTapEvent=function(e){var t=this._findWidgetByEvent(e),n=t.pane,o=t.widget;if(o!==null&&o.getName()===te){var r=this._makeWidgetEvent(e,o);return this._touchCoordinate={x:r.x,y:r.y},this._chart.getChartStore().getTooltipStore().setCrosshair({x:r.x,y:r.y,paneId:n==null?void 0:n.getId()}),!0}return!1},i.prototype._findWidgetByEvent=function(e){var t,n,o=this._chart.getAllPanes(),r=e.x,a=e.y,s=null;try{for(var l=Xe(o),u=l.next();!u.done;u=l.next()){var c=ee(u.value,2)[1],h=c.getBounding();if(!(h.left>r||r>h.left+h.width||h.top>a||a>h.top+h.height)){s=c;break}}}catch(x){t={error:x}}finally{try{u&&!u.done&&(n=l.return)&&n.call(l)}finally{if(t)throw t.error}}s===null&&(s=this._chart.getPaneById(ae));var d=null;if(s!==null){var p=s.getSeparatorWidget();if(p!==null){var v=p.getBounding();v.left>r||r>v.left+v.width||v.top>a||a>v.top+7||(d=p)}if(d===null){var f=s.getMainWidget(),y=f.getBounding();y.left>r||r>y.left+y.width||y.top>a||a>y.top+y.height||(d=f)}if(d===null){var m=s.getYAxisWidget();if(m!==null){var _=m.getBounding();_.left>r||r>_.left+_.width||_.top>a||a>_.top+_.height||(d=m)}}}return{pane:s,widget:d}},i.prototype._makeWidgetEvent=function(e,t){var n,o,r,a=(n=t==null?void 0:t.getBounding())!==null&&n!==void 0?n:null;return k(k({},e),{x:e.x-((o=a==null?void 0:a.left)!==null&&o!==void 0?o:0),y:e.y-((r=a==null?void 0:a.top)!==null&&r!==void 0?r:0)})},i.prototype.destroy=function(){this._container.removeEventListener("keydown",this._boundKeyBoardDownEvent),this._event.destroy()},i}();g.DomPosition=void 0,(Pt=g.DomPosition||(g.DomPosition={})).Root="root",Pt.Main="main",Pt.YAxis="yAxis";var ko=function(){function i(e,t){this._panes=new Map,this._initContainer(e),this._chartEvent=new ei(this._chartContainer,this),this._chartStore=new Dn(this,t),this._xAxisPane=new Jn(this._chartContainer,this,ae),this._panes.set(oe,new jn(this._chartContainer,this,oe)),this.adjustPaneViewport(!0,!0,!0)}return i.prototype._initContainer=function(e){this._container=e,this._chartContainer=me("div",{position:"relative",width:"100%",outline:"none",borderStyle:"none",cursor:"crosshair",boxSizing:"border-box",userSelect:"none",webkitUserSelect:"none",msUserSelect:"none",MozUserSelect:"none",webkitTapHighlightColor:"transparent"}),this._chartContainer.tabIndex=1,e.appendChild(this._chartContainer)},i.prototype._measurePaneHeight=function(){var e,t=this._container.offsetHeight,n=this._xAxisPane.getAxisComponent().getAutoSize(),o=t-n;0>o&&(o=0);var r=0;this._panes.forEach(function(l){if(l.getId()!==oe){var u=l.getBounding().height,c=l.getOptions().minHeight;c>u&&(u=c),r+u>o?u=Math.max(o-(r=o),0):r+=u,l.setBounding({height:u})}});var a=o-r;(e=this._panes.get(oe))===null||e===void 0||e.setBounding({height:a});var s=0;this._panes.forEach(function(l){l.setBounding({top:s}),s+=l.getBounding().height}),this._xAxisPane.setBounding({height:n,top:s})},i.prototype._measurePaneWidth=function(){var e=this._chartStore.getStyles().yAxis,t=e.position===g.YAxisPosition.Left,n=!e.inside,o=this._container.offsetWidth,r=0,a=Number.MIN_SAFE_INTEGER,s=0,l=0;this._panes.forEach(function(d){a=Math.max(a,d.getAxisComponent().getAutoSize())}),a>o&&(a=o),n?(r=o-a,t?(s=0,l=a):(s=o-a,l=0)):(r=o,l=0,s=t?0:o-a),this._chartStore.getTimeScaleStore().setTotalBarSpace(r);var u={width:o},c={width:r,left:l},h={width:a,left:s};this._panes.forEach(function(d){d.setBounding(u,c,h)}),this._xAxisPane.setBounding(u,c,h)},i.prototype._setPaneOptions=function(e,t){var n,o,r=this._panes.get((n=e==null?void 0:e.id)!==null&&n!==void 0?n:""),a=!1;if(r!==void 0){var s=t;if(e.id!==oe&&e.height!==void 0&&e.height>0){var l=Math.max((o=e.minHeight)!==null&&o!==void 0?o:r.getOptions().minHeight,0);r.setBounding({height:Math.max(l,e.height)}),s=!0,a=!0}r.setOptions(e),s&&this.adjustPaneViewport(a,!0,!0,!0,!0)}},i.prototype.getContainer=function(){return this._container},i.prototype.getChartStore=function(){return this._chartStore},i.prototype.getAllPanes=function(){return this._panes},i.prototype.adjustPaneViewport=function(e,t,n,o,r){e&&this._measurePaneHeight();var a=t,s=r!=null&&r;(o!=null&&o||s)&&this._panes.forEach(function(l){var u=l.getAxisComponent().buildTicks(s);a||(a=u)}),a&&this._measurePaneWidth(),n!=null&&n&&(this._xAxisPane.getAxisComponent().buildTicks(!0),this.updatePane(4))},i.prototype.updatePane=function(e,t){var n;t!==void 0?(n=this.getPaneById(t))===null||n===void 0||n.update(e):(this._xAxisPane.update(e),this._panes.forEach(function(o){o.update(e)}))},i.prototype.getPaneById=function(e){var t;return e===ae?this._xAxisPane:(t=this._panes.get(e))!==null&&t!==void 0?t:null},i.prototype.crosshairChange=function(e){var t=this,n=this._chartStore.getActionStore();if(n.has(g.ActionType.OnCrosshairChange)){var o={};this._panes.forEach(function(r,a){var s={};t._chartStore.getIndicatorStore().getInstances(a).forEach(function(l){var u,c=l.result;s[l.name]=c[(u=e.dataIndex)!==null&&u!==void 0?u:c.length-1]}),o[a]=s}),e.paneId!==void 0&&n.execute(g.ActionType.OnCrosshairChange,k(k({},e),{indicatorData:o}))}},i.prototype.getDom=function(e,t){var n,o;if(e===void 0)return this._chartContainer;var r=this.getPaneById(e);if(r!==null)switch(t??g.DomPosition.Root){case g.DomPosition.Root:return r.getContainer();case g.DomPosition.Main:return r.getMainWidget().getContainer();case g.DomPosition.YAxis:return(o=(n=r.getYAxisWidget())===null||n===void 0?void 0:n.getContainer())!==null&&o!==void 0?o:null}return null},i.prototype.getSize=function(e,t){var n,o;if(e===void 0)return{width:this._chartContainer.offsetWidth,height:this._chartContainer.offsetHeight,left:0,top:0,right:0,bottom:0};var r=this.getPaneById(e);if(r!==null)switch(t??g.DomPosition.Root){case g.DomPosition.Root:return r.getBounding();case g.DomPosition.Main:return r.getMainWidget().getBounding();case g.DomPosition.YAxis:return(o=(n=r.getYAxisWidget())===null||n===void 0?void 0:n.getBounding())!==null&&o!==void 0?o:null}return null},i.prototype.setStyles=function(e){var t,n,o;this._chartStore.setOptions({styles:e}),((t=(o=ce(e)?lo(e):e)==null?void 0:o.yAxis)===null||t===void 0?void 0:t.type)!==void 0&&((n=this.getPaneById(oe))===null||n===void 0||n.getAxisComponent().setAutoCalcTickFlag(!0)),this.adjustPaneViewport(!0,!0,!0,!0,!0)},i.prototype.getStyles=function(){return this._chartStore.getStyles()},i.prototype.setLocale=function(e){this._chartStore.setOptions({locale:e}),this.adjustPaneViewport(!0,!0,!0,!0,!0)},i.prototype.getLocale=function(){return this._chartStore.getLocale()},i.prototype.setCustomApi=function(e){this._chartStore.setOptions({customApi:e}),this.adjustPaneViewport(!0,!0,!0,!0,!0)},i.prototype.setPriceVolumePrecision=function(e,t){this._chartStore.setPrecision({price:e,volume:t})},i.prototype.getPriceVolumePrecision=function(){return this._chartStore.getPrecision()},i.prototype.setTimezone=function(e){this._chartStore.setOptions({timezone:e}),this._xAxisPane.getAxisComponent().buildTicks(!0),this._xAxisPane.update(3)},i.prototype.getTimezone=function(){return this._chartStore.getTimeScaleStore().getTimezone()},i.prototype.setOffsetRightDistance=function(e){this._chartStore.getTimeScaleStore().setOffsetRightDistance(e,!0)},i.prototype.getOffsetRightDistance=function(){return this._chartStore.getTimeScaleStore().getOffsetRightDistance()},i.prototype.setLeftMinVisibleBarCount=function(e){e>0&&this._chartStore.getTimeScaleStore().setLeftMinVisibleBarCount(Math.ceil(e))},i.prototype.setRightMinVisibleBarCount=function(e){e>0&&this._chartStore.getTimeScaleStore().setRightMinVisibleBarCount(Math.ceil(e))},i.prototype.setBarSpace=function(e){this._chartStore.getTimeScaleStore().setBarSpace(e)},i.prototype.getBarSpace=function(){return this._chartStore.getTimeScaleStore().getBarSpace().bar},i.prototype.getVisibleRange=function(){return this._chartStore.getTimeScaleStore().getVisibleRange()},i.prototype.clearData=function(){this._chartStore.clear()},i.prototype.getDataList=function(){return this._chartStore.getDataList()},i.prototype.applyNewData=function(e,t,n){this._chartStore.clear(),e.length===0?this.adjustPaneViewport(!1,!0,!0,!0):this.applyMoreData(e,t,n)},i.prototype.applyMoreData=function(e,t,n){var o=this;this._chartStore.addData(e,0,t),e.length>0&&this._chartStore.getIndicatorStore().calcInstance().then(function(r){o.adjustPaneViewport(!1,!0,!0,!0),n==null||n()}).catch(function(r){})},i.prototype.updateData=function(e,t){var n=this,o=this._chartStore.getDataList(),r=o.length,a=e.timestamp,s=U(o[r-1],"timestamp",0);if(a>=s){var l=r;a===s&&(l=r-1),this._chartStore.addData(e,l),this._chartStore.getIndicatorStore().calcInstance().then(function(u){n.adjustPaneViewport(!1,!0,!0,!0),t==null||t()}).catch(function(u){})}},i.prototype.loadMore=function(e){this._chartStore.getTimeScaleStore().setLoadMoreCallback(e)},i.prototype.createIndicator=function(e,t,n,o){var r,a,s,l=this,u=ce(e)?{name:e}:e;if($t(u.name)===null)return null;if(Y(n)&&ce(n==null?void 0:n.id)&&this._panes.has(n.id))s=n.id,this._chartStore.getIndicatorStore().addInstance(u,s,t!=null&&t).then(function(p){var v,f;l._setPaneOptions(n,(f=(v=l._panes.get(s))===null||v===void 0?void 0:v.getAxisComponent().buildTicks(!0))!==null&&f!==void 0&&f)}).catch(function(p){});else{s=(r=n==null?void 0:n.id)!==null&&r!==void 0?r:Kt(En);var c=Array.from(this._panes.values()).pop(),h=new Ao(this._chartContainer,this,s,c);c.setBottomPane(h);var d=(a=n==null?void 0:n.height)!==null&&a!==void 0?a:100;h.setBounding({height:d}),Y(n)&&h.setOptions(n),this._panes.set(s,h),this._chartStore.getIndicatorStore().addInstance(u,s,t!=null&&t).finally(function(){l.adjustPaneViewport(!0,!0,!0,!0,!0),o==null||o()})}return s},i.prototype.overrideIndicator=function(e,t,n){var o=this;this._chartStore.getIndicatorStore().override(e,t??null).then(function(r){var a=ee(r,2),s=a[1];(a[0]||s)&&(o.adjustPaneViewport(!1,s,!0,s),n==null||n())}).catch(function(){})},i.prototype.getIndicatorByPaneId=function(e,t){return this._chartStore.getIndicatorStore().getInstanceByPaneId(e,t)},i.prototype.removeIndicator=function(e,t){var n=this._chartStore.getIndicatorStore();if(n.removeInstance(e,t)){var o=!1;if(e!==oe&&!n.hasInstances(e)){var r=this._panes.get(e);if(r!==void 0){o=!0;var a=r.getTopPane(),s=r.getBottomPane();s==null||s.setTopPane(a),a==null||a.setBottomPane(s),r==null||r.destroy(),this._panes.delete(e)}}this.adjustPaneViewport(o,!0,!0,!0,!0)}},i.prototype.createOverlay=function(e,t){var n=[];ce(e)?n=[{name:e}]:M(e)?n=e.map(function(a){return ce(a)?{name:a}:a}):n=[e];var o=!0;t!==void 0&&this.getPaneById(t)!==null||(t=oe,o=!1);var r=this._chartStore.getOverlayStore().addInstances(n,t,o);return M(e)?r:r[0]},i.prototype.getOverlayById=function(e){return this._chartStore.getOverlayStore().getInstanceById(e)},i.prototype.overrideOverlay=function(e){this._chartStore.getOverlayStore().override(e)},i.prototype.removeOverlay=function(e){var t;e!==void 0&&(t=ce(e)?{id:e}:e),this._chartStore.getOverlayStore().removeInstance(t)},i.prototype.setPaneOptions=function(e){this._setPaneOptions(e,!1)},i.prototype.setZoomEnabled=function(e){this._chartStore.getTimeScaleStore().setZoomEnabled(e)},i.prototype.isZoomEnabled=function(){return this._chartStore.getTimeScaleStore().getZoomEnabled()},i.prototype.setScrollEnabled=function(e){this._chartStore.getTimeScaleStore().setScrollEnabled(e)},i.prototype.isScrollEnabled=function(){return this._chartStore.getTimeScaleStore().getScrollEnabled()},i.prototype.scrollByDistance=function(e,t){var n=t===void 0||0>t?0:t,o=this._chartStore.getTimeScaleStore();if(n>0){o.startScroll();var r=new Date().getTime(),a=function(){var s=(new Date().getTime()-r)/n,l=s>=1;o.scroll(l?e:e*s),l||requestAnimationFrame(a)};a()}else o.startScroll(),o.scroll(e)},i.prototype.scrollToRealTime=function(e){var t=this._chartStore.getTimeScaleStore(),n=t.getBarSpace().bar,o=t.getOffsetRightBarCount()-t.getInitialOffsetRightDistance()/n;this.scrollByDistance(o*n,e)},i.prototype.scrollToDataIndex=function(e,t){var n=this._chartStore.getTimeScaleStore(),o=(n.getOffsetRightBarCount()+(this.getDataList().length-1-e))*n.getBarSpace().bar;this.scrollByDistance(o,t)},i.prototype.scrollToTimestamp=function(e,t){var n=xt(this.getDataList(),"timestamp",e);this.scrollToDataIndex(n,t)},i.prototype.zoomAtCoordinate=function(e,t,n){var o=n===void 0||0>n?0:n,r=this._chartStore.getTimeScaleStore();if(o>0){var a=r.getBarSpace().bar,s=a*e-a,l=new Date().getTime(),u=function(){var c=(new Date().getTime()-l)/o,h=c>=1;r.zoom((h?s:s*c)/a,t),h||requestAnimationFrame(u)};u()}else r.zoom(e,t)},i.prototype.zoomAtDataIndex=function(e,t,n){var o=this._chartStore.getTimeScaleStore().dataIndexToCoordinate(t);this.zoomAtCoordinate(e,{x:o,y:0},n)},i.prototype.zoomAtTimestamp=function(e,t,n){var o=xt(this.getDataList(),"timestamp",t);this.zoomAtDataIndex(e,o,n)},i.prototype.convertToPixel=function(e,t){var n,o=t.paneId,r=o===void 0?oe:o,a=t.absolute,s=a!==void 0&&a,l=[];if(r!==ae){var u=this.getPaneById(r);if(u!==null){var c=this._chartStore.getTimeScaleStore(),h=u.getBounding(),d=[].concat(e),p=this._xAxisPane.getAxisComponent(),v=u.getAxisComponent();l=d.map(function(f){var y={},m=f.dataIndex;if(f.timestamp!==void 0&&(m=c.timestampToDataIndex(f.timestamp)),m!==void 0&&(y.x=p==null?void 0:p.convertToPixel(m)),f.value!==void 0){var _=v==null?void 0:v.convertToPixel(f.value);y.y=s?h.top+_:_}return y})}}return M(e)?l:(n=l[0])!==null&&n!==void 0?n:{}},i.prototype.convertFromPixel=function(e,t){var n,o=t.paneId,r=o===void 0?oe:o,a=t.absolute,s=a!==void 0&&a,l=[];if(r!==ae){var u=this.getPaneById(r);if(u!==null){var c=this._chartStore.getTimeScaleStore(),h=u.getBounding(),d=[].concat(e),p=this._xAxisPane.getAxisComponent(),v=u.getAxisComponent();l=d.map(function(f){var y,m={};if(f.x!==void 0){var _=p.convertFromPixel(f.x);m.dataIndex=_,m.timestamp=(y=c.dataIndexToTimestamp(_))!==null&&y!==void 0?y:void 0}return f.y!==void 0&&(m.value=v.convertFromPixel(s?f.y-h.top:f.y)),m})}}return M(e)?l:(n=l[0])!==null&&n!==void 0?n:{}},i.prototype.executeAction=function(e,t){var n;if(e===g.ActionType.OnCrosshairChange){var o=k({},t);o.paneId=(n=o.paneId)!==null&&n!==void 0?n:oe,this._chartStore.getTooltipStore().setCrosshair(o)}},i.prototype.subscribeAction=function(e,t){this._chartStore.getActionStore().subscribe(e,t)},i.prototype.unsubscribeAction=function(e,t){this._chartStore.getActionStore().unsubscribe(e,t)},i.prototype.getConvertPictureUrl=function(e,t,n){var o=this._chartContainer.offsetWidth,r=this._chartContainer.offsetHeight,a=me("canvas",{width:"".concat(o,"px"),height:"".concat(r,"px"),boxSizing:"border-box"}),s=a.getContext("2d"),l=Ie(a);a.width=o*l,a.height=r*l,s.scale(l,l),s.fillStyle=n??"#FFFFFF",s.fillRect(0,0,o,r);var u=e!=null&&e;this._panes.forEach(function(h){var d=h.getBounding();s.drawImage(h.getImage(u),0,d.top,o,d.height)});var c=this._xAxisPane.getBounding();return s.drawImage(this._xAxisPane.getImage(u),0,c.top,o,c.height),a.toDataURL("image/".concat(t??"jpeg"))},i.prototype.resize=function(){this.adjustPaneViewport(!0,!0,!0,!0,!0)},i.prototype.destroy=function(){this._chartEvent.destroy(),this._panes.forEach(function(e){e.destroy()}),this._panes.clear(),this._xAxisPane.destroy(),this._container.removeChild(this._chartContainer)},i}(),st=new Map,ti=1,oi={clone:q,merge:I,isString:ce,isNumber:Z,isValid:Y,isObject:O,isArray:M,isFunction:L,isBoolean:re,formatValue:U,formatPrecision:G,formatBigNumber:Xt,formatDate:Ht,formatThousands:J,calcTextWidth:qe,getLinearSlopeIntercept:it,getLinearYFromSlopeIntercept:wt,getLinearYFromCoordinates:Ke,checkCoordinateOnArc:_o,checkCoordinateOnCircle:uo,checkCoordinateOnLine:to,checkCoordinateOnPolygon:ho,checkCoordinateOnRect:vo,checkCoordinateOnText:yo,drawArc:xo,drawCircle:co,drawLine:oo,drawPolygon:po,drawRect:Ft,drawText:At,drawRectText:kn};g.dispose=function(i){var e,t,n;if(i instanceof ko)n=i.id;else{var o=void 0;n=(e=(o=ce(i)?document.getElementById(i):i)==null?void 0:o.getAttribute("k-line-chart-id"))!==null&&e!==void 0?e:null}n!==null&&((t=st.get(n))===null||t===void 0||t.destroy(),st.delete(n))},g.getFigureClass=function(i){var e;return(e=Ge[i])!==null&&e!==void 0?e:null},g.getOverlayClass=function(i){var e;return(e=Ue[i])!==null&&e!==void 0?e:null},g.getSupportedFigures=function(){return Object.keys(Ge)},g.getSupportedIndicators=function(){return Object.keys(nt)},g.getSupportedLocales=function(){return Object.keys(at)},g.getSupportedOverlays=function(){return Object.keys(Ue)},g.init=function(i,e){var t;if((t=ce(i)?document.getElementById(i):i)===null)return null;var n=st.get(t.id);if(n!==void 0)return n;var o="k_line_chart_".concat(ti++);return(n=new ko(t,e)).id=o,t.setAttribute("k-line-chart-id",o),st.set(o,n),n},g.registerFigure=function(i){Ge[i.name]=Qt.extend(i)},g.registerIndicator=function(i){nt[i.name]=Gt.extend(i)},g.registerLocale=function(i,e){at[i]=k(k({},at[i]),e)},g.registerOverlay=function(i){Ue[i.name]=Jt.extend(i)},g.registerStyles=function(i,e){so[i]=e},g.utils=oi,g.version=function(){return"9.5.4"}})})(zt,zt.exports);var Si=zt.exports;$o.exports=Si;var V=$o.exports;const bi=ci(V);var le=(P=>(P["en-US"]="en-US",P["zh-CN"]="zh-CN",P["zh-TW"]="zh-TW",P["ja-JP"]="ja-JP",P["vi-VN"]="vi-VN",P["es-ES"]="es-ES",P["ru-RU"]="ru-RU",P["tr-TR"]="tr-TR",P["pt-BR"]="pt-BR",P["fr-FR"]="fr-FR",P["th-TH"]="th-TH",P["id-ID"]="id-ID",P))(le||{}),Ei=(P=>(P["en-US"]="en",P["zh-MY"]="zh",P["ko-KR"]="ko",P["ja-JP"]="ja",P["vi-VN"]="vi",P["es-ES"]="es",P["zh-TW"]="zh_TW",P["ru-RU"]="ru",P["tr-TR"]="tr",P["pt-BR"]="pt",P["fr-FR"]="fr",P["th-TH"]="th",P["id-ID"]="id_ID",P))(Ei||{});const wi="dark",Ti="en-US",qo={up:"#15bb7a",up_opacity:"rgba(21, 187, 122, 0.6)",down:"#d2334d",down_opacity:"rgba(210, 51, 77, 0.6)",family:"Helvetica Neue",text_size:10,crosshair:"#fff",crosshair_bg:"#4c525e"},jo={light:{...qo,background:"#fff",grid:"rgba(243, 245, 247, 0.7)",price_mark:"#81858c",cross_line:"rgba(16, 16, 20, 0.6)",scales_text:"#81858c",scales_line:"#e9edf2",tooltip_color:"#81858c"},dark:{...qo,background:"#101014",grid:"rgba(32, 33, 36, 0.7)",price_mark:"#adb1b8",cross_line:"rgba(255, 255, 255, 0.6)",scales_text:"#adb1b8",scales_line:"#404347",tooltip_color:"#adb1b8"}},Ko=P=>{const w=jo[P]||jo.dark;return{grid:{show:!0,horizontal:{show:!0,size:1,color:w.grid,style:V.LineType.Dashed,dashedValue:[2,2]},vertical:{show:!0,size:1,color:w.grid,style:V.LineType.Dashed,dashedValue:[2,2]}},candle:{type:V.CandleType.CandleSolid,bar:{upColor:w.up,downColor:w.down,noChangeColor:w.up,upBorderColor:w.up,downBorderColor:w.down,noChangeBorderColor:w.up,upWickColor:w.up,downWickColor:w.down,noChangeWickColor:w.up},area:{lineSize:2,lineColor:"#2196F3",value:"close",backgroundColor:[{offset:0,color:"rgba(33, 150, 243, 0.01)"},{offset:1,color:"rgba(33, 150, 243, 0.2)"}]},priceMark:{show:!0,high:{show:!0,color:w.price_mark,textOffset:4,textSize:w.text_size,textFamily:w.family,textWeight:"normal"},low:{show:!0,color:w.price_mark,textOffset:4,textSize:w.text_size,textFamily:w.family,textWeight:"normal"},last:{show:!0,upColor:w.up,downColor:w.down,noChangeColor:w.up,line:{show:!0,style:V.LineType.Dashed,dashedValue:[4,4],size:.4},text:{show:!0,style:V.PolygonType.Fill,size:w.text_size,paddingLeft:7,paddingTop:3,paddingRight:5,paddingBottom:2,borderStyle:V.LineType.Solid,borderSize:1,borderDashedValue:[2,2],color:"#FFFFFF",family:w.family,weight:"normal",borderRadius:2}}},tooltip:{showRule:V.TooltipShowRule.Always,showType:V.TooltipShowType.Standard,custom:null,defaultValue:"n/a",rect:{position:"fixed",paddingLeft:0,paddingRight:0,paddingTop:0,paddingBottom:6,offsetLeft:10,offsetTop:8,offsetRight:10,offsetBottom:8,borderRadius:4,borderSize:1,borderColor:"#f2f3f5",color:"#FEFEFE"},text:{size:11,family:w.family,weight:"normal",color:w.tooltip_color,marginLeft:12,marginTop:12,marginRight:-6,marginBottom:0},icons:[]}},indicator:{ohlc:{upColor:w.up_opacity,downColor:w.down_opacity,noChangeColor:w.up_opacity},bars:[{style:V.PolygonType.Fill,borderStyle:V.LineType.Solid,borderSize:1,borderDashedValue:[2,2],upColor:w.up_opacity,downColor:w.down_opacity,noChangeColor:w.up_opacity}],lines:[{style:V.LineType.Solid,smooth:!1,size:.4,dashedValue:[2,2],color:"#FF9600"},{style:V.LineType.Solid,smooth:!1,size:.4,dashedValue:[2,2],color:"#935EBD"},{style:V.LineType.Solid,smooth:!1,size:.4,dashedValue:[2,2],color:"#2196F3"},{style:V.LineType.Solid,smooth:!1,size:.4,dashedValue:[2,2],color:"#E11D74"},{style:V.LineType.Solid,smooth:!1,size:.4,dashedValue:[2,2],color:"#01C5C4"}],circles:[{style:V.PolygonType.Fill,borderStyle:V.LineType.Solid,borderSize:1,borderDashedValue:[2,2],upColor:w.up_opacity,downColor:w.down_opacity,noChangeColor:w.up_opacity}],lastValueMark:{show:!1,text:{show:!1,style:V.PolygonType.Fill,color:"#FFFFFF",size:w.text_size,family:w.family,weight:"normal",borderStyle:V.LineType.Solid,borderSize:1,borderDashedValue:[2,2],paddingLeft:7,paddingTop:3,paddingRight:5,paddingBottom:2,borderRadius:2}},tooltip:{showRule:V.TooltipShowRule.Always,showType:V.TooltipShowType.Standard,showName:!0,showParams:!0,defaultValue:"n/a",text:{size:12,family:w.family,weight:"normal",color:w.tooltip_color,marginTop:12,marginRight:-6,marginBottom:0,marginLeft:12},icons:[]}},xAxis:{show:!0,size:"auto",axisLine:{show:!0,color:w.scales_line,size:1},tickText:{show:!0,color:w.scales_text,family:w.family,weight:"normal",size:w.text_size,marginStrat:3,marginBottom:6},tickLine:{show:!0,size:1,length:3,color:w.scales_line}},yAxis:{show:!0,size:"auto",position:V.YAxisPosition.Right,type:V.YAxisType.Normal,inside:!1,reverse:!1,axisLine:{show:!0,color:w.scales_line,size:1},tickText:{show:!0,color:w.scales_text,family:w.family,weight:"normal",size:w.text_size,marginStrat:3,marginBottom:6},tickLine:{show:!0,size:1,length:3,color:w.scales_line}},separator:{size:1,color:w.scales_line,fill:!0,activeBackgroundColor:"rgba(230, 230, 230, .15)"},crosshair:{show:!0,horizontal:{show:!0,line:{show:!0,style:V.LineType.Dashed,dashedValue:[6,6],size:1,color:w.cross_line},text:{show:!0,style:V.PolygonType.Fill,color:w.crosshair,size:w.text_size,family:w.family,weight:"normal",borderStyle:V.LineType.Solid,borderDashedValue:[2,2],borderSize:1,borderColor:w.crosshair_bg,borderRadius:2,paddingLeft:7,paddingRight:5,paddingTop:3,paddingBottom:2,backgroundColor:w.crosshair_bg}},vertical:{show:!0,line:{show:!0,style:V.LineType.Dashed,dashedValue:[6,6],size:1,color:"#888888"},text:{show:!0,style:V.PolygonType.Fill,color:"#FFFFFF",size:w.text_size,family:"Helvetica Neue",weight:"normal",borderStyle:V.LineType.Solid,borderDashedValue:[2,2],borderSize:1,borderColor:w.crosshair_bg,borderRadius:2,paddingLeft:2,paddingRight:2,paddingTop:3,paddingBottom:2,backgroundColor:w.crosshair_bg}}},overlay:{point:{color:"#1677FF",borderColor:"rgba(22, 119, 255, 0.35)",borderSize:1,radius:5,activeColor:"#1677FF",activeBorderColor:"rgba(22, 119, 255, 0.35)",activeBorderSize:3,activeRadius:5},line:{style:V.LineType.Solid,smooth:!1,color:"#1677FF",size:1,dashedValue:[2,2]},rect:{style:V.PolygonType.Fill,color:"rgba(22, 119, 255, 0.25)",borderColor:"#1677FF",borderSize:1,borderRadius:0,borderStyle:V.LineType.Solid,borderDashedValue:[2,2]},polygon:{style:V.PolygonType.Fill,color:"#1677FF",borderColor:"#1677FF",borderSize:1,borderStyle:V.LineType.Solid,borderDashedValue:[2,2]},circle:{style:V.PolygonType.Fill,color:"rgba(22, 119, 255, 0.25)",borderColor:"#1677FF",borderSize:1,borderStyle:V.LineType.Solid,borderDashedValue:[2,2]},arc:{style:V.LineType.Solid,color:"#1677FF",size:1,dashedValue:[2,2]},text:{color:"#1677FF",size:12,family:"Helvetica Neue",weight:"normal"},rectText:{style:V.PolygonType.Fill,color:"#FFFFFF",size:12,family:"Helvetica Neue",weight:"normal",borderStyle:V.LineType.Solid,borderDashedValue:[2,2],borderSize:1,borderRadius:2,borderColor:"#1677FF",paddingLeft:4,paddingRight:4,paddingTop:4,paddingBottom:4,backgroundColor:"#1677FF"}}}},ge={indicator:"Indicators",type:{bar:"Bars",candle:"Candles",hollow_candle:"Hollow Candles",avg_candle:"Heikin Ashi",line:"Line",area:"Area",base_line:"BaseLine"},ohlc:{o:"O",h:"H",l:"L",c:"C"},timezone:{utc:"UTC","-10":"Honolulu","-9":"Juneau","-8":"Los Angeles","-7":"Phoenix","-6":"Mexico City","-5":"New York","-4":"Caracas","-3":"Sao Paulo","+0":"London","+1":"Paris","+2":"Cairo","+3":"Moscow","+3:30":"Tehran","+4":"Dubai","+5":"Ashkhabad","+5:30":"Kolkata","+6":"Almaty","+7":"Bangkok","+8":"Shanghai","+9":"Tokyo","+10":"Brisbane","+10:30":"Adelaide","+11":"Sydney","+12":"Norfolk Island","+13":"New Zealand","+13:45":"Chatham Islands"}},Di={[le["en-US"]]:ge,[le["zh-CN"]]:{indicator:"指标",type:{bar:"美国线",candle:"K线图",hollow_candle:"空心K线图",avg_candle:"平均K线图",line:"线形图",area:"面积图",base_line:"基准线"},ohlc:{o:"开=",h:"高=",l:"低=",c:"收="},timezone:{utc:"世界统一时间","-10":"檀香山","-9":"朱诺","-8":"洛杉矶","-7":"菲尼克斯","-6":"墨西哥城","-5":"纽约","-4":"加拉加斯","-3":"圣保罗","+0":"伦敦","+1":"巴黎","+2":"开罗","+3":"莫斯科","+3:30":"德黑兰","+4":"迪拜","+5":"阿什哈巴德","+5:30":"加尔各答","+6":"阿拉木图","+7":"曼谷","+8":"上海","+9":"东京","+10":"布里斯班","+10:30":"阿德莱德","+11":"悉尼","+12":"诺福克岛","+13":"新西兰","+13:45":"查塔姆群岛"}},[le["zh-TW"]]:{indicator:"技術指標",type:{bar:"美國線",candle:"K線",hollow_candle:"空心蠟燭線",avg_candle:"平均K線",line:"線形圖",area:"區域圖",base_line:"基準線"},ohlc:{o:"開=",h:"高=",l:"低=",c:"收="},timezone:{utc:"世界統一時間","-10":"檀香山","-9":"朱諾","-8":"洛杉磯","-7":"菲尼克斯","-6":"墨西哥城","-5":"紐約","-4":"加拉加斯","-3":"聖保羅","+0":"倫敦","+1":"巴黎","+2":"開羅","+3":"莫斯科","+3:30":"德黑蘭","+4":"迪拜","+5":"阿什哈巴德","+5:30":"加爾各答","+6":"阿拉木圖","+7":"曼谷","+8":"上海","+9":"東京","+10":"布里斯班","+10:30":"阿德萊德","+11":"悉尼","+12":"諾福克島","+13":"新西蘭","+13:45":"查塔姆群島"}},[le["ja-JP"]]:{indicator:"インジケーター",type:{bar:"バー",candle:"ローソク足",hollow_candle:"中空ローソク足",avg_candle:"平均足",line:"ライン",area:"エリア",base_line:"ベースライン"},ohlc:{o:"始値",h:"高値",l:"安値",c:"終値"},timezone:{utc:"UTC","-10":"Honolulu","-9":"Juneau","-8":"Los Angeles","-7":"Phoenix","-6":"Mexico City","-5":"New York","-4":"Caracas","-3":"Sao Paulo","+0":"London","+1":"Paris","+2":"Cairo","+3":"Moscow","+3:30":"Tehran","+4":"Dubai","+5":"Ashkhabad","+5:30":"Kolkata","+6":"Almaty","+7":"Bangkok","+8":"Shanghai","+9":"Tokyo","+10":"Brisbane","+10:30":"Adelaide","+11":"Sydney","+12":"Norfolk Island","+13":"New Zealand","+13:45":"Chatham Islands"}},[le["vi-VN"]]:{indicator:"Các chỉ báo",type:{bar:"Hình Thanh",candle:"Biểu đồ nến",hollow_candle:"Biểu đồ nến Hollow",avg_candle:"Mô hình Heikin Ashi",line:"Đường thẳng",area:"Biểu đồ vùng",base_line:"Đường cơ sở"},ohlc:ge.ohlc,timezone:ge.timezone},[le["es-ES"]]:{indicator:"Indicadores",type:{bar:"Barras",candle:"Velas",hollow_candle:"Velas huecas",avg_candle:"Heikin Ashi",line:"Línea",area:"Área",base_line:"Línea de referencia"},ohlc:ge.ohlc,timezone:ge.timezone},[le["ru-RU"]]:{indicator:"Индикаторы",type:{bar:"Бары",candle:"Японские свечи",hollow_candle:"Пустые свечи",avg_candle:"Хейкен Аши",line:"Линия",area:"Область",base_line:"Базовая линия"},ohlc:{o:"ОТКР",h:"МАКС",l:"МИН",c:"ЗАКР"},timezone:ge.timezone},[le["tr-TR"]]:{indicator:"Göstergeler",type:{bar:"Çubuk Grafikler",candle:"Mum Grafikler",hollow_candle:"İçi Boş Mumlar",avg_candle:"Heikin Ashi",line:"Çizgi",area:"Alan",base_line:"Temel Çizgi"},ohlc:{o:"A",h:"Y",l:"D",c:"K"},timezone:ge.timezone},[le["pt-BR"]]:{indicator:"Indicadores",type:{bar:"Barras",candle:"Velas",hollow_candle:"Candles Vazios",avg_candle:"Heiken Ashi",line:"Linha",area:"Área",base_line:"Linha Base"},ohlc:{o:"Abr",h:"Máx.",l:"Mín.",c:"Fch"},timezone:ge.timezone},[le["fr-FR"]]:{indicator:"Indicateurs",type:{bar:"Barres",candle:"Bougies",hollow_candle:"Bougies Creuses",avg_candle:"Heikin Ashi",line:"Droite",area:"Région",base_line:"Ligne de base"},ohlc:{o:"O",h:"H",l:"B",c:"C"},timezone:ge.timezone},[le["th-TH"]]:{indicator:"อินดิเคเตอร์",type:{bar:"บาร์",candle:"แท่งเทียน",hollow_candle:"แท่งเทียนแบบกลวง",avg_candle:"ไฮเกน อาชิ",line:"เส้น",area:"พื้นที่",base_line:"เส้นฐาน"},ohlc:{o:"เปิด",h:"สูง",l:"ต่ำ",c:"ปิด"},timezone:ge.timezone},[le["id-ID"]]:{indicator:"Indikator",type:{bar:"Bar",candle:"Candle",hollow_candle:"Candle Kosong",avg_candle:"Heikin Ashi",line:"Garis",area:"Area",base_line:"Garisdasar"},ohlc:ge.ohlc,timezone:ge.timezone}},Fi=P=>{const{data:w,pricePrecision:g,locale:I}=P,{ohlc:q}=Di[I],M=Go(w.close,w.open),L=xi(Ci(M,w.open),100),O=Zo(M,0)?P.downColor:P.upColor,Z=`${Xo(M,0)?"+":""}${He(M,g,7)}`,Y=`(${Xo(L,0)?"+":""}${He(L,2,7)}%)`;return[{title:q.o,value:{text:He(w.open,g),color:O}},{title:q.h,value:{text:He(w.high,g),color:O}},{title:q.l,value:{text:He(w.low,g),color:O}},{title:q.c,value:{text:He(w.close,g),color:O}},{title:"",value:{text:`${Z} ${Y}`,color:O}}]},Ai=(P,w)=>{if(typeof P=="string"&&!P.length)throw new Error("Dom id 不能为空");w.styles||(w.styles=Ko((w==null?void 0:w.theme)||wi)),w.locale=le[w.locale]||Ti;const g=bi.init(P,w);return g?(g.$updateTooltip=()=>{const{candle:I}=g.getStyles();I.tooltip.custom=({current:q},{bar:M})=>{const L={data:q,pricePrecision:g.getPriceVolumePrecision().price,locale:g.getLocale(),upColor:M.upColor,downColor:M.downColor};return Fi(L)},g.setStyles({candle:I})},g.$setTheme=I=>{const q=Ko(I);q&&g.setStyles(q)},g.$updateTooltip(),g.setLeftMinVisibleBarCount(5),g.setRightMinVisibleBarCount(5),g.setOffsetRightDistance(60),g.setBarSpace(7),g.setPaneOptions({id:"candle_pane",gap:{top:.3}}),(()=>{const I=new ResizeObserver(()=>{setTimeout(()=>{g.resize()},0)});g.getDom()&&I.observe(g.getDom())})(),g.$addDefaultMa=()=>{g.getIndicatorByPaneId("candle_pane","MA")&&g.removeIndicator("candle_pane","MA"),g.createIndicator({name:"MA",calcParams:[10,30,60]},!1,{id:"candle_pane",dragEnabled:!0})},w.showMa&&g.$addDefaultMa(),g.$addVol=()=>{g.getIndicatorByPaneId("default_vol","VOL")&&g.removeIndicator("default_vol","VOL"),g.createIndicator({name:"VOL",calcParams:[20],precision:4,figures:[{key:"ma1",title:"",type:"line"},{key:"volume",title:"",type:"bar",baseValue:0,styles({current:I},q,{bars:M}){const{close:L,open:O}=I.kLineData||{close:0,open:0},{upColor:Z,downColor:Y}=M[0];return{color:Zo(Go(L,O),0)?Y:Z}}}]},!1,{id:"default_vol"})},w.showVol&&g.$addVol(),g):null},Ii=Ot('<svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24" data-v-6b4ca851><g stroke="currentColor" data-v-6b4ca851><circle cx="12" cy="12" r="9.5" fill="none" stroke-linecap="round" stroke-width="3" data-v-6b4ca851><animate attributeName="stroke-dasharray" calcMode="spline" dur="1.5s" keySplines="0.42,0,0.58,1;0.42,0,0.58,1;0.42,0,0.58,1" keyTimes="0;0.475;0.95;1" repeatCount="indefinite" values="0 150;42 150;42 150;42 150" data-v-6b4ca851></animate><animate attributeName="stroke-dashoffset" calcMode="spline" dur="1.5s" keySplines="0.42,0,0.58,1;0.42,0,0.58,1;0.42,0,0.58,1" keyTimes="0;0.475;0.95;1" repeatCount="indefinite" values="0;-16;-59;-59" data-v-6b4ca851></animate></circle><animateTransform attributeName="transform" dur="2s" repeatCount="indefinite" type="rotate" values="0 12 12;360 12 12" data-v-6b4ca851></animateTransform></g></svg>',1),ki=[Ii],Pi=Vt({__name:"Loading",props:{theme:{type:String,default:"dark"}},setup(P){return(w,g)=>(Ee(),Re("div",{class:hi(["loading",[`is-${P.theme}`]])},ki,2))}});const Mi=pt(Pi,[["__scopeId","data-v-6b4ca851"]]),Bi=["innerHTML"],Li=Vt({__name:"SimpleChart",props:{loading:{type:Boolean,default:!0},theme:{type:String,default:""},lang:{type:String,default:""},showMa:{type:Boolean,default:!0},showVol:{type:Boolean,default:!0},limitSize:{type:Number,default:300},watermark:{type:String,defatult:""},list:{type:Array,default:()=>[]},latestData:{type:Object,default:()=>null},loadMore:{type:Function,default:()=>{}}},setup(P,{expose:w}){const g=P,I=Uo({el:null,chart:null}),q={applyNewData(M){var L;(L=I.chart)==null||L.applyNewData(M,g.list.length>=g.limitSize)},applyMoreData(M){var L;(L=I.chart)==null||L.applyMoreData(M,g.list.length>=g.limitSize)},loadMore(M){g.loadMore(M,q.applyMoreData)}};return di(()=>{var L;const M={theme:g.theme,showMa:g.showMa,showVol:g.showVol};g.lang&&(M.locale=g.lang),I.chart=Ai(I.el,M),g.list.length&&q.applyNewData(g.list),(L=I.chart)==null||L.loadMore(q.loadMore)}),ct(()=>g.latestData,M=>{var L;M&&((L=I.chart)==null||L.updateData(M))}),ct(()=>g.list,(M,L)=>{!M.length&&!L||q.applyNewData(M)},{immediate:!0}),ct(()=>g.lang,M=>{var L;M&&((L=I.chart)==null||L.setLocale(g.lang))}),ct(()=>g.theme,M=>{var L;M&&((L=I.chart)==null||L.$setTheme(M))}),w({chart:I.chart}),(M,L)=>(Ee(),Re("section",{ref:O=>I.el=O,class:"simple-chart"},[P.loading?(Ee(),Rt(Mi,{key:0})):Wo("",!0),P.watermark&&!P.loading?(Ee(),Re("div",{key:1,class:"simple-chart-watermark",innerHTML:P.watermark},null,8,Bi)):Wo("",!0)],512))}});const Ri=pt(Li,[["__scopeId","data-v-e104bc03"]]),zi=P=>(mi("data-v-99307201"),P=P(),_i(),P),Vi={class:"chart"},Oi={class:"mt-10px bg-amber/10 rd-10px p-20px"},Ni=zi(()=>ht("h4",null," 修改配置 ",-1)),Wi={class:"flex flex-row flex-wrap mb-12px gap-10px mt-6px"},Yi=Vt({__name:"Kline",setup(P){const w=new li("wss://ws.meex.com/kline-api/ws",{name:"kline-ws",retry:100}),{isDark:g}=pi(),I=Uo({loading:!1,theme:"dark",lang:"en-US",list:[],sub_list:[],latest_data:null,interval:"60min",interval_options:["1min","5min","15min","30min","60min","4h","1day","1week","1month"],lang_options:["en-US","zh-CN","zh-TW","ja-JP","vi-VN","es-ES","ru-RU","tr-TR","pt-BR","fr-FR","th-TH","id-ID"]}),q=gi(()=>`market_btcusdt_kline_${I.interval}`),M={init(){M.reqKline(),M.subKline()},reqKline(){I.loading=!0,I.sub_list=[],w.send({event:"req",params:{channel:q.value}},L=>{var O,Z;if(I.loading=!1,L.success){const Y=M.formatList(L.data);if(I.list.length){const re=(O=Y.slice(-1)[0])==null?void 0:O.timestamp;((Z=I.list[0])==null?void 0:Z.timestamp)>re&&Y.push(I.sub_list[0])}I.list=Y}})},loadMore(L,O){L&&w.send({event:"req",params:{channel:q.value,endIdx:L/1e3,pageSize:100}},Z=>{Z.success&&O(M.formatList(Z.data))})},subKline(){w.send({event:"sub",params:{channel:q.value}},L=>{if(L.success){const O=M.formatList([L.tick]);I.loading?I.sub_list=O:[I.latest_data]=O}})},selectInterval(L){w.send({event:"unsub",params:{channel:q.value}},()=>{I.interval=L,M.init()})},formatList(L){return L.map(O=>({timestamp:O.id*1e3,open:O.open,close:O.close,high:O.high,low:O.low,volume:O.vol}))}};return M.init(),vi(()=>{w.send({event:"unsub",params:{channel:q.value}},()=>{}),w.close()}),fi(()=>{I.theme=g.value?"dark":"light"}),(L,O)=>{const Z=No.ElOption,Y=No.ElSelect;return Ee(),Re(Lt,null,[ht("div",Vi,[dt(yi(Ri),{loading:I.loading,theme:I.theme,lang:I.lang,list:I.list,"latest-data":I.latest_data,"load-more":M.loadMore,watermark:"Kline"},null,8,["loading","theme","lang","list","latest-data","load-more"])]),ht("div",Oi,[Ni,ht("div",Wi,[dt(Y,{"model-value":I.interval,size:"small",onChange:M.selectInterval},{default:Yo(()=>[(Ee(!0),Re(Lt,null,Ho(I.interval_options,re=>(Ee(),Rt(Z,{key:re,label:`获取${re}数据`,value:re},null,8,["label","value"]))),128))]),_:1},8,["model-value","onChange"]),dt(Y,{"model-value":I.lang,size:"small",onChange:O[0]||(O[0]=re=>I.lang=re)},{default:Yo(()=>[(Ee(!0),Re(Lt,null,Ho(I.lang_options,re=>(Ee(),Rt(Z,{key:re,label:re,value:re},null,8,["label","value"]))),128))]),_:1},8,["model-value"])])])],64)}}});const Hi=pt(Yi,[["__scopeId","data-v-99307201"]]),Qi=JSON.parse('{"title":"kline","description":"","frontmatter":{"outline":"deep"},"headers":[],"relativePath":"npm/kline.md","lastUpdated":1698749247000}'),Xi={name:"npm/kline.md"},qi=Ot('<h1 id="kline" tabindex="-1">kline <a class="header-anchor" href="#kline" aria-label="Permalink to &quot;kline&quot;">​</a></h1><h2 id="基础版" tabindex="-1">基础版 <a class="header-anchor" href="#基础版" aria-label="Permalink to &quot;基础版&quot;">​</a></h2><p>基础版kline,基于 <a href="https://klinecharts.com/" target="_blank" rel="noreferrer">KlineChart</a> 二次开发。</p><h3 id="demo" tabindex="-1">Demo <a class="header-anchor" href="#demo" aria-label="Permalink to &quot;Demo&quot;">​</a></h3>',4),ji=Ot(`<h3 id="install" tabindex="-1">Install <a class="header-anchor" href="#install" aria-label="Permalink to &quot;Install&quot;">​</a></h3><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;"># 使用 npm</span></span>
<span class="line"><span style="color:#FFCB6B;">npm</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">i</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">@fe/kline</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">@fe/number</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">klinecharts</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 使用 yarn</span></span>
<span class="line"><span style="color:#FFCB6B;">yarn</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">add</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">@fe/kline</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">@fe/number</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">klinecharts</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 使用 pnpm</span></span>
<span class="line"><span style="color:#FFCB6B;">pnpm</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">add</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">@fe/kline</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">@fe/number</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">klinecharts</span></span></code></pre></div><h3 id="函数" tabindex="-1">函数 <a class="header-anchor" href="#函数" aria-label="Permalink to &quot;函数&quot;">​</a></h3><h4 id="simpleinit" tabindex="-1">simpleInit() <a class="header-anchor" href="#simpleinit" aria-label="Permalink to &quot;simpleInit()&quot;">​</a></h4><p>初始化图表。</p><ul><li><p>类型</p><ul><li><code>KlineOptions</code>: <a href="https://klinecharts.com/guide/chart-api.html" target="_blank" rel="noreferrer">https://klinecharts.com/guide/chart-api.html</a></li><li><code>KlineChart</code>: <a href="https://klinecharts.com/guide/instance-api.html" target="_blank" rel="noreferrer">https://klinecharts.com/guide/instance-api.html</a></li></ul><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">type</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Theme</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">dark</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">light</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#C792EA;">type</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Options</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">KlineOptions</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&amp;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">theme</span><span style="color:#89DDFF;">?:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Theme</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">showMa</span><span style="color:#89DDFF;">?:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">boolean</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">showVol</span><span style="color:#89DDFF;">?:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">boolean</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">type</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Chart</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">KlineChart</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&amp;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">$updateTooltip</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;font-style:italic;">// 更新提示</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">$setTheme</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">theme</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">\`\${</span><span style="color:#FFCB6B;">Theme</span><span style="color:#89DDFF;">}\`</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;font-style:italic;">// 更新主题</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">$addDefaultMa</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;font-style:italic;">// 手动添加ma指标</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">$addVol</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;font-style:italic;">// 手动添加成交量</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">null</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> simpleInit </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">el</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">HTMLElement</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">string</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">options</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Options</span><span style="color:#89DDFF;">):</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Chart</span></span></code></pre></div></li></ul><h4 id="klinechart" tabindex="-1">klinechart <a class="header-anchor" href="#klinechart" aria-label="Permalink to &quot;klinechart&quot;">​</a></h4><p>默认导出 <a href="https://klinecharts.com/guide/chart-api.html" target="_blank" rel="noreferrer">klinechart</a> 支持的所有函数</p><h3 id="实例函数" tabindex="-1">实例函数 <a class="header-anchor" href="#实例函数" aria-label="Permalink to &quot;实例函数&quot;">​</a></h3><p>默认导出 <a href="https://klinecharts.com/guide/chart-api.html" target="_blank" rel="noreferrer">klinechart</a> 支持的所有api</p><h3 id="类型" tabindex="-1">类型 <a class="header-anchor" href="#类型" aria-label="Permalink to &quot;类型&quot;">​</a></h3><h4 id="simpleoptions" tabindex="-1">SimpleOptions <a class="header-anchor" href="#simpleoptions" aria-label="Permalink to &quot;SimpleOptions&quot;">​</a></h4><p>导出类型<code>Options</code>;</p><h4 id="simplechart" tabindex="-1">SimpleChart <a class="header-anchor" href="#simplechart" aria-label="Permalink to &quot;SimpleChart&quot;">​</a></h4><p>导出类型<code>Chart</code>;</p><h2 id="基础版vue组件" tabindex="-1">基础版vue组件 <a class="header-anchor" href="#基础版vue组件" aria-label="Permalink to &quot;基础版vue组件&quot;">​</a></h2>`,16);function Ki(P,w,g,I,q,M){const L=Hi;return Ee(),Re("div",null,[qi,dt(L),ji])}const er=pt(Xi,[["render",Ki]]);export{Qi as __pageData,er as default};
