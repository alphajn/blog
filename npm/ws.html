<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Socket | 菠萝前端</title>
    <meta name="description" content="FE、Web、开发工具库、使用文档、前端文档、面试题、kline、javascript、 ts、 tradingView">
    <meta name="generator" content="VitePress v1.3.4">
    <link rel="preload stylesheet" href="/blog/assets/style.Dqbu6wYh.css" as="style">
    
    <script type="module" src="/blog/assets/app.DQKzKTrl.js"></script>
    <link rel="preload" href="/blog/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/blog/assets/chunks/theme.BmxgB_sG.js">
    <link rel="modulepreload" href="/blog/assets/chunks/framework.3EWjcNId.js">
    <link rel="modulepreload" href="/blog/assets/chunks/index.BbVwo5FL.js">
    <link rel="modulepreload" href="/blog/assets/chunks/config.DFyAZYNx.js">
    <link rel="modulepreload" href="/blog/assets/npm_ws.md.l9M2AOLd.lean.js">
    <meta name="theme-color" content="#fff">
    <meta name="google-site-verification" content="xVcJ7hjRLnkQ-xHNrUNu-DvlHAdd8TJ4PaXI2VvcNbg">
    <link rel="icon" href="/blog/favicon.ico" type="image/x-icon">
    <link rel="alternate icon" href="/blog/favicon.ico" type="image/x-icon">
    <meta name="author" content="Alpha.wu and doc contributors">
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-c2e44112><!--[--><!--]--><!--[--><span tabindex="-1" data-v-8b337110></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-8b337110> Skip to content </a><!--]--><!----><header class="VPNav" data-v-c2e44112 data-v-ac50c9fb><div class="VPNavBar" data-v-ac50c9fb data-v-0cacd001><div class="wrapper" data-v-0cacd001><div class="container" data-v-0cacd001><div class="title" data-v-0cacd001><div class="VPNavBarTitle has-sidebar" data-v-0cacd001 data-v-25effcc7><a class="title" href="/blog/" data-v-25effcc7><!--[--><!--]--><!--[--><img class="VPImage logo" src="/blog/logo.svg" alt data-v-2b1b788f><!--]--><span data-v-25effcc7>菠萝前端</span><!--[--><!--]--></a></div></div><div class="content" data-v-0cacd001><div class="content-body" data-v-0cacd001><!--[--><!--]--><div class="VPNavBarSearch search" data-v-0cacd001><!--[--><!----><div id="local-search"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><span class="vp-icon DocSearch-Search-Icon"></span><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div><!--]--></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-0cacd001 data-v-139381bf><span id="main-nav-aria-label" class="visually-hidden" data-v-139381bf> Main Navigation </span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/blog/project/editorConfig.html" tabindex="0" data-v-139381bf data-v-3a182490><!--[--><span data-v-3a182490>项目规范</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/blog/docs/terminal.html" tabindex="0" data-v-139381bf data-v-3a182490><!--[--><span data-v-3a182490>文档</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink active" href="/blog/npm/number.html" tabindex="0" data-v-139381bf data-v-3a182490><!--[--><span data-v-3a182490>NPM</span><!--]--></a><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-0cacd001 data-v-0c2408b7><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-0c2408b7 data-v-0d61e03b data-v-b3962fd8><span class="check" data-v-b3962fd8><span class="icon" data-v-b3962fd8><!--[--><span class="vpi-sun sun" data-v-0d61e03b></span><span class="vpi-moon moon" data-v-0d61e03b></span><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-0cacd001 data-v-12ec1f6c data-v-90c2cdcd><!--[--><a class="VPSocialLink no-icon" href="https://github.com/alphajn" aria-label="github" target="_blank" rel="noopener" data-v-90c2cdcd data-v-5de22b11><span class="vpi-social-github" /></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-0cacd001 data-v-d2323ae5 data-v-192a83da><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-192a83da><span class="vpi-more-horizontal icon" data-v-192a83da></span></button><div class="menu" data-v-192a83da><div class="VPMenu" data-v-192a83da data-v-3399e51b><!----><!--[--><!--[--><!----><div class="group" data-v-d2323ae5><div class="item appearance" data-v-d2323ae5><p class="label" data-v-d2323ae5>Appearance</p><div class="appearance-action" data-v-d2323ae5><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-d2323ae5 data-v-0d61e03b data-v-b3962fd8><span class="check" data-v-b3962fd8><span class="icon" data-v-b3962fd8><!--[--><span class="vpi-sun sun" data-v-0d61e03b></span><span class="vpi-moon moon" data-v-0d61e03b></span><!--]--></span></span></button></div></div></div><div class="group" data-v-d2323ae5><div class="item social-links" data-v-d2323ae5><div class="VPSocialLinks social-links-list" data-v-d2323ae5 data-v-90c2cdcd><!--[--><a class="VPSocialLink no-icon" href="https://github.com/alphajn" aria-label="github" target="_blank" rel="noopener" data-v-90c2cdcd data-v-5de22b11><span class="vpi-social-github" /></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-0cacd001 data-v-b9737cc4><span class="container" data-v-b9737cc4><span class="top" data-v-b9737cc4></span><span class="middle" data-v-b9737cc4></span><span class="bottom" data-v-b9737cc4></span></span></button></div></div></div></div><div class="divider" data-v-0cacd001><div class="divider-line" data-v-0cacd001></div></div></div><!----></header><div class="VPLocalNav has-sidebar empty" data-v-c2e44112 data-v-a1e74b92><div class="container" data-v-a1e74b92><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-a1e74b92><span class="vpi-align-left menu-icon" data-v-a1e74b92></span><span class="menu-text" data-v-a1e74b92>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-a1e74b92 data-v-3e02476b><button data-v-3e02476b>Return to top</button><!----></div></div></div><aside class="VPSidebar" data-v-c2e44112 data-v-13cc29c8><div class="curtain" data-v-13cc29c8></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-13cc29c8><span class="visually-hidden" id="sidebar-aria-label" data-v-13cc29c8> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="no-transition group" data-v-e5f89f28><section class="VPSidebarItem level-0 has-active" data-v-e5f89f28 data-v-bf98de4d><div class="item" role="button" tabindex="0" data-v-bf98de4d><div class="indicator" data-v-bf98de4d></div><h2 class="text" data-v-bf98de4d>基础</h2><!----></div><div class="items" data-v-bf98de4d><!--[--><div class="VPSidebarItem level-1 is-link" data-v-bf98de4d data-v-bf98de4d><div class="item" data-v-bf98de4d><div class="indicator" data-v-bf98de4d></div><a class="VPLink link link" href="/blog/npm/number.html" data-v-bf98de4d><!--[--><p class="text" data-v-bf98de4d>number</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-bf98de4d data-v-bf98de4d><div class="item" data-v-bf98de4d><div class="indicator" data-v-bf98de4d></div><a class="VPLink link link" href="/blog/npm/ws.html" data-v-bf98de4d><!--[--><p class="text" data-v-bf98de4d>socket</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-bf98de4d data-v-bf98de4d><div class="item" data-v-bf98de4d><div class="indicator" data-v-bf98de4d></div><a class="VPLink link link" href="/blog/npm/eslint-vue.html" data-v-bf98de4d><!--[--><p class="text" data-v-bf98de4d>eslint-vue</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-bf98de4d data-v-bf98de4d><div class="item" data-v-bf98de4d><div class="indicator" data-v-bf98de4d></div><a class="VPLink link link" href="/blog/npm/style.html" data-v-bf98de4d><!--[--><p class="text" data-v-bf98de4d>style</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-e5f89f28><section class="VPSidebarItem level-0" data-v-e5f89f28 data-v-bf98de4d><div class="item" role="button" tabindex="0" data-v-bf98de4d><div class="indicator" data-v-bf98de4d></div><h2 class="text" data-v-bf98de4d>Chart</h2><!----></div><div class="items" data-v-bf98de4d><!--[--><div class="VPSidebarItem level-1 is-link" data-v-bf98de4d data-v-bf98de4d><div class="item" data-v-bf98de4d><div class="indicator" data-v-bf98de4d></div><a class="VPLink link link" href="/blog/npm/kline-menu.html" data-v-bf98de4d><!--[--><p class="text" data-v-bf98de4d>Kline-菜单</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-bf98de4d data-v-bf98de4d><div class="item" data-v-bf98de4d><div class="indicator" data-v-bf98de4d></div><a class="VPLink link link" href="/blog/npm/kline-simple.html" data-v-bf98de4d><!--[--><p class="text" data-v-bf98de4d>Kline-简版</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-bf98de4d data-v-bf98de4d><div class="item" data-v-bf98de4d><div class="indicator" data-v-bf98de4d></div><a class="VPLink link link" href="/blog/npm/kline-tv.html" data-v-bf98de4d><!--[--><p class="text" data-v-bf98de4d>Kline-专业版</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-bf98de4d data-v-bf98de4d><div class="item" data-v-bf98de4d><div class="indicator" data-v-bf98de4d></div><a class="VPLink link link" href="/blog/npm/kline.html" data-v-bf98de4d><!--[--><p class="text" data-v-bf98de4d>Kline</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-bf98de4d data-v-bf98de4d><div class="item" data-v-bf98de4d><div class="indicator" data-v-bf98de4d></div><a class="VPLink link link" href="/blog/npm/depth.html" data-v-bf98de4d><!--[--><p class="text" data-v-bf98de4d>深度图-depth</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-c2e44112 data-v-d594c4b9><div class="VPDoc has-sidebar has-aside" data-v-d594c4b9 data-v-7880e169><!--[--><!--]--><div class="container" data-v-7880e169><div class="aside" data-v-7880e169><div class="aside-curtain" data-v-7880e169></div><div class="aside-container" data-v-7880e169><div class="aside-content" data-v-7880e169><div class="VPDocAside" data-v-7880e169 data-v-d3fbe509><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="VPDocAsideOutline" data-v-d3fbe509 data-v-733bfe9a><div class="content" data-v-733bfe9a><div class="outline-marker" data-v-733bfe9a></div><div aria-level="2" class="outline-title" id="doc-outline-aria-label" role="heading" data-v-733bfe9a>On this page</div><ul class="VPDocOutlineItem root" data-v-733bfe9a data-v-e7f2c2d3><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-d3fbe509></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-7880e169><div class="content-container" data-v-7880e169><!--[--><!--]--><main class="main" data-v-7880e169><div style="position:relative;" class="vp-doc _blog_npm_ws" data-v-7880e169><div><h1 id="socket" tabindex="-1">Socket <a class="header-anchor" href="#socket" aria-label="Permalink to &quot;Socket&quot;">​</a></h1><p>通用的Scoket，主要功能:</p><ol><li>支持自动建连ws。</li><li>支持手动初始化<code>options.connect = false</code>, 初始化时执行 <code>init()</code>。</li><li>支持ws不可用时缓存订阅队列，ws建连之后自动发送缓存的订阅。</li><li>支持相同订阅只发送一次，成功之后同步执行回调。</li><li>支持主动/被动心跳功能。</li><li>支持断线自动重连功能。</li><li>支持<code>pako</code>解析压缩数据流。</li></ol><h2 id="demo-hashkey-api" tabindex="-1">Demo（<span class="c-#409EFF">Hashkey Api</span>） <a class="header-anchor" href="#demo-hashkey-api" aria-label="Permalink to &quot;Demo（&lt;span class=&quot;c-#409EFF&quot;&gt;Hashkey Api&lt;/span&gt;）&quot;">​</a></h2><!--[--><div class="flex flex-row flex-wrap gap-10px fw-bold" data-v-03062b96><span class="c-#F56C6C" data-v-03062b96> ws状态: </span><span class="c-#909399" data-v-03062b96>关闭</span><span class="ml-24px c-#E6A23C" data-v-03062b96> 连接耗时: </span><span class="c-#909399" data-v-03062b96>-- ms </span><span class="ml-auto select-none flex items-center gap-x-4px" data-v-03062b96><input id="binary" type="checkbox" class="m-0 w-16px h-16px" data-v-03062b96><label for="binary" class="c-#909399 cursor-pointer" data-v-03062b96>返回二进制数据</label></span></div><div class="mt-8px flex flex-col gap-y-16px" data-v-03062b96><!--[--><div class="p-10px rd-10px transition-duration-300" data-v-03062b96><div class="flex justify-between items-center pb-6px gap-x-6px sticky top-64px pt-6px bg-[var(--vp-c-bg)] b-b-solid b-b-#909399 b-b-0.5px" data-v-03062b96><span class="c-#67C23A fw-bold" data-v-03062b96>订阅所有交易对行情</span><div class="flex gap-x-8px shrink-0" data-v-03062b96><!----><button type="button" class="bg-#67C23A c-white rd-4px px-10px flex items-center transition-duration-300 hover:opacity-80" data-v-03062b96><!----> 订阅</button></div></div><details class="py-6px fw-500" data-v-03062b96><summary class="c-#409EFF cursor-pointer !my-0" data-v-03062b96> 发送数据: </summary><pre class="c-#909399 lh-[1.4] my-0 indent-0" data-v-03062b96>{
    &quot;event&quot;: &quot;sub&quot;,
    &quot;topic&quot;: &quot;slowBroker&quot;,
    &quot;id&quot;: &quot;sub_slowBroker&quot;
}</pre></details><details class="py-6px fw-500" data-v-03062b96><summary class="c-#E6A23C cursor-pointer !my-0" data-v-03062b96> 接收数据: </summary><pre class="c-#909399 lh-[1.4] my-0 overflow-auto max-h-800px" data-v-03062b96>null</pre></details></div><div class="p-10px rd-10px transition-duration-300" data-v-03062b96><div class="flex justify-between items-center pb-6px gap-x-6px sticky top-64px pt-6px bg-[var(--vp-c-bg)] b-b-solid b-b-#909399 b-b-0.5px" data-v-03062b96><span class="c-#67C23A fw-bold" data-v-03062b96>订阅当前交易对最新行情（会产生多条，最后一条为最新）</span><div class="flex gap-x-8px shrink-0" data-v-03062b96><!----><button type="button" class="bg-#67C23A c-white rd-4px px-10px flex items-center transition-duration-300 hover:opacity-80" data-v-03062b96><!----> 订阅</button></div></div><details class="py-6px fw-500" data-v-03062b96><summary class="c-#409EFF cursor-pointer !my-0" data-v-03062b96> 发送数据: </summary><pre class="c-#909399 lh-[1.4] my-0 indent-0" data-v-03062b96>{
    &quot;event&quot;: &quot;sub&quot;,
    &quot;topic&quot;: &quot;realtimes&quot;,
    &quot;symbol&quot;: &quot;BTCUSDT&quot;,
    &quot;id&quot;: &quot;sub_realtimes_BTCUSDT&quot;
}</pre></details><details class="py-6px fw-500" data-v-03062b96><summary class="c-#E6A23C cursor-pointer !my-0" data-v-03062b96> 接收数据: </summary><pre class="c-#909399 lh-[1.4] my-0 overflow-auto max-h-800px" data-v-03062b96>null</pre></details></div><div class="p-10px rd-10px transition-duration-300" data-v-03062b96><div class="flex justify-between items-center pb-6px gap-x-6px sticky top-64px pt-6px bg-[var(--vp-c-bg)] b-b-solid b-b-#909399 b-b-0.5px" data-v-03062b96><span class="c-#67C23A fw-bold" data-v-03062b96>订阅盘口挂单列表（精度2, 20条）</span><div class="flex gap-x-8px shrink-0" data-v-03062b96><!----><button type="button" class="bg-#67C23A c-white rd-4px px-10px flex items-center transition-duration-300 hover:opacity-80" data-v-03062b96><!----> 订阅</button></div></div><details class="py-6px fw-500" data-v-03062b96><summary class="c-#409EFF cursor-pointer !my-0" data-v-03062b96> 发送数据: </summary><pre class="c-#909399 lh-[1.4] my-0 indent-0" data-v-03062b96>{
    &quot;event&quot;: &quot;sub&quot;,
    &quot;topic&quot;: &quot;mergedDepth&quot;,
    &quot;symbol&quot;: &quot;BTCUSDT&quot;,
    &quot;id&quot;: &quot;sub_mergedDepth_BTCUSDT&quot;,
    &quot;limit&quot;: 20,
    &quot;params&quot;: {
        &quot;dumpScale&quot;: 2
    }
}</pre></details><details class="py-6px fw-500" data-v-03062b96><summary class="c-#E6A23C cursor-pointer !my-0" data-v-03062b96> 接收数据: </summary><pre class="c-#909399 lh-[1.4] my-0 overflow-auto max-h-800px" data-v-03062b96>null</pre></details></div><div class="p-10px rd-10px transition-duration-300" data-v-03062b96><div class="flex justify-between items-center pb-6px gap-x-6px sticky top-64px pt-6px bg-[var(--vp-c-bg)] b-b-solid b-b-#909399 b-b-0.5px" data-v-03062b96><span class="c-#67C23A fw-bold" data-v-03062b96>订阅最新成交（40条）</span><div class="flex gap-x-8px shrink-0" data-v-03062b96><!----><button type="button" class="bg-#67C23A c-white rd-4px px-10px flex items-center transition-duration-300 hover:opacity-80" data-v-03062b96><!----> 订阅</button></div></div><details class="py-6px fw-500" data-v-03062b96><summary class="c-#409EFF cursor-pointer !my-0" data-v-03062b96> 发送数据: </summary><pre class="c-#909399 lh-[1.4] my-0 indent-0" data-v-03062b96>{
    &quot;event&quot;: &quot;sub&quot;,
    &quot;topic&quot;: &quot;trade&quot;,
    &quot;id&quot;: &quot;sub_trade_BTCUSDT&quot;,
    &quot;symbol&quot;: &quot;BTCUSDT&quot;,
    &quot;limit&quot;: 40
}</pre></details><details class="py-6px fw-500" data-v-03062b96><summary class="c-#E6A23C cursor-pointer !my-0" data-v-03062b96> 接收数据: </summary><pre class="c-#909399 lh-[1.4] my-0 overflow-auto max-h-800px" data-v-03062b96>null</pre></details></div><div class="p-10px rd-10px transition-duration-300" data-v-03062b96><div class="flex justify-between items-center pb-6px gap-x-6px sticky top-64px pt-6px bg-[var(--vp-c-bg)] b-b-solid b-b-#909399 b-b-0.5px" data-v-03062b96><span class="c-#67C23A fw-bold" data-v-03062b96>订阅 kline 1 小时数据（最新1条）</span><div class="flex gap-x-8px shrink-0" data-v-03062b96><!----><button type="button" class="bg-#67C23A c-white rd-4px px-10px flex items-center transition-duration-300 hover:opacity-80" data-v-03062b96><!----> 订阅</button></div></div><details class="py-6px fw-500" data-v-03062b96><summary class="c-#409EFF cursor-pointer !my-0" data-v-03062b96> 发送数据: </summary><pre class="c-#909399 lh-[1.4] my-0 indent-0" data-v-03062b96>{
    &quot;event&quot;: &quot;sub&quot;,
    &quot;topic&quot;: &quot;kline_1h&quot;,
    &quot;symbol&quot;: &quot;BTCUSDT&quot;,
    &quot;id&quot;: &quot;sub_kline_1h_BTCUSDT&quot;,
    &quot;params&quot;: {
        &quot;limit&quot;: 1
    }
}</pre></details><details class="py-6px fw-500" data-v-03062b96><summary class="c-#E6A23C cursor-pointer !my-0" data-v-03062b96> 接收数据: </summary><pre class="c-#909399 lh-[1.4] my-0 overflow-auto max-h-800px" data-v-03062b96>null</pre></details></div><div class="p-10px rd-10px transition-duration-300" data-v-03062b96><div class="flex justify-between items-center pb-6px gap-x-6px sticky top-64px pt-6px bg-[var(--vp-c-bg)] b-b-solid b-b-#909399 b-b-0.5px" data-v-03062b96><span class="c-#67C23A fw-bold" data-v-03062b96>订阅深度图数据</span><div class="flex gap-x-8px shrink-0" data-v-03062b96><!----><button type="button" class="bg-#67C23A c-white rd-4px px-10px flex items-center transition-duration-300 hover:opacity-80" data-v-03062b96><!----> 订阅</button></div></div><details class="py-6px fw-500" data-v-03062b96><summary class="c-#409EFF cursor-pointer !my-0" data-v-03062b96> 发送数据: </summary><pre class="c-#909399 lh-[1.4] my-0 indent-0" data-v-03062b96>{
    &quot;event&quot;: &quot;sub&quot;,
    &quot;topic&quot;: &quot;depth&quot;,
    &quot;symbol&quot;: &quot;BTCUSDT&quot;,
    &quot;id&quot;: &quot;sub_depth_BTCUSDT&quot;
}</pre></details><details class="py-6px fw-500" data-v-03062b96><summary class="c-#E6A23C cursor-pointer !my-0" data-v-03062b96> 接收数据: </summary><pre class="c-#909399 lh-[1.4] my-0 overflow-auto max-h-800px" data-v-03062b96>null</pre></details></div><!--]--></div><!--]--><h2 id="install" tabindex="-1">Install <a class="header-anchor" href="#install" aria-label="Permalink to &quot;Install&quot;">​</a></h2><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pnpm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> add</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> fejn-socket</span></span></code></pre></div><h2 id="使用" tabindex="-1">使用 <a class="header-anchor" href="#使用" aria-label="Permalink to &quot;使用&quot;">​</a></h2><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Socket </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;fejn-socket&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> socket </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> shallowRef</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">null</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Socket</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">null</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">onMounted</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    socket </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Socket</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(url, options);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span></code></pre></div><h3 id="查看log" tabindex="-1">查看log <a class="header-anchor" href="#查看log" aria-label="Permalink to &quot;查看log&quot;">​</a></h3><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sessionStorage.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">setItem</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;ws-debug&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;1&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre></div><h2 id="参数" tabindex="-1">参数 <a class="header-anchor" href="#参数" aria-label="Permalink to &quot;参数&quot;">​</a></h2><h3 id="url" tabindex="-1">url <a class="header-anchor" href="#url" aria-label="Permalink to &quot;url&quot;">​</a></h3><p>链接 WebSocket 服务器将响应的 URL：<code>ws://ws.abc.com</code> 或 <code>wss://ws.abc.com</code>。</p><ul><li><p>类型 <code>string | URL</code></p></li><li><p>示例</p><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> url</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;wss://ws.abc.com&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 或者</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> url</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> URL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;/kline&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;ws://ws.abc.com/&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// ws://ws.abc.com/kline</span></span></code></pre></div></li></ul><h3 id="options" tabindex="-1">options <a class="header-anchor" href="#options" aria-label="Permalink to &quot;options&quot;">​</a></h3><p>初始化Socket时使用的配置选项。</p><ul><li><p>类型</p><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">type</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Options</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> string</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    connect</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> boolean</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    protocols</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> string</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> undefined</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    retry</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> number</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    retryTime</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> number</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    heart</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> boolean</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    heartTime</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> number</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    listenNetwork</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> boolean</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    binary</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> boolean</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    onCreate</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">retryNum</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> number</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> void</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    onOpen</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">retryNum</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> number</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> void</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    onClose</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">isManual</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> boolean</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> void</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div></li><li><p>详细说明</p><table tabindex="0"><thead><tr><th>参数</th><th>默认值</th><th>描述</th></tr></thead><tbody><tr><td><strong>name</strong></td><td>ws</td><td>ws链接名称，主要用来查看区分多个ws的debug信息</td></tr><tr><td><strong>connect</strong></td><td>true</td><td>创建Socket时是否自动初始化，如果设置为 <code>false</code> 时需要手动调用 <code>init</code> 方式初始化</td></tr><tr><td><strong>protocols</strong></td><td>&#39;&#39;</td><td>一个协议字符串或者一个包含协议字符串的数组, 具体查看 <a href="https://developer.mozilla.org/zh-CN/docs/Web/API/WebSocket/WebSocket" target="_blank" rel="noreferrer">WebSocket</a></td></tr><tr><td><strong>retry</strong></td><td>4</td><td>自动重连次数，非手动关闭ws时执行</td></tr><tr><td><strong>retryTime</strong></td><td>2000</td><td>自动重连间隔时间，以<code>毫秒</code>为单位</td></tr><tr><td><strong>heart</strong></td><td>false</td><td>是否主动探测心跳，如果需要主动探测心跳需要设置为 <code>true</code></td></tr><tr><td><strong>heartTime</strong></td><td>5000</td><td>主动探测心跳间隔，以<code>毫秒</code>为单位, 3次获取不到回应判定失败</td></tr><tr><td><strong>listenNetwork</strong></td><td>true</td><td>是否监听网络状态，监听<code>online 或 offline</code>事件</td></tr><tr><td><strong>binary</strong></td><td>false</td><td>默认以文本形式发送数据，设置<code>true</code>解析二进制数据</td></tr><tr><td><strong>onCreate</strong></td><td><code>function</code></td><td>创建连接时的回调函数，参数<code>retryNumber</code>为重试次数</td></tr><tr><td><strong>onOpen</strong></td><td><code>function</code></td><td>连接成功时的回调函数，参数<code>retryNumber</code>为重试次数</td></tr><tr><td><strong>onClose</strong></td><td><code>function</code></td><td>连接关闭时的回调函数，参数<code>retryNumber</code>表示是否为手动关闭</td></tr></tbody></table></li></ul><h2 id="实例函数" tabindex="-1">实例函数 <a class="header-anchor" href="#实例函数" aria-label="Permalink to &quot;实例函数&quot;">​</a></h2><h3 id="init" tabindex="-1">init() <a class="header-anchor" href="#init" aria-label="Permalink to &quot;init()&quot;">​</a></h3><p>手动初始化ws。</p><ul><li><p>类型</p><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> init</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">url</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Url</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> void</span></span></code></pre></div></li><li><p>示例</p><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Socket </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;fejn-socket&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> socket </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> shallowRef</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">null</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Socket</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">null</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">onMounted</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    socket </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Socket</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;ws://ws.api.com&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, { connect: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> });</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // 手动初始化并添加token</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    socket.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">init</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;ws://ws.api.com?token=asdf&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span></code></pre></div></li></ul><h3 id="send" tabindex="-1">send() <a class="header-anchor" href="#send" aria-label="Permalink to &quot;send()&quot;">​</a></h3><p>订阅发送数据。</p><ul><li><p>类型</p><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">enum</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Key</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    action</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;event&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 动作键</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    topic</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;topic&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 主题键</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">enum</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Action</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    req</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;req&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 请求</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    sub</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;sub&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 订阅</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    unsub</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;cancel&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 取消订阅</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    ping</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;ping&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 心跳检测请求</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    pong</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;pong&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 心跳检测响应</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">type</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> SendData</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    [Key.action]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> `${</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Action</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}`</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> // 动作类型，使用模板字符串限制为Action枚举的值</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    [Key.topic]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> string</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> // 主题</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    id</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> string</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> // 请求ID，用于区分不同的请求或订阅,如: sub_depth_BTCUSDT</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    params</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Record</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">any</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 可选的参数</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    [</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">propName</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> any</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> // 允许其他任意属性</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">type</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> SendCb</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">data</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> any</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> void</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> send</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">data</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> SendData</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">callback</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> SendCb</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> void</span></span></code></pre></div></li><li><p>示例</p><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Socket </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;fejn-socket&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Ws</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Socket</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;ws://ws.api.com&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> sendData</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    event: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;sub&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    topic: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;slowBroker&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    id: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;sub_slowBroker&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Ws</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.send(sendData, (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // TODO::</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span></code></pre></div></li></ul><h3 id="close" tabindex="-1">close() <a class="header-anchor" href="#close" aria-label="Permalink to &quot;close()&quot;">​</a></h3><p>手动关闭ws。</p><ul><li><p>类型</p><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> close</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> void</span></span></code></pre></div></li></ul></div></div></main><footer class="VPDocFooter" data-v-7880e169 data-v-99bdb337><!--[--><!--]--><div class="edit-info" data-v-99bdb337><!----><div class="last-updated" data-v-99bdb337><p class="VPLastUpdated" data-v-99bdb337 data-v-6cdde2b7>Last updated: <time datetime="2024-07-19T08:37:02.000Z" data-v-6cdde2b7></time></p></div></div><nav class="prev-next" aria-labelledby="doc-footer-aria-label" data-v-99bdb337><span class="visually-hidden" id="doc-footer-aria-label" data-v-99bdb337>Pager</span><div class="pager" data-v-99bdb337><a class="VPLink link pager-link prev" href="/blog/npm/number.html" data-v-99bdb337><!--[--><span class="desc" data-v-99bdb337>Previous page</span><span class="title" data-v-99bdb337>number</span><!--]--></a></div><div class="pager" data-v-99bdb337><a class="VPLink link pager-link next" href="/blog/npm/eslint-vue.html" data-v-99bdb337><!--[--><span class="desc" data-v-99bdb337>Next page</span><span class="title" data-v-99bdb337>eslint-vue</span><!--]--></a></div></nav></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><footer class="VPFooter has-sidebar" data-v-c2e44112 data-v-ceaa8e12><div class="container" data-v-ceaa8e12><p class="message" data-v-ceaa8e12>Released under the MIT License.</p><p class="copyright" data-v-ceaa8e12>Copyright © 2024-PRESENT Alpha.wu</p></div></footer><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"docs_git.md\":\"DEArnkfE\",\"docs_interview.md\":\"BWZtXCrQ\",\"docs_nginx.md\":\"Bzuf4FQC\",\"docs_terminal.md\":\"BG_1jsHH\",\"docs_ts.md\":\"5HBol_aD\",\"docs_vitepress.md\":\"BGz88U0W\",\"docs_vscode.md\":\"BqfpMwJE\",\"index.md\":\"DHilAm80\",\"link_web.md\":\"DgBG4W5T\",\"npm_depth.md\":\"BOQORo_j\",\"npm_eslint-vue.md\":\"BNAMqLCV\",\"npm_kline-menu.md\":\"Bp34G6qX\",\"npm_kline-simple.md\":\"AdiTewkM\",\"npm_kline-tv.md\":\"BVRxm5Sc\",\"npm_kline.md\":\"CzawKgSa\",\"npm_number.md\":\"BvuWOAox\",\"npm_style.md\":\"BnTMQOJs\",\"npm_ws.md\":\"l9M2AOLd\",\"project_commitlint.md\":\"Dfh01-wA\",\"project_editorconfig.md\":\"DOyICMHt\",\"project_eslint.md\":\"CTjVPfL9\",\"project_husky.md\":\"C0dogxtw\",\"project_vitest.md\":\"Ct9h8yc0\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"菠萝前端\",\"description\":\"FE、Web、开发工具库、使用文档、前端文档、面试题、kline、javascript、 ts、 tradingView\",\"base\":\"/blog/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"logo\":\"/logo.svg\",\"nav\":[{\"text\":\"项目规范\",\"link\":\"/project/editorConfig\",\"activeMatch\":\"/project/\"},{\"text\":\"文档\",\"link\":\"/docs/terminal\",\"activeMatch\":\"/docs/\"},{\"text\":\"NPM\",\"link\":\"/npm/number\",\"activeMatch\":\"/npm/\"}],\"sidebar\":{\"/project/\":[{\"text\":\"常用链接\",\"items\":[{\"text\":\"前端\",\"link\":\"/link/web\"}]},{\"text\":\"项目规范\",\"items\":[{\"text\":\"editorConfig\",\"link\":\"/project/editorConfig\"},{\"text\":\"husky\",\"link\":\"/project/husky\"},{\"text\":\"commitlint\",\"link\":\"/project/commitlint\"},{\"text\":\"eslint\",\"link\":\"/project/eslint\"},{\"text\":\"vitest\",\"link\":\"/project/vitest\"}]},{\"text\":\"文档\",\"items\":[{\"text\":\"命令行常用\",\"link\":\"/docs/terminal\"},{\"text\":\"Git\",\"link\":\"/docs/git\"},{\"text\":\"TypeScript\",\"link\":\"/docs/ts\"},{\"text\":\"Nginx\",\"link\":\"/docs/nginx\"},{\"text\":\"VsCode\",\"link\":\"/docs/vscode\"},{\"text\":\"vitepress\",\"link\":\"/docs/vitepress\"}]}],\"/docs/\":[{\"text\":\"常用链接\",\"items\":[{\"text\":\"前端\",\"link\":\"/link/web\"}]},{\"text\":\"项目规范\",\"items\":[{\"text\":\"editorConfig\",\"link\":\"/project/editorConfig\"},{\"text\":\"husky\",\"link\":\"/project/husky\"},{\"text\":\"commitlint\",\"link\":\"/project/commitlint\"},{\"text\":\"eslint\",\"link\":\"/project/eslint\"},{\"text\":\"vitest\",\"link\":\"/project/vitest\"}]},{\"text\":\"文档\",\"items\":[{\"text\":\"命令行常用\",\"link\":\"/docs/terminal\"},{\"text\":\"Git\",\"link\":\"/docs/git\"},{\"text\":\"TypeScript\",\"link\":\"/docs/ts\"},{\"text\":\"Nginx\",\"link\":\"/docs/nginx\"},{\"text\":\"VsCode\",\"link\":\"/docs/vscode\"},{\"text\":\"vitepress\",\"link\":\"/docs/vitepress\"}]}],\"/link/\":[{\"text\":\"常用链接\",\"items\":[{\"text\":\"前端\",\"link\":\"/link/web\"}]},{\"text\":\"项目规范\",\"items\":[{\"text\":\"editorConfig\",\"link\":\"/project/editorConfig\"},{\"text\":\"husky\",\"link\":\"/project/husky\"},{\"text\":\"commitlint\",\"link\":\"/project/commitlint\"},{\"text\":\"eslint\",\"link\":\"/project/eslint\"},{\"text\":\"vitest\",\"link\":\"/project/vitest\"}]},{\"text\":\"文档\",\"items\":[{\"text\":\"命令行常用\",\"link\":\"/docs/terminal\"},{\"text\":\"Git\",\"link\":\"/docs/git\"},{\"text\":\"TypeScript\",\"link\":\"/docs/ts\"},{\"text\":\"Nginx\",\"link\":\"/docs/nginx\"},{\"text\":\"VsCode\",\"link\":\"/docs/vscode\"},{\"text\":\"vitepress\",\"link\":\"/docs/vitepress\"}]}],\"/npm/\":[{\"text\":\"基础\",\"items\":[{\"text\":\"number\",\"link\":\"/npm/number\"},{\"text\":\"socket\",\"link\":\"/npm/ws\"},{\"text\":\"eslint-vue\",\"link\":\"/npm/eslint-vue\"},{\"text\":\"style\",\"link\":\"/npm/style\"}]},{\"text\":\"Chart\",\"items\":[{\"text\":\"Kline-菜单\",\"link\":\"/npm/kline-menu\"},{\"text\":\"Kline-简版\",\"link\":\"/npm/kline-simple\"},{\"text\":\"Kline-专业版\",\"link\":\"/npm/kline-tv\"},{\"text\":\"Kline\",\"link\":\"/npm/kline\"},{\"text\":\"深度图-depth\",\"link\":\"/npm/depth\"}]}]},\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/alphajn\"}],\"footer\":{\"message\":\"Released under the MIT License.\",\"copyright\":\"Copyright © 2024-PRESENT Alpha.wu\"},\"search\":{\"provider\":\"local\"}},\"locales\":{},\"scrollOffset\":134,\"cleanUrls\":false}");</script>
    
  </body>
</html>